<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nur Fazlina binti Dzulkifli (23202967)">
<meta name="author" content="Yogeswary Mithra A/P Nandi Mithra (23202677)">
<meta name="author" content="Siti Nurhafizah binti Saharudin (23202464)">
<meta name="author" content="Muammar Iskandar bin Muhamaed Yusoff (23202846)">
<meta name="dcterms.date" content="2026-01-04">

<title>Logistic Regression Analysis of Depression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Logistic Regression Analysis of Depression_files/libs/clipboard/clipboard.min.js"></script>
<script src="Logistic Regression Analysis of Depression_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Logistic Regression Analysis of Depression_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Logistic Regression Analysis of Depression_files/libs/quarto-html/popper.min.js"></script>
<script src="Logistic Regression Analysis of Depression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Logistic Regression Analysis of Depression_files/libs/quarto-html/anchor.min.js"></script>
<link href="Logistic Regression Analysis of Depression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Logistic Regression Analysis of Depression_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Logistic Regression Analysis of Depression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Logistic Regression Analysis of Depression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Logistic Regression Analysis of Depression_files/libs/bootstrap/bootstrap-6e5ff12f349f7d7ee99023e5a7f49be9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Logistic Regression Analysis of Depression_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="Logistic Regression Analysis of Depression_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="Logistic Regression Analysis of Depression_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="Logistic Regression Analysis of Depression_files/libs/datatables-binding-0.34.0/datatables.js"></script>

<script src="Logistic Regression Analysis of Depression_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="Logistic Regression Analysis of Depression_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="Logistic Regression Analysis of Depression_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="Logistic Regression Analysis of Depression_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="Logistic Regression Analysis of Depression_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">

<script src="Logistic Regression Analysis of Depression_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">1. INTRODUCTION</a>
  <ul class="collapse">
  <li><a href="#data-generation" id="toc-data-generation" class="nav-link" data-scroll-target="#data-generation">1.1 Data Generation</a></li>
  <li><a href="#prepare-the-environment" id="toc-prepare-the-environment" class="nav-link" data-scroll-target="#prepare-the-environment">1.2 Prepare the environment</a></li>
  <li><a href="#read-the-data" id="toc-read-the-data" class="nav-link" data-scroll-target="#read-the-data">1.3 Read the data</a></li>
  <li><a href="#levels-for-variables" id="toc-levels-for-variables" class="nav-link" data-scroll-target="#levels-for-variables">1.4 Levels for variables</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">2. EXPLORATORY DATA ANALYSIS</a>
  <ul class="collapse">
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics">2.1 Summary statistics</a></li>
  <li><a href="#create-visualisations" id="toc-create-visualisations" class="nav-link" data-scroll-target="#create-visualisations">2.2 Create visualisations</a></li>
  <li><a href="#correlation-matrices-for-continous-variables" id="toc-correlation-matrices-for-continous-variables" class="nav-link" data-scroll-target="#correlation-matrices-for-continous-variables">2.3 Correlation matrices for continous variables</a></li>
  </ul></li>
  <li><a href="#logistic-regression-analysis" id="toc-logistic-regression-analysis" class="nav-link" data-scroll-target="#logistic-regression-analysis">3. LOGISTIC REGRESSION ANALYSIS</a>
  <ul class="collapse">
  <li><a href="#simple-logistic-regression" id="toc-simple-logistic-regression" class="nav-link" data-scroll-target="#simple-logistic-regression">3.1 Simple Logistic Regression</a></li>
  <li><a href="#multiple-logistic-regression" id="toc-multiple-logistic-regression" class="nav-link" data-scroll-target="#multiple-logistic-regression">3.2 Multiple Logistic Regression</a></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models">3.3 Comparing models</a></li>
  </ul></li>
  <li><a href="#model-checking" id="toc-model-checking" class="nav-link" data-scroll-target="#model-checking">4. MODEL CHECKING</a>
  <ul class="collapse">
  <li><a href="#checking-the-assumptions" id="toc-checking-the-assumptions" class="nav-link" data-scroll-target="#checking-the-assumptions">4.1 Checking the assumptions</a></li>
  <li><a href="#influential-analysis" id="toc-influential-analysis" class="nav-link" data-scroll-target="#influential-analysis">4.2 Influential analysis</a></li>
  <li><a href="#dfbetas" id="toc-dfbetas" class="nav-link" data-scroll-target="#dfbetas">4.2.2 DFBETAS</a></li>
  <li><a href="#leverage-points" id="toc-leverage-points" class="nav-link" data-scroll-target="#leverage-points">4.2.3 Leverage points</a></li>
  </ul></li>
  <li><a href="#model-fitness" id="toc-model-fitness" class="nav-link" data-scroll-target="#model-fitness">5. Model fitness</a>
  <ul class="collapse">
  <li><a href="#hosmerlemeshow-goodness-of-fit-test" id="toc-hosmerlemeshow-goodness-of-fit-test" class="nav-link" data-scroll-target="#hosmerlemeshow-goodness-of-fit-test">5.1 Hosmer–Lemeshow goodness-of-fit test</a></li>
  <li><a href="#area-under-the-receiver-operating-characteristic-roc-curve" id="toc-area-under-the-receiver-operating-characteristic-roc-curve" class="nav-link" data-scroll-target="#area-under-the-receiver-operating-characteristic-roc-curve">5.2 Area under the Receiver Operating Characteristic (ROC) curve</a></li>
  <li><a href="#classification-table-confusion-matrix-classification-metrics" id="toc-classification-table-confusion-matrix-classification-metrics" class="nav-link" data-scroll-target="#classification-table-confusion-matrix-classification-metrics">5.3 Classification table (Confusion matrix) / Classification metrics</a></li>
  </ul></li>
  <li><a href="#results-presentation" id="toc-results-presentation" class="nav-link" data-scroll-target="#results-presentation">6 RESULTS PRESENTATION</a>
  <ul class="collapse">
  <li><a href="#coefficients-table-β-se-p-value-95-ci" id="toc-coefficients-table-β-se-p-value-95-ci" class="nav-link" data-scroll-target="#coefficients-table-β-se-p-value-95-ci">6.1 Coefficients table (β, SE, p-value, 95% CI)</a></li>
  <li><a href="#odds-ratios-aic-pseudo-r²" id="toc-odds-ratios-aic-pseudo-r²" class="nav-link" data-scroll-target="#odds-ratios-aic-pseudo-r²">6.2 Odds ratios, AIC, pseudo-R²</a></li>
  <li><a href="#aic-pseudo-r²" id="toc-aic-pseudo-r²" class="nav-link" data-scroll-target="#aic-pseudo-r²">6.3 AIC, pseudo-R²</a></li>
  <li><a href="#interaction-plots" id="toc-interaction-plots" class="nav-link" data-scroll-target="#interaction-plots">6.4 Interaction plots</a></li>
  <li><a href="#final-model" id="toc-final-model" class="nav-link" data-scroll-target="#final-model">6.5 Final model</a></li>
  </ul></li>
  <li><a href="#final-model-equation" id="toc-final-model-equation" class="nav-link" data-scroll-target="#final-model-equation">7 FINAL MODEL EQUATION</a>
  <ul class="collapse">
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio">7.1 Odds Ratio</a></li>
  <li><a href="#probability" id="toc-probability" class="nav-link" data-scroll-target="#probability">7.2 Probability</a></li>
  </ul></li>
  <li><a href="#prediction-analysis" id="toc-prediction-analysis" class="nav-link" data-scroll-target="#prediction-analysis">8 PREDICTION ANALYSIS</a>
  <ul class="collapse">
  <li><a href="#create-new-dataframe-for-prediction" id="toc-create-new-dataframe-for-prediction" class="nav-link" data-scroll-target="#create-new-dataframe-for-prediction">8.1 Create new dataframe for prediction</a></li>
  <li><a href="#generate-predicted-odds" id="toc-generate-predicted-odds" class="nav-link" data-scroll-target="#generate-predicted-odds">8.2 Generate predicted odds</a></li>
  <li><a href="#generate-predicted-probability" id="toc-generate-predicted-probability" class="nav-link" data-scroll-target="#generate-predicted-probability">8.3 Generate predicted probability</a></li>
  </ul></li>
  <li><a href="#final-model-result-interpretation" id="toc-final-model-result-interpretation" class="nav-link" data-scroll-target="#final-model-result-interpretation">9 FINAL MODEL RESULT INTERPRETATION</a>
  <ul class="collapse">
  <li><a href="#main-effects" id="toc-main-effects" class="nav-link" data-scroll-target="#main-effects">9.1 Main Effects</a></li>
  <li><a href="#interaction-effect" id="toc-interaction-effect" class="nav-link" data-scroll-target="#interaction-effect">9.2 Interaction Effect</a></li>
  <li><a href="#comparison-models-with-and-without-interactions" id="toc-comparison-models-with-and-without-interactions" class="nav-link" data-scroll-target="#comparison-models-with-and-without-interactions">9.3 Comparison models with and without interactions</a></li>
  <li><a href="#practical-significance-of-the-findings" id="toc-practical-significance-of-the-findings" class="nav-link" data-scroll-target="#practical-significance-of-the-findings">9.4 Practical Significance of the Findings</a></li>
  <li><a href="#addressing-any-violations-of-assumptions" id="toc-addressing-any-violations-of-assumptions" class="nav-link" data-scroll-target="#addressing-any-violations-of-assumptions">9.5 Addressing any violations of assumptions</a></li>
  <li><a href="#discussion-on-influential-points-and-their-impact-on-the-results" id="toc-discussion-on-influential-points-and-their-impact-on-the-results" class="nav-link" data-scroll-target="#discussion-on-influential-points-and-their-impact-on-the-results">9.6 Discussion on influential points and their impact on the results</a></li>
  </ul></li>
  <li><a href="#github-repository" id="toc-github-repository" class="nav-link" data-scroll-target="#github-repository">GITHUB REPOSITORY #</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Logistic Regression Analysis of Depression</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">Logistic Regression</div>
    <div class="quarto-category">Medical Statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Nur Fazlina binti Dzulkifli (23202967) </p>
             <p>Yogeswary Mithra A/P Nandi Mithra (23202677) </p>
             <p>Siti Nurhafizah binti Saharudin (23202464) </p>
             <p>Muammar Iskandar bin Muhamaed Yusoff (23202846) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 4, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. INTRODUCTION</h2>
<p>This analysis aims to determine the factors associated with depression using multiple logistic regression. The outcome variable is binary (depressed vs not depressed). Three covariates are considered:</p>
<ul>
<li><p>years of working (numerical)</p></li>
<li><p>physical activity score (numerical)</p></li>
<li><p>obesity status (categorical)</p></li>
</ul>
<section id="data-generation" class="level3">
<h3 class="anchored" data-anchor-id="data-generation">1.1 Data Generation</h3>
<p>A dataset with 200 observations were generated, containing the following variables:</p>
<ul>
<li><p>Outcome variable: depression (binary: “depressed” or “not depressed”)</p></li>
<li><p>Covariates:</p>
<ul>
<li><p>years_working (Years of working, continuous, range 0-40 years)</p></li>
<li><p>phys_activity (Physical activity score, continuous, range 0-10)</p></li>
<li><p>obesity (binary: “obese” or “not obese”)</p></li>
</ul></li>
</ul>
<p>An interaction between physical activity and obesity is also evaluated to determine whether the effect of physical activity on depression differs by obesity status.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Generate covariates</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">40</span>), <span class="dv">1</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>phys_c <span class="ot">&lt;-</span> phys_activity <span class="sc">-</span> <span class="fu">mean</span>(phys_activity)  <span class="co"># centered for simulation</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Obesity (binary)</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>obesity_bin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.30</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Set simulation coefficients (moderate ORs, significant effects)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep ORs &lt; 10 and encourage a significant interaction</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">0.08</span>    <span class="co"># years_working (OR ~ 1.08 per year)</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.30</span>   <span class="co"># phys_activity (OR ~ 0.74 per 1-point increase)</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fl">0.40</span>    <span class="co"># obesity main effect (OR ~ 1.49)</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.60</span>   <span class="co"># interaction (strong enough for significance)</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept calibrated for ~25% prevalence</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>mean_prev <span class="ot">&lt;-</span> <span class="cf">function</span>(b0){</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  lp <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity_bin <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity_bin</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">plogis</span>(lp))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">mean_prev</span>(x) <span class="sc">-</span> <span class="fl">0.25</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear predictor and probabilities</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>linpred <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity_bin <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity_bin</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(linpred)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, <span class="fl">0.05</span>), <span class="fl">0.95</span>)  <span class="co"># clamp to avoid separation</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Add a few influential points but keep model stable</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>years_working[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">39</span>, <span class="dv">38</span>)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>phys_activity[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>obesity_bin[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Build final dataset with required labels</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> years_working,</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> phys_activity,</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">factor</span>(obesity_bin, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>,<span class="st">"obese"</span>)),</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">depression =</span> <span class="fu">factor</span>(y, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not depressed"</span>,<span class="st">"depressed"</span>))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  years_working phys_activity   obesity    depression
1          40.0           0.0     obese     depressed
2          39.0           0.5     obese     depressed
3          38.0           0.2     obese     depressed
4          19.5           2.5 not obese not depressed
5          24.0           1.4 not obese not depressed
6          31.4           4.2 not obese not depressed</code></pre>
</div>
</div>
</section>
<section id="prepare-the-environment" class="level3">
<h3 class="anchored" data-anchor-id="prepare-the-environment">1.2 Prepare the environment</h3>
<p>Load the required libraries.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="read-the-data" class="level3">
<h3 class="anchored" data-anchor-id="read-the-data">1.3 Read the data</h3>
<p>Read the data into R and quickly view the data.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 200
Columns: 4
$ years_working &lt;dbl&gt; 40.0, 39.0, 38.0, 19.5, 24.0, 31.4, 37.7, 13.2, 20.7, 29…
$ phys_activity &lt;dbl&gt; 0.0, 0.5, 0.2, 2.5, 1.4, 4.2, 7.5, 1.7, 7.6, 6.3, 1.4, 7…
$ obesity       &lt;fct&gt; obese, obese, obese, not obese, not obese, not obese, no…
$ depression    &lt;fct&gt; depressed, depressed, depressed, not depressed, not depr…</code></pre>
</div>
</div>
</section>
<section id="levels-for-variables" class="level3">
<h3 class="anchored" data-anchor-id="levels-for-variables">1.4 Levels for variables</h3>
<p>To ensure we are comparing the outcome for depressed against not depressed.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(mydata<span class="sc">$</span>depression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "not depressed" "depressed"    </code></pre>
</div>
</div>
<p>To ensure we are comparing the factor obese against not obese.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(mydata<span class="sc">$</span>obesity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "not obese" "obese"    </code></pre>
</div>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">2. EXPLORATORY DATA ANALYSIS</h2>
<p>The following analysis were conducted:</p>
<section id="summary-statistics" class="level3">
<h3 class="anchored" data-anchor-id="summary-statistics">2.1 Summary statistics</h3>
<ul>
<li>Mean, SD, median, IQR for continuous variables</li>
<li>Frequencies and proportions for categorical variables</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(depression, years_working, phys_activity, obesity) <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> depression,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd}) | Median: {median} [{p25}, {p75}]"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} ({p}%)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="ztufahwxue" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ztufahwxue table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ztufahwxue thead, #ztufahwxue tbody, #ztufahwxue tfoot, #ztufahwxue tr, #ztufahwxue td, #ztufahwxue th {
  border-style: none;
}

#ztufahwxue p {
  margin: 0;
  padding: 0;
}

#ztufahwxue .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztufahwxue .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ztufahwxue .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztufahwxue .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztufahwxue .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztufahwxue .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztufahwxue .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztufahwxue .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztufahwxue .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztufahwxue .gt_spanner_row {
  border-bottom-style: hidden;
}

#ztufahwxue .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ztufahwxue .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztufahwxue .gt_from_md > :first-child {
  margin-top: 0;
}

#ztufahwxue .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztufahwxue .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztufahwxue .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ztufahwxue .gt_row_group_first td {
  border-top-width: 2px;
}

#ztufahwxue .gt_row_group_first th {
  border-top-width: 2px;
}

#ztufahwxue .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ztufahwxue .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ztufahwxue .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztufahwxue .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztufahwxue .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztufahwxue .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztufahwxue .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztufahwxue .gt_left {
  text-align: left;
}

#ztufahwxue .gt_center {
  text-align: center;
}

#ztufahwxue .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztufahwxue .gt_font_normal {
  font-weight: normal;
}

#ztufahwxue .gt_font_bold {
  font-weight: bold;
}

#ztufahwxue .gt_font_italic {
  font-style: italic;
}

#ztufahwxue .gt_super {
  font-size: 65%;
}

#ztufahwxue .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ztufahwxue .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ztufahwxue .gt_indent_1 {
  text-indent: 5px;
}

#ztufahwxue .gt_indent_2 {
  text-indent: 10px;
}

#ztufahwxue .gt_indent_3 {
  text-indent: 15px;
}

#ztufahwxue .gt_indent_4 {
  text-indent: 20px;
}

#ztufahwxue .gt_indent_5 {
  text-indent: 25px;
}

#ztufahwxue .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ztufahwxue div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>not depressed</strong><br>
N = 140<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>depressed</strong><br>
N = 60<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">years_working</td>
<td class="gt_row gt_center" headers="stat_1">19 (12) | Median: 19 [8, 28]</td>
<td class="gt_row gt_center" headers="stat_2">28 (10) | Median: 32 [19, 35]</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">phys_activity</td>
<td class="gt_row gt_center" headers="stat_1">5.50 (2.65) | Median: 5.75 [3.45, 7.55]</td>
<td class="gt_row gt_center" headers="stat_2">3.00 (2.27) | Median: 2.60 [1.10, 4.35]</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">obesity</td>
<td class="gt_row gt_center" headers="stat_1"><br>
</td>
<td class="gt_row gt_center" headers="stat_2"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;not obese</td>
<td class="gt_row gt_center" headers="stat_1">105 (75%)</td>
<td class="gt_row gt_center" headers="stat_2">35 (58%)</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;obese</td>
<td class="gt_row gt_center" headers="stat_1">35 (25%)</td>
<td class="gt_row gt_center" headers="stat_2">25 (42%)</td>
</tr>
</tbody><tfoot>
<tr class="gt_footnotes odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Mean (SD) | Median: Median [Q1, Q3]; n (%)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>Among 200 participants, 60 (30%) were classified as depressed. Individuals with depression had a longer duration of working years (median: 32 years) compared to those without depression (median: 19 years). They also reported substantially lower physical activity levels (median score: 2.60) compared to non-depressed individuals (median score: 5.75). With regard to obesity, a higher proportion of depressed participant were obese (42%) compared to those without depression (25%) indicating a greater prevalence of obesity among individuals with depression.</li>
</ul>
</section>
<section id="create-visualisations" class="level3">
<h3 class="anchored" data-anchor-id="create-visualisations">2.2 Create visualisations</h3>
<section id="histograms-for-continuous-variables" class="level4">
<h4 class="anchored" data-anchor-id="histograms-for-continuous-variables">2.2.1 Histograms for continuous variables</h4>
<p><strong>Years of working</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(years_working)) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of years of working"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The distribution shows that individuals with depression are more concentrated in the longer duration of years of working (approximately 25–40 years), whereas those not depressed are more evenly distributed across all working durations. This suggests that longer years of working are more common among depressed individuals. Overall, the pattern indicates a positive association between years of working and depression.</li>
</ul>
<p><strong>Physical activity score</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(phys_activity)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of physical activity score"</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>Individuals without depression tend to have higher physical activity scores, with the distribution concentrated in the moderate to high range. In contrast, the depressed group shows a clustering at lower physical activity scores, with fewer individuals reporting high activity levels. This pattern suggests an inverse association between physical activity and depression, where lower physical activity is more common among depressed individuals.</li>
</ul>
</section>
<section id="box-plots-of-continuous-variables-by-categorical-variables" class="level4">
<h4 class="anchored" data-anchor-id="box-plots-of-continuous-variables-by-categorical-variables">2.2.2 Box plots of continuous variables by categorical variables</h4>
<p><strong>Years of working by obesity status</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> years_working)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span> ( <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years of working"</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Years of working by obesity status"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The median years of working is higher among obese individuals compared with those who are not obese. Obese participants also tend to cluster in the mid-to-higher range of working years, while the not-obese group shows a wider spread with more individuals at lower years of working. This indicates that obesity is more common among individuals with longer working duration in this sample.</li>
</ul>
<p><strong>Physical activity by obesity status</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> phys_activity)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Physical activity score by obesity status"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The median physical activity score is slightly lower among obese individuals compared with those who are not obese. While the interquartile ranges overlap substantially, non-obese participants tend to show a somewhat higher upper range of physical activity scores. Overall, this suggests that obese individuals in this sample are generally less physically active, although the difference is modest.</li>
</ul>
</section>
<section id="scatter-plots-between-continuous-variables" class="level4">
<h4 class="anchored" data-anchor-id="scatter-plots-between-continuous-variables">2.2.3 Scatter plots between continuous variables</h4>
<p><strong>Years of working and physical activity</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> years_working, <span class="at">y =</span> phys_activity))<span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between years of working and physical activity"</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The points are widely scattered across the plot with no clear linear or non-linear trend. Physical activity varies substantially at all levels of years working, both high and low physical activity scores occur across short and long working duration. There is no strong association between years of working and physical activity.</li>
</ul>
</section>
<section id="bar-plot-for-categorical-variable" class="level4">
<h4 class="anchored" data-anchor-id="bar-plot-for-categorical-variable">2.2.4 Bar plot for categorical variable</h4>
<p><strong>Obesity</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(obesity)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"orange"</span>) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">" Distribution of obesity by depression status"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The distribution of obesity differed modestly by depression status. In both depressed and non-depressed groups, the majority of participants were classified as not obese. However, the difference between not obese and obese participants was less pronounced in the depressed group compared to the non-depressed group, indicating a relatively higher representation of obesity among participants with depression. Overall, the figure suggests a shift toward a greater proportion of obesity in the depressed group, while not-obese individuals remained the majority in both groups.</li>
</ul>
</section>
</section>
<section id="correlation-matrices-for-continous-variables" class="level3">
<h3 class="anchored" data-anchor-id="correlation-matrices-for-continous-variables">2.3 Correlation matrices for continous variables</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mydata<span class="sc">$</span>years_working, mydata<span class="sc">$</span>phys_activity, <span class="at">use =</span> <span class="st">'complete.obs'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.03935191</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>corr.num <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(years_working, phys_activity) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">'complete.obs'</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>corr.num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              years_working phys_activity
years_working    1.00000000   -0.03935191
phys_activity   -0.03935191    1.00000000</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corr.num, <span class="at">type =</span> <span class="st">'upper'</span>, <span class="at">order =</span> <span class="st">'hclust'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li><p>A correlation of −0.04 is extremely close to 0. Value close to 0 mean almost no linear association.</p></li>
<li><p>As years of working increases, physical activity score does not show a meaningful tendency to increase or decrease.A correlation of −0.04 between years of working and physical activity score is essentially no linear relationship.</p></li>
<li><p>This very small correlation suggests no multicollinearity problem between these two predictors, so it is fine to include both years of working and physical activity score in the same logistic regression model.</p></li>
</ul>
</section>
</section>
<section id="logistic-regression-analysis" class="level2">
<h2 class="anchored" data-anchor-id="logistic-regression-analysis">3. LOGISTIC REGRESSION ANALYSIS</h2>
<section id="simple-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="simple-logistic-regression">3.1 Simple Logistic Regression</h3>
<p><strong>Years of working</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>slr.years <span class="ot">&lt;-</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working, <span class="at">data =</span> mydata,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -2.61087    0.44220  -5.904 3.54e-09 ***
years_working  0.07432    0.01596   4.655 3.24e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 218.15  on 198  degrees of freedom
AIC: 222.15

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>Each additional year of working is significantly associated with an increase of about 0.07 in the log odds of being depressed, not adjusted by other variables (p value &lt; 0.05).</li>
</ul>
<p><strong>Physical activity</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>slr.phys <span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity, <span class="at">data =</span> mydata,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.phys)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ phys_activity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    0.74299    0.31185   2.383   0.0172 *  
phys_activity -0.37847    0.07015  -5.395 6.84e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 207.70  on 198  degrees of freedom
AIC: 211.7

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>For every 1-unit increase in physical activity score, the log odds of being depressed decrease by 0.38, not adjusted by other variables (p value &lt; 0.05)</li>
</ul>
<p><strong>Obesity</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>slr.obese <span class="ot">&lt;-</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> obesity, <span class="at">data =</span> mydata,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.obese)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.0986     0.1952  -5.629 1.82e-08 ***
obesityobese   0.7621     0.3266   2.334   0.0196 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 238.96  on 198  degrees of freedom
AIC: 242.96

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>There is a statistically significant association between obesity and depression (p = 0.0196). Individuals who are obese have 0.76 higher log odds of being depressed compared with those who are not obese. This result suggests that obesity is a significant risk factor for depression in the unadjusted (crude).</li>
</ul>
</section>
<section id="multiple-logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="multiple-logistic-regression">3.2 Multiple Logistic Regression</h3>
<p>In simple logistic regression analyses, physical activity, years of working and obesity were each significantly associated with depression. All three variables will be included in the multivariable logistic regression model based on statistical significance in the univariable analysis and their established clinical and public health relevance.</p>
<section id="model-without-interaction" class="level4">
<h4 class="anchored" data-anchor-id="model-without-interaction">3.2.1 <strong>Model without interaction</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>model1_mlr <span class="ot">&lt;-</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity, 
    family = binomial(link = "logit"), data = mydata)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   -1.30309    0.52901  -2.463   0.0138 *  
years_working  0.08629    0.01853   4.658 3.19e-06 ***
phys_activity -0.44165    0.08163  -5.411 6.28e-08 ***
obesityobese   0.82509    0.39836   2.071   0.0383 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 174.60  on 196  degrees of freedom
AIC: 182.6

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<ul>
<li>Convert the coefficient to an odds ratio</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1_mlr, </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 7
  term          estimate std.error statistic      p.value conf.low conf.high
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)      0.272    0.529      -2.46 0.0138         0.0915     0.738
2 years_working    1.09     0.0185      4.66 0.00000319     1.05       1.13 
3 phys_activity    0.643    0.0816     -5.41 0.0000000628   0.542      0.748
4 obesityobese     2.28     0.398       2.07 0.0383         1.05       5.04 </code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ol type="1">
<li><strong>Years of working</strong></li>
</ol>
<ul>
<li>After adjusting for physical activity and obesity, each additional year of working was significantly associated with increase 1.09 in the odds of depression (AdjOR: 1.09, 95% CI: 1.05,1.13, p value &lt; 0.05).</li>
</ul>
<ol start="2" type="1">
<li><strong>Physical activity</strong></li>
</ol>
<ul>
<li>After adjusting for years of working and obesity, each one-unit increase in physical activity score was significantly associated with a 36% reduction in the odds of depression (AdjOR: 0.64, 95% CI: 0.54,0.75, p value &lt; 0.05).</li>
</ul>
<ol start="3" type="1">
<li><strong>Obesity</strong></li>
</ol>
<ul>
<li>After adjusting for years of working and physical activity, obesity significantly associated with depression, with a 2.28 in the odds of depression (AdjOR = 2.28, 95% CI:1.05,5.04, p &lt; 0.05)</li>
</ul>
</section>
<section id="model-with-interaction" class="level4">
<h4 class="anchored" data-anchor-id="model-with-interaction">3.2.2 <strong>Model with interaction</strong></h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model2_mlr <span class="ot">&lt;-</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity, </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_mlr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<ul>
<li>Convert the coefficient to an odds ratio</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model2_mlr, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">exp =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)               0.145    0.596      -3.24 1.21e-3   0.0417     0.439
2 years_working             1.09     0.0198      4.55 5.33e-6   1.05       1.14 
3 phys_activity             0.738    0.0857     -3.54 3.97e-4   0.618      0.867
4 obesityobese             67.2      1.26        3.34 8.53e-4   7.46    1176.   
5 phys_activity:obesity…    0.436    0.287      -2.89 3.81e-3   0.227      0.716</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ol type="1">
<li><strong>Years of working</strong></li>
</ol>
<ul>
<li>After adjusting for physical activity, obesity, and their interaction, each additional year of working was significantly associated with a 1.09 increase in the odds of depression (AdjOR: 1.09, 95% CI: 1.05,1.14, p value &lt; 0.05)</li>
</ul>
<ol start="2" type="1">
<li><strong>Physical activity</strong></li>
</ol>
<ul>
<li>Among non-obese individuals, each one-unit increase in physical activity score was significantly associated with a 26% reduction in the odds of depression, after adjustment of other covariates (AdjOR: 0.74, 95% CI: 0.62,0.87, p value &lt; 0.05).</li>
</ul>
<ol start="3" type="1">
<li><strong>Obesity</strong></li>
</ol>
<ul>
<li>Among individuals with no physical activity, obese individuals had nearly 67.23 times higher odds of depression compared with non-obese individuals after adjustment of other covariates (AdjOR: 67.23, 95% CI: 7.46,1176.33, p value &lt; 0.05).</li>
</ul>
<ol start="4" type="1">
<li><strong>Interaction term ( phys_activity : obesity)</strong></li>
</ol>
<ul>
<li><p>For obese individuals, each unit increase in physical activity further reduces the odds of depression by 56%, beyond the effect seen in non-obese individuals, after adjustment of other covariates (AdjOR: 0.44, 95% CI: 0.23,0.72, p value &lt; 0.05).</p></li>
<li><p>Among non-obese individuals, each one-unit increase in physical activity score was significantly associated with a 26% reduction in the odds of depression, after adjustment of other covariates (AdjOR: 0.74, 95% CI: 0.62,0.87, p value &lt; 0.05).</p></li>
<li><p>The association between physical activity and depression differs by obesity status. The protective effect of physical activity against depression is stronger among obese individuals than among non-obese individuals. Among obese individuals, each one-unit increase in physical activity was associated with a 67% reduction (AdjOR 0.74 X 0.44 = 0.33) in the odds of depression, indicating a stronger protective effect of physical activity in this group.</p></li>
</ul>
</section>
</section>
<section id="comparing-models" class="level3">
<h3 class="anchored" data-anchor-id="comparing-models">3.3 Comparing models</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1_mlr, model2_mlr, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: depression ~ years_working + phys_activity + obesity
Model 2: depression ~ years_working + phys_activity + obesity + phys_activity:obesity
  Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
1       196     174.60                          
2       195     161.84  1   12.757 0.0003546 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>A likelihood ratio test comparing the model with and without the physical activity and obesity interaction showed that adding the interaction significantly improved model fit (ΔDeviance = 12.376, df = 1, p &lt; 0.05) ,indicating the effect of physical activity on depression depends on obesity status. Therefore, the final model should retained this interaction term of physical activity and obesity.</p>
</section>
</section>
<section id="model-checking" class="level2">
<h2 class="anchored" data-anchor-id="model-checking">4. MODEL CHECKING</h2>
<section id="checking-the-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="checking-the-assumptions">4.1 Checking the assumptions</h3>
<p>The pre-liminary final model consists of:</p>
<ul>
<li>Years of working</li>
<li>Physical activity</li>
<li>Obesity</li>
<li>Physical activity : Obesity</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> model2_mlr</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Convert the coefficient into odd ratio</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(final.m, </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">exp =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)               0.145    0.596      -3.24 1.21e-3   0.0417     0.439
2 years_working             1.09     0.0198      4.55 5.33e-6   1.05       1.14 
3 phys_activity             0.738    0.0857     -3.54 3.97e-4   0.618      0.867
4 obesityobese             67.2      1.26        3.34 8.53e-4   7.46    1176.   
5 phys_activity:obesity…    0.436    0.287      -2.89 3.81e-3   0.227      0.716</code></pre>
</div>
</div>
<p>The assumptions of the model checked by:</p>
<ul>
<li>Linearity in the logit</li>
<li>Independence</li>
<li>Absence of multicollinearity</li>
</ul>
<section id="linearity-in-the-logit-continuous-variables" class="level4">
<h4 class="anchored" data-anchor-id="linearity-in-the-logit-continuous-variables">4.1.1 Linearity in the logit (continuous variables)</h4>
<section id="using-mfp" class="level5">
<h5 class="anchored" data-anchor-id="using-mfp">4.1.1.1 Using mfp</h5>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mfp)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>mfp_model <span class="ot">&lt;-</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mfp</span>(depression <span class="sc">~</span> <span class="fu">fp</span>(years_working) <span class="sc">+</span> <span class="fu">fp</span>(phys_activity),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata, <span class="at">verbose =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Variable    Deviance    Power(s)
------------------------------------------------
Cycle 1
    phys_activity            
                218.155      
                178.925     1
                178.925     1
                175.852     3 3

    years_working            
                207.702      
                178.925     1
                178.925     1
                176.985     0 0.5


Tansformation
              shift scale
phys_activity   0.1    10
years_working   0.0    10

Fractional polynomials
              df.initial select alpha df.final power1 power2
phys_activity          4      1  0.05        1      1      .
years_working          4      1  0.05        1      1      .


Transformations of covariates:
                                    formula
years_working       I((years_working/10)^1)
phys_activity I(((phys_activity+0.1)/10)^1)


Deviance table:
         Resid. Dev
Null model   244.3457
Linear model     178.9248
Final model  178.9248</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mfp_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ I(((phys_activity + 0.1)/10)^1) + 
    I((years_working/10)^1), family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                      -1.0369     0.5051  -2.053   0.0401 *  
I(((phys_activity + 0.1)/10)^1)  -4.3169     0.7944  -5.434 5.50e-08 ***
I((years_working/10)^1)           0.8677     0.1807   4.803 1.56e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 178.92  on 197  degrees of freedom
AIC: 184.92

Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Linearity in the logit was assessed for continuous covariates by fitting models in which physical activity and years of working were entered as first-order (power = 1) terms. Both linear terms were statistically significant and retained at power = 1, indicating that the log odds of depression change linearly with these variables and that no higher-order transformation was required.</p>
</section>
</section>
<section id="independence" class="level4">
<h4 class="anchored" data-anchor-id="independence">4.1.2 Independence</h4>
<p>Independence of observations was assessed based on the study design and data structure. Each observation represented a unique individual, with no repeated measurements or clustering within higher-level units. Therefore, the assumption of independence of observations was considered to be satisfied</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">family =</span> binomial</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>resid_dev <span class="ot">&lt;-</span> <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid_dev, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation index"</span>,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Deviance residual"</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs observation index"</span>)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Deviance residuals plotted against observation index showed a random scatter around zero, with no systematic pattern or trend. This suggests that the assumption of independence was satisfied and that the logistic regression model was adequately specified.</p>
</section>
<section id="absence-of-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="absence-of-multicollinearity">4.1.3 Absence of multicollinearity</h4>
<ul>
<li>Preliminary final model</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<section id="using-variance-infaltion-factor-vif" class="level5">
<h5 class="anchored" data-anchor-id="using-variance-infaltion-factor-vif">4.1.3.1 Using Variance Infaltion Factor (VIF)</h5>
<p>Multicollinearity was assessed using variance inflation factors (VIFs) from the main-effects model. VIF should be assessed on the model without interaction to avoid artificial inflation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># model without interaction</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model1_mlr)   </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>vif_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>years_working phys_activity       obesity 
     1.081872      1.098454      1.017914 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert VIF output into a table</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>vif_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(vif_values), <span class="dv">2</span>), </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tolerance =</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>vif_values, <span class="dv">2</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display as a proper table</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  vif_table,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"lcc"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Variance Inflation Factors (VIF) for main-effects logistic regression model"</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Variance Inflation Factors (VIF) for main-effects logistic regression model</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">VIF</th>
<th style="text-align: center;">Tolerance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">years_working</td>
<td style="text-align: center;">1.08</td>
<td style="text-align: center;">0.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">phys_activity</td>
<td style="text-align: center;">1.10</td>
<td style="text-align: center;">0.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">obesity</td>
<td style="text-align: center;">1.02</td>
<td style="text-align: center;">0.98</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Variance inflation factors for all predictors were below 10, indicating no concerning multicollinearity in the preliminary final logistic regression model.</p>
</section>
</section>
</section>
<section id="influential-analysis" class="level3">
<h3 class="anchored" data-anchor-id="influential-analysis">4.2 Influential analysis</h3>
<section id="diagnostic-plot-screening" class="level4">
<h4 class="anchored" data-anchor-id="diagnostic-plot-screening">4.2.1 Diagnostic plot (screening)</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(final.m),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Fitted values (predicted probability)"</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Deviance residuals"</span>,</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Q–Q Residuals</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Q–Q Plot of Deviance Residuals"</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale–Location</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(final.m),</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>))),</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"√|Deviance residuals|"</span>,</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Scale–Location"</span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Leverage</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hatvalues</span>(final.m),</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Deviance residuals"</span>,</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Residuals vs Leverage"</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset plotting layout</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ol type="1">
<li><strong>Residuals vs Fitted (Deviance residuals)</strong></li>
</ol>
<ul>
<li><p>We look for no strong systematic pattern and residuals roughly centred around 0.</p></li>
<li><p>The residuals versus fitted plot shows the expected banding pattern typical of logistic regression with a binary outcome. Deviance residuals are generally centred around zero, with no strong systematic pattern, suggesting that the model form is broadly appropriate and there is no major lack of fit.</p></li>
</ul>
<ol start="2" type="1">
<li><strong>Q–Q Plot of Deviance Residuals</strong></li>
</ol>
<ul>
<li><p>We look for severe outliers or extreme deviations.</p></li>
<li><p>The Q–Q plot of deviance residuals shows residuals that largely follow the reference line, with mild deviations at the tails. This pattern is acceptable for a logistic regression model and does not indicate serious departures from model assumptions.</p></li>
</ul>
<ol start="3" type="1">
<li><strong>Scale–Location Plot (Spread of residuals)</strong></li>
</ol>
<ul>
<li><p>We look for whether residual variance changes drastically with fitted values.</p></li>
<li><p>The scale–location plot demonstrates moderate variability of deviance residuals across fitted values. This behaviour is expected in logistic regression due to the binomial variance structure and does not suggest problematic heteroscedasticity.</p></li>
</ul>
<ol start="4" type="1">
<li><strong>Residuals vs Leverage</strong></li>
</ol>
<ul>
<li><p>We look for points with high leverage AND large residuals.</p></li>
<li><p>The Residuals vs Leverage plot indicates that most observations have low leverage, with no extreme influential points exerting undue influence on the model estimates.</p></li>
</ul>
</section>
<section id="cooks-distance---influence-statistic-confirmation" class="level4">
<h4 class="anchored" data-anchor-id="cooks-distance---influence-statistic-confirmation">4.2.2 Cook’s distance - influence statistic (confirmation)</h4>
<p>Cook’s distance measures how much one observation influences the entire regression model. The point is influential, if removing one data point causes coefficients to change a lot, predicted values to change a lot. Cook’s distance depends on large residual and high leverage (extreme predictor values). A Cook’s distance threshold of 4/n, where n is the total number of observations, was used to identify potentially influential cases.</p>
<ol type="a">
<li>Get Cook’s distance values</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cook_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(final.m)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cook_d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
1.440e-07 2.382e-04 1.324e-03 5.537e-03 3.729e-03 1.324e-01 </code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Most observations have very low influence. One or a few observations have moderately higher influence (Cook’s distance cut off = 4/200 = 0.02).</p>
<ol start="2" type="a">
<li>Plot the Cook’s Distance</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cook_d, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Cook's distance"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Cook's distance for each observation"</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(mydata), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Bars that are above the red line (Cook/s distance = 0.02) are potentially influential.</p>
<ol start="3" type="a">
<li>List potentially influential observations</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cook_d <span class="sc">&gt;</span> cutoff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> 18  31  33  37  46  63  80 102 140 170 
 18  31  33  37  46  63  80 102 140 170 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mydata[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">29</span>, <span class="dv">41</span>, <span class="dv">68</span>, <span class="dv">85</span>, <span class="dv">104</span>, <span class="dv">108</span>, <span class="dv">118</span>, <span class="dv">123</span>, <span class="dv">136</span>, <span class="dv">170</span>, <span class="dv">172</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    years_working phys_activity   obesity    depression
11           31.4           1.4 not obese     depressed
29           27.3           0.7 not obese     depressed
41           34.7           5.6 not obese     depressed
68           32.5           0.7     obese     depressed
85           23.0           7.0 not obese not depressed
104          30.3           7.6     obese not depressed
108           0.5           6.9 not obese not depressed
118           4.3           0.7 not obese not depressed
123          25.4           3.6 not obese not depressed
136           5.5           3.2 not obese not depressed
170          10.1           7.5 not obese     depressed
172          36.7           6.2 not obese not depressed</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>Observations in rows 11, 29, 41, 68, 85, 104, 108, 118, 123, 136, 170, and 172 are potentially influential on logistic regression model and deserve closer inspection.</p>
<ol start="4" type="1">
<li>Sensitivity analysis</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>infl_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(cook_d <span class="sc">&gt;</span> cutoff)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>model_full  <span class="ot">&lt;-</span> final.m</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>model_no_infl <span class="ot">&lt;-</span> </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata[<span class="sc">-</span>infl_idx, ],</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_no_infl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata[-infl_idx, ])

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -3.00500    0.88263  -3.405 0.000663 ***
years_working               0.15246    0.03232   4.717 2.40e-06 ***
phys_activity              -0.56294    0.12857  -4.379 1.19e-05 ***
obesityobese               18.03917    8.06101   2.238 0.025232 *  
phys_activity:obesityobese -4.02815    1.96781  -2.047 0.040656 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 223.018  on 189  degrees of freedom
Residual deviance:  95.492  on 185  degrees of freedom
AIC: 105.49

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>convert the coefficient into the odds ratio</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_full, <span class="at">conf.int =</span> T, <span class="at">exponentiate =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)               0.145    0.596      -3.24 1.21e-3   0.0417     0.439
2 years_working             1.09     0.0198      4.55 5.33e-6   1.05       1.14 
3 phys_activity             0.738    0.0857     -3.54 3.97e-4   0.618      0.867
4 obesityobese             67.2      1.26        3.34 8.53e-4   7.46    1176.   
5 phys_activity:obesity…    0.436    0.287      -2.89 3.81e-3   0.227      0.716</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_no_infl, <span class="at">conf.int =</span> T, <span class="at">exponentiate =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)             4.95e-2    0.883      -3.40 6.63e-4  6.98e-3  2.35e- 1
2 years_working           1.16e+0    0.0323      4.72 2.40e-6  1.10e+0  1.25e+ 0
3 phys_activity           5.70e-1    0.129      -4.38 1.19e-5  4.31e-1  7.17e- 1
4 obesityobese            6.83e+7    8.06        2.24 2.52e-2  1.34e+3  2.83e+16
5 phys_activity:obesity…  1.78e-2    1.97       -2.05 4.07e-2  1.30e-4  2.35e- 1</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li><p>Sensitivity analysis using Cook’s distance showed that removal of influential observations resulted in inflation of the odds ratio for obesity, accompanied by wide confidence intervals.</p></li>
<li><p>However, the direction of association remained consistent, and no sign reversal was observed.</p></li>
<li><p>Given the presence of an interaction term between physical activity and obesity, the main effect of obesity reflects the effect at the reference level of physical activity and is therefore sensitive to data sparsity.</p></li>
<li><p>The full model was retained as the primary model due to greater estimate stability.</p></li>
</ul>
<p>“Why is obesity OR so large?”</p>
<ul>
<li>In models including interaction terms, the main effect of obesity represents the effect when physical activity equals zero. This estimate is highly sensitive to sparse data and removal of influential observations, leading to inflated odds ratios. Therefore, interpretation focused on the combined effects rather than the obesity coefficient alone.</li>
</ul>
</section>
</section>
<section id="dfbetas" class="level3">
<h3 class="anchored" data-anchor-id="dfbetas">4.2.2 DFBETAS</h3>
<p>DFBETAS were examined to assess the influence of individual observations on each regression coefficient. Observations with absolute DFBETAS values exceeding the recommended threshold (values greater than 2/sqrt, n = 2/sqrt, n = 0.14) suggest potentially influential observations for that coefficient.</p>
<ol type="a">
<li>Gets the DFBETAS value</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(final.m)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dfb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200   5</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dfb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) years_working phys_activity obesityobese
1 -0.001683825   0.002285335 -0.0005019574  0.005095184
2 -0.002961321   0.004019190 -0.0008827861  0.008774891
3 -0.002289651   0.003107580 -0.0006825575  0.007298930
4 -0.093432716   0.040818130  0.0414658367  0.035639942
5 -0.122470955  -0.006255842  0.1323901400  0.059116649
6  0.001071288  -0.058376051  0.0041393686  0.011607147
  phys_activity:obesityobese
1               -0.004811127
2               -0.008155727
3               -0.006853859
4               -0.019995924
5               -0.038354208
6                0.009658281</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Define the threshold</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>cutoff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1414214</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Identify influential observations</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>infl_dfb <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(dfb) <span class="sc">&gt;</span> cutoff, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>infl_dfb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    row col
18   18   1
19   19   1
21   21   1
31   31   1
52   52   1
62   62   1
80   80   1
81   81   1
84   84   1
102 102   1
138 138   1
185 185   1
187 187   1
192 192   1
31   31   2
46   46   2
62   62   2
80   80   2
84   84   2
102 102   2
109 109   2
112 112   2
170 170   2
180 180   2
189 189   2
18   18   3
19   19   3
21   21   3
29   29   3
45   45   3
63   63   3
112 112   3
140 140   3
142 142   3
148 148   3
170 170   3
185 185   3
189 189   3
191 191   3
8     8   4
22   22   4
31   31   4
33   33   4
37   37   4
46   46   4
55   55   4
150 150   4
8     8   5
31   31   5
33   33   5
37   37   5
46   46   5
55   55   5
70   70   5
86   86   5
150 150   5
169 169   5
175 175   5</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Optional plot</li>
</ol>
<ul>
<li>Years of working</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfb[, <span class="st">"years_working"</span>], <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"DFBETAS for years_working"</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation"</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span>  cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span>cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Physical activity score</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfb[, <span class="st">"phys_activity"</span>], <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"DFBETAS for phys_activity"</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation"</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span>  cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span>cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="5" type="a">
<li>Model with influential observation</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>model_full_infl_dfb  <span class="ot">&lt;-</span> final.m</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full_infl_dfb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<ul>
<li>Convert the log odds to odds ratio</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_full_infl_dfb, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exp =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
  term                   estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)               0.145    0.596      -3.24 1.21e-3   0.0417     0.439
2 years_working             1.09     0.0198      4.55 5.33e-6   1.05       1.14 
3 phys_activity             0.738    0.0857     -3.54 3.97e-4   0.618      0.867
4 obesityobese             67.2      1.26        3.34 8.53e-4   7.46    1176.   
5 phys_activity:obesity…    0.436    0.287      -2.89 3.81e-3   0.227      0.716</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>DFBETAS analysis identified several observations exceeding the recommended cutoff for multiple regression coefficients, indicating the presence of influential observations. However, findings from sensitivity analysis using Cook’s distance showed that exclusion of these observations did not result in meaningful changes in the direction or interpretation of the estimated associations. Therefore, the full model was retained for inference.</p>
</section>
<section id="leverage-points" class="level3">
<h3 class="anchored" data-anchor-id="leverage-points">4.2.3 Leverage points</h3>
<p>Assume final model:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(final.m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = depression ~ years_working + phys_activity + obesity + 
    phys_activity:obesity, family = binomial(link = "logit"), 
    data = mydata)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                -1.92861    0.59568  -3.238 0.001205 ** 
years_working               0.09016    0.01981   4.551 5.33e-06 ***
phys_activity              -0.30349    0.08568  -3.542 0.000397 ***
obesityobese                4.20809    1.26177   3.335 0.000853 ***
phys_activity:obesityobese -0.83051    0.28701  -2.894 0.003808 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 244.35  on 199  degrees of freedom
Residual deviance: 161.84  on 195  degrees of freedom
AIC: 171.84

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<ol type="a">
<li>Get hat values (leverage)</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>lev <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(final.m)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lev)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.001339 0.011801 0.020488 0.025000 0.033356 0.132858 </code></pre>
</div>
</div>
<ol start="2" type="a">
<li>Set a threshold and list high‑leverage points</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(final.m)) </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>cutoff_2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> p <span class="sc">/</span> n</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>cutoff_3 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> p <span class="sc">/</span> n</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(lev <span class="sc">&gt;</span> cutoff_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  8  31  38  44  55  70  71  86 133 141 150 169 175 
  8  31  38  44  55  70  71  86 133 141 150 169 175 </code></pre>
</div>
</div>
<ol start="3" type="a">
<li>Inspect those points</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>high_lev_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(lev <span class="sc">&gt;</span> cutoff_2)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>mydata[high_lev_idx, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    years_working phys_activity obesity    depression
8            13.2           1.7   obese     depressed
31            5.9           1.6   obese not depressed
38            3.6           3.6   obese not depressed
44           11.5           0.9   obese     depressed
55            9.8           2.2   obese     depressed
70           36.7           5.9   obese not depressed
71           38.0           7.3   obese not depressed
86           37.8           6.3   obese not depressed
133          34.2           4.4   obese     depressed
141          30.6           4.9   obese not depressed
150          12.3           1.3   obese     depressed
169          32.9           5.8   obese not depressed
175          38.6           5.5   obese not depressed</code></pre>
</div>
</div>
<ol start="4" type="a">
<li>Plot leverage</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final.m, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation:</p>
<ul>
<li><p>The Residuals vs Leverage plot was examined to assess the presence of influential observations in the logistic regression model. Most observations cluster at low leverage values and have standardized Pearson residuals close to zero, indicating that the majority of data points do not exert undue influence on the model estimates.</p></li>
<li><p>A small number of observations (e.g.&nbsp;observations labelled 31, 33, and 37) show relatively higher leverage and larger residuals compared with the rest of the sample. However, these points lie within the Cook’s distance contours, suggesting that none of the observations exert excessive influence on the fitted model.</p></li>
<li><p>Overall, the plot does not indicate the presence of highly influential observations that would compromise the stability of the model, and no single data point appears to disproportionately affect the regression estimates.</p></li>
</ul>
</section>
</section>
<section id="model-fitness" class="level2">
<h2 class="anchored" data-anchor-id="model-fitness">5. Model fitness</h2>
<p>Model fitness is checked by using:</p>
<ol type="1">
<li>Hosmer–Lemeshow goodness-of-fit test</li>
<li>Area under the Receiver Operating Characteristic (ROC) curve</li>
<li>Classification table / matrix</li>
</ol>
<section id="hosmerlemeshow-goodness-of-fit-test" class="level3">
<h3 class="anchored" data-anchor-id="hosmerlemeshow-goodness-of-fit-test">5.1 Hosmer–Lemeshow goodness-of-fit test</h3>
<p>The Hosmer–Lemeshow goodness-of-fit test checks whether the predicted probabilities from the logistic regression agree with the observed outcomes in which p value &gt; 0.05 indicated that the model fits the data well.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check on the data</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydata<span class="sc">$</span>depression)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 2 levels "not depressed",..: 2 2 2 1 1 1 1 2 1 1 ...</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert outcome to numeric 0/1</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>depression_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mydata<span class="sc">$</span>depression <span class="sc">==</span> <span class="st">"depressed"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">fitted</span>(final.m),</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> <span class="dv">5</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Hosmer and Lemeshow goodness of fit (GOF) test

data:  mydata$depression_num, fitted(final.m)
X-squared = 13.141, df = 3, p-value = 0.004341</code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li><p>The Hosmer–Lemeshow goodness-of-fit test for the final logistic regression model was statistically significant (χ² = 13.14, df = 3, p = 0.004). With a sample size of 200, the Hosmer–Lemeshow test is known to be highly sensitive, such that even small and practically unimportant deviations between observed and expected values may result in a statistically significant p-value. As a result, a significant Hosmer–Lemeshow test does not necessarily indicate that the model is unusable or poorly performing.</p></li>
<li><p>Importantly, other measures of model performance indicate that the model performs well. The model demonstrated excellent discriminative ability, with an area under the ROC curve (AUC) of 85.9%, indicating strong ability to distinguish between depressed and non-depressed individuals. In addition, the overall classification accuracy was 86.0%, further supporting the adequacy of the model in correctly classifying outcomes.</p></li>
<li><p>Model diagnostic plots did not reveal major violations of model assumptions or influential observations, and the regression coefficients were stable and clinically interpretable. Taken together, these findings suggest that although the Hosmer–Lemeshow test indicates imperfect calibration, the model demonstrates good discrimination and acceptable overall fit.</p></li>
<li><p>Therefore, the model was considered appropriate for use, particularly for inference and risk discrimination, with the limitation of imperfect calibration acknowledged.</p></li>
</ul>
</section>
<section id="area-under-the-receiver-operating-characteristic-roc-curve" class="level3">
<h3 class="anchored" data-anchor-id="area-under-the-receiver-operating-characteristic-roc-curve">5.2 Area under the Receiver Operating Characteristic (ROC) curve</h3>
<ul>
<li>The Receiver Operating Characteristic (ROC) curve is used to evaluate how well a logistic regression model can distinguish between individuals with and without the outcome of interest. It assesses the model’s performance across all possible probability cut-off values by plotting sensitivity against 1 − specificity. The Area Under the ROC Curve (AUC) provides a single summary measure of this discriminatory ability, representing the probability that the model assigns a higher predicted risk to an individual with the outcome compared to an individual without the outcome. An AUC value closer to 1 indicates better model performance, the recommended area under the ROC curve is at least 0.70 while an AUC of 0.5 suggests no discriminatory ability beyond random chance.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ROC object</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> <span class="fu">fitted</span>(final.m)</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get AUC / CI value</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Area under the curve: 0.859</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc_obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: 0.7964-0.9217 (DeLong)</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curve with AUC and 95% CI</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>roc_model <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> <span class="fu">fitted</span>(final.m),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">print.auc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">legacy.axes =</span> <span class="cn">TRUE</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ul>
<li>The ROC analysis demonstrated excellent model discrimination, with an area under the curve (AUC) of 0.859 (95% CI: 0.796–0.922). This indicates that the model has a strong ability to distinguish between depressed and non-depressed individuals. The model can accurately discriminate 85.9% of the individuals.</li>
</ul>
</section>
<section id="classification-table-confusion-matrix-classification-metrics" class="level3">
<h3 class="anchored" data-anchor-id="classification-table-confusion-matrix-classification-metrics">5.3 Classification table (Confusion matrix) / Classification metrics</h3>
<p>Model classification performance was evaluated using a classification table and derived performance metrics. At a probability cut-off of 0.5, sensitivity, specificity, accuracy, positive predictive value, and negative predictive value were calculated to assess the model’s ability to correctly classify depressed and non-depressed individuals.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">fitted</span>(final.m)</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut-off</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted class</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> cutoff, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to factors (required by caret)</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>obs_class  <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>depression_num, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix and metrics</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_class, obs_class, <span class="at">positive =</span> <span class="st">"1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   0   1
         0 133  21
         1   7  39
                                          
               Accuracy : 0.86            
                 95% CI : (0.8041, 0.9049)
    No Information Rate : 0.7             
    P-Value [Acc &gt; NIR] : 9.991e-08       
                                          
                  Kappa : 0.6429          
                                          
 Mcnemar's Test P-Value : 0.01402         
                                          
            Sensitivity : 0.6500          
            Specificity : 0.9500          
         Pos Pred Value : 0.8478          
         Neg Pred Value : 0.8636          
             Prevalence : 0.3000          
         Detection Rate : 0.1950          
   Detection Prevalence : 0.2300          
      Balanced Accuracy : 0.8000          
                                          
       'Positive' Class : 1               
                                          </code></pre>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<p>At a probability cut-off of 0.5, the model achieved an overall accuracy of 86.0%. The specificity was high (95.0%), indicating strong ability to correctly identify non-depressed individuals, while sensitivity was low (65.0%), suggesting limited ability to detect all depressed cases. The balanced accuracy was 80.0%, reflecting good overall classification performance in the presence of class imbalance.</p>
</section>
</section>
<section id="results-presentation" class="level2">
<h2 class="anchored" data-anchor-id="results-presentation">6 RESULTS PRESENTATION</h2>
<p>Final model consists of covariates:</p>
<ol type="1">
<li>Years of working</li>
<li>Physical activity score”,</li>
<li>Obesity</li>
<li>Physical activity × Obesity</li>
</ol>
<section id="coefficients-table-β-se-p-value-95-ci" class="level3">
<h3 class="anchored" data-anchor-id="coefficients-table-β-se-p-value-95-ci">6.1 Coefficients table (β, SE, p-value, 95% CI)</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient table with CI</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>reg_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">FALSE</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, p.value, conf.low, conf.high)</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>reg_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 6
  term                       estimate std.error    p.value conf.low conf.high
  &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)                 -1.93      0.596  0.00121     -3.18      -0.822
2 years_working                0.0902    0.0198 0.00000533   0.0534     0.132
3 phys_activity               -0.303     0.0857 0.000397    -0.481     -0.143
4 obesityobese                 4.21      1.26   0.000853     2.01       7.07 
5 phys_activity:obesityobese  -0.831     0.287  0.00381     -1.48      -0.335</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="ot">&lt;-</span> reg_table <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">case_when</span>(</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"(Intercept)"</span> <span class="sc">~</span> <span class="st">"Constant"</span>,</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"years_working"</span> <span class="sc">~</span> <span class="st">"Years of working"</span>,</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity"</span> <span class="sc">~</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"obesityobese"</span> <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span> <span class="sc">~</span> </span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical activity × Obesity"</span>,</span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="ot">&lt;-</span> reg_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">2</span>),</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.low =</span> <span class="fu">round</span>(conf.low, <span class="dv">2</span>),</span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.high =</span> <span class="fu">round</span>(conf.high, <span class="dv">2</span>),</span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>))</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> term,</span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">β</span><span class="st">`</span> <span class="ot">=</span> estimate,</span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SE</span><span class="st">`</span> <span class="ot">=</span> std.error,</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p.value,</span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Lower)</span><span class="st">`</span> <span class="ot">=</span> conf.low,</span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Upper)</span><span class="st">`</span> <span class="ot">=</span> conf.high</span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-36"><a href="#cb106-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb106-37"><a href="#cb106-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 1. Logistic regression coefficients for factors associated with depression"</span>,</span>
<span id="cb106-38"><a href="#cb106-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model including physical activity × obesity interaction"</span></span>
<span id="cb106-39"><a href="#cb106-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb106-40"><a href="#cb106-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb106-41"><a href="#cb106-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"β coefficients are presented on the log-odds scale. CI = confidence interval."</span></span>
<span id="cb106-42"><a href="#cb106-42" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="rambyvzbnv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rambyvzbnv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rambyvzbnv thead, #rambyvzbnv tbody, #rambyvzbnv tfoot, #rambyvzbnv tr, #rambyvzbnv td, #rambyvzbnv th {
  border-style: none;
}

#rambyvzbnv p {
  margin: 0;
  padding: 0;
}

#rambyvzbnv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rambyvzbnv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rambyvzbnv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rambyvzbnv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rambyvzbnv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rambyvzbnv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rambyvzbnv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rambyvzbnv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rambyvzbnv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rambyvzbnv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rambyvzbnv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rambyvzbnv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rambyvzbnv .gt_spanner_row {
  border-bottom-style: hidden;
}

#rambyvzbnv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rambyvzbnv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rambyvzbnv .gt_from_md > :first-child {
  margin-top: 0;
}

#rambyvzbnv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rambyvzbnv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rambyvzbnv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rambyvzbnv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rambyvzbnv .gt_row_group_first td {
  border-top-width: 2px;
}

#rambyvzbnv .gt_row_group_first th {
  border-top-width: 2px;
}

#rambyvzbnv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rambyvzbnv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rambyvzbnv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rambyvzbnv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rambyvzbnv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rambyvzbnv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rambyvzbnv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rambyvzbnv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rambyvzbnv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rambyvzbnv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rambyvzbnv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rambyvzbnv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rambyvzbnv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rambyvzbnv .gt_left {
  text-align: left;
}

#rambyvzbnv .gt_center {
  text-align: center;
}

#rambyvzbnv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rambyvzbnv .gt_font_normal {
  font-weight: normal;
}

#rambyvzbnv .gt_font_bold {
  font-weight: bold;
}

#rambyvzbnv .gt_font_italic {
  font-style: italic;
}

#rambyvzbnv .gt_super {
  font-size: 65%;
}

#rambyvzbnv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rambyvzbnv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rambyvzbnv .gt_indent_1 {
  text-indent: 5px;
}

#rambyvzbnv .gt_indent_2 {
  text-indent: 10px;
}

#rambyvzbnv .gt_indent_3 {
  text-indent: 15px;
}

#rambyvzbnv .gt_indent_4 {
  text-indent: 20px;
}

#rambyvzbnv .gt_indent_5 {
  text-indent: 25px;
}

#rambyvzbnv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rambyvzbnv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="6" class="gt_heading gt_title gt_font_normal">Table 1. Logistic regression coefficients for factors associated with depression</th>
</tr>
<tr class="gt_heading even">
<th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Model including physical activity × obesity interaction</th>
</tr>
<tr class="gt_col_headings header">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variables</th>
<th id="aβ" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">β</th>
<th id="SE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SE</th>
<th id="p-value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">p-value</th>
<th id="a95%-CI-(Lower)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI (Lower)</th>
<th id="a95%-CI-(Upper)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI (Upper)</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">Constant</td>
<td class="gt_row gt_right" headers="β">-1.93</td>
<td class="gt_row gt_right" headers="SE">0.60</td>
<td class="gt_row gt_left" headers="p-value">0.001</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">-3.18</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">-0.82</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">Years of working</td>
<td class="gt_row gt_right" headers="β">0.09</td>
<td class="gt_row gt_right" headers="SE">0.02</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">0.05</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">0.13</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">Physical activity score</td>
<td class="gt_row gt_right" headers="β">-0.30</td>
<td class="gt_row gt_right" headers="SE">0.09</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">-0.48</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">-0.14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">Obesity</td>
<td class="gt_row gt_right" headers="β">4.21</td>
<td class="gt_row gt_right" headers="SE">1.26</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">2.01</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">7.07</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">Physical activity × Obesity</td>
<td class="gt_row gt_right" headers="β">-0.83</td>
<td class="gt_row gt_right" headers="SE">0.29</td>
<td class="gt_row gt_left" headers="p-value">0.004</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">-1.48</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">-0.33</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="6" class="gt_sourcenote">β coefficients are presented on the log-odds scale. CI = confidence interval.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="odds-ratios-aic-pseudo-r²" class="level3">
<h3 class="anchored" data-anchor-id="odds-ratios-aic-pseudo-r²">6.2 Odds ratios, AIC, pseudo-R²</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>or_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, conf.low, conf.high, p.value) </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table <span class="sc">%&gt;%</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">case_when</span>(</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"(Intercept)"</span> <span class="sc">~</span> <span class="st">"Constant"</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"years_working"</span> <span class="sc">~</span> <span class="st">"Years of working"</span>,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity"</span> <span class="sc">~</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"obesityobese"</span> <span class="sc">~</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span> <span class="sc">~</span> </span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical activity × Obesity"</span>,</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.low =</span> <span class="fu">round</span>(conf.low, <span class="dv">2</span>),</span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.high =</span> <span class="fu">round</span>(conf.high, <span class="dv">2</span>),</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>))</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> term,</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AdjOR</span><span class="st">`</span> <span class="ot">=</span> estimate,</span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Lower)</span><span class="st">`</span> <span class="ot">=</span> conf.low,</span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Upper)</span><span class="st">`</span> <span class="ot">=</span> conf.high,</span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p.value</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">!=</span> <span class="st">"Constant"</span>)</span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2. Logistic regression (Odds ratios) for factors associated with depression"</span>,</span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model including physical activity × obesity interaction"</span></span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Odds ratios greater than 1 indicate higher odds of depression; values less than 1 indicate lower odds. CI = confidence interval."</span></span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="exlldokxxv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#exlldokxxv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#exlldokxxv thead, #exlldokxxv tbody, #exlldokxxv tfoot, #exlldokxxv tr, #exlldokxxv td, #exlldokxxv th {
  border-style: none;
}

#exlldokxxv p {
  margin: 0;
  padding: 0;
}

#exlldokxxv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#exlldokxxv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#exlldokxxv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#exlldokxxv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#exlldokxxv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#exlldokxxv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exlldokxxv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#exlldokxxv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#exlldokxxv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#exlldokxxv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#exlldokxxv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#exlldokxxv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#exlldokxxv .gt_spanner_row {
  border-bottom-style: hidden;
}

#exlldokxxv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#exlldokxxv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#exlldokxxv .gt_from_md > :first-child {
  margin-top: 0;
}

#exlldokxxv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#exlldokxxv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#exlldokxxv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#exlldokxxv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#exlldokxxv .gt_row_group_first td {
  border-top-width: 2px;
}

#exlldokxxv .gt_row_group_first th {
  border-top-width: 2px;
}

#exlldokxxv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#exlldokxxv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#exlldokxxv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#exlldokxxv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exlldokxxv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#exlldokxxv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#exlldokxxv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#exlldokxxv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#exlldokxxv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#exlldokxxv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#exlldokxxv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#exlldokxxv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#exlldokxxv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#exlldokxxv .gt_left {
  text-align: left;
}

#exlldokxxv .gt_center {
  text-align: center;
}

#exlldokxxv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#exlldokxxv .gt_font_normal {
  font-weight: normal;
}

#exlldokxxv .gt_font_bold {
  font-weight: bold;
}

#exlldokxxv .gt_font_italic {
  font-style: italic;
}

#exlldokxxv .gt_super {
  font-size: 65%;
}

#exlldokxxv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#exlldokxxv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#exlldokxxv .gt_indent_1 {
  text-indent: 5px;
}

#exlldokxxv .gt_indent_2 {
  text-indent: 10px;
}

#exlldokxxv .gt_indent_3 {
  text-indent: 15px;
}

#exlldokxxv .gt_indent_4 {
  text-indent: 20px;
}

#exlldokxxv .gt_indent_5 {
  text-indent: 25px;
}

#exlldokxxv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#exlldokxxv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal">Table 2. Logistic regression (Odds ratios) for factors associated with depression</th>
</tr>
<tr class="gt_heading even">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Model including physical activity × obesity interaction</th>
</tr>
<tr class="gt_col_headings header">
<th id="Term" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Term</th>
<th id="AdjOR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AdjOR</th>
<th id="a95%-CI-(Lower)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI (Lower)</th>
<th id="a95%-CI-(Upper)" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">95% CI (Upper)</th>
<th id="p-value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">p-value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Term">Years of working</td>
<td class="gt_row gt_right" headers="AdjOR">1.09</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">1.05</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">1.14</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Term">Physical activity score</td>
<td class="gt_row gt_right" headers="AdjOR">0.74</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">0.62</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">0.87</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Term">Obesity status</td>
<td class="gt_row gt_right" headers="AdjOR">67.23</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">7.46</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">1176.33</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Term">Physical activity × Obesity</td>
<td class="gt_row gt_right" headers="AdjOR">0.44</td>
<td class="gt_row gt_right" headers="95% CI (Lower)">0.23</td>
<td class="gt_row gt_right" headers="95% CI (Upper)">0.72</td>
<td class="gt_row gt_left" headers="p-value">0.004</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="5" class="gt_sourcenote">Odds ratios greater than 1 indicate higher odds of depression; values less than 1 indicate lower odds. CI = confidence interval.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Table 2. presents adjusted odds ratios (OR) with 95% confidence intervals for factors associated with depression. The model includes an interaction term between physical activity score and obesity status.</p>
</section>
<section id="aic-pseudo-r²" class="level3">
<h3 class="anchored" data-anchor-id="aic-pseudo-r²">6.3 AIC, pseudo-R²</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>model_fit_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Main effects model"</span>, <span class="st">"Interaction model"</span>),</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AIC</span>(model1_mlr),</span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AIC</span>(final.m)</span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">r2_nagelkerke</span>(model1_mlr),</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">r2_nagelkerke</span>(final.m)</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> <span class="fu">round</span>(AIC, <span class="dv">2</span>),</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span>, <span class="dv">3</span>)</span>
<span id="cb108-19"><a href="#cb108-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb108-20"><a href="#cb108-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-21"><a href="#cb108-21" aria-hidden="true" tabindex="-1"></a>model_fit_table <span class="sc">%&gt;%</span></span>
<span id="cb108-22"><a href="#cb108-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb108-23"><a href="#cb108-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb108-24"><a href="#cb108-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3. Model Fit Comparison for Multiple Logistic Regression Models"</span></span>
<span id="cb108-25"><a href="#cb108-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb108-26"><a href="#cb108-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb108-27"><a href="#cb108-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Lower AIC and higher Nagelkerke R² indicate better model fit."</span></span>
<span id="cb108-28"><a href="#cb108-28" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="iqytjovqpr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iqytjovqpr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iqytjovqpr thead, #iqytjovqpr tbody, #iqytjovqpr tfoot, #iqytjovqpr tr, #iqytjovqpr td, #iqytjovqpr th {
  border-style: none;
}

#iqytjovqpr p {
  margin: 0;
  padding: 0;
}

#iqytjovqpr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iqytjovqpr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iqytjovqpr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iqytjovqpr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iqytjovqpr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iqytjovqpr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqytjovqpr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iqytjovqpr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iqytjovqpr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iqytjovqpr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iqytjovqpr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iqytjovqpr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iqytjovqpr .gt_spanner_row {
  border-bottom-style: hidden;
}

#iqytjovqpr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iqytjovqpr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iqytjovqpr .gt_from_md > :first-child {
  margin-top: 0;
}

#iqytjovqpr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iqytjovqpr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iqytjovqpr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iqytjovqpr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iqytjovqpr .gt_row_group_first td {
  border-top-width: 2px;
}

#iqytjovqpr .gt_row_group_first th {
  border-top-width: 2px;
}

#iqytjovqpr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqytjovqpr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iqytjovqpr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iqytjovqpr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqytjovqpr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqytjovqpr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iqytjovqpr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iqytjovqpr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iqytjovqpr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iqytjovqpr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iqytjovqpr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqytjovqpr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iqytjovqpr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iqytjovqpr .gt_left {
  text-align: left;
}

#iqytjovqpr .gt_center {
  text-align: center;
}

#iqytjovqpr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iqytjovqpr .gt_font_normal {
  font-weight: normal;
}

#iqytjovqpr .gt_font_bold {
  font-weight: bold;
}

#iqytjovqpr .gt_font_italic {
  font-style: italic;
}

#iqytjovqpr .gt_super {
  font-size: 65%;
}

#iqytjovqpr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iqytjovqpr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iqytjovqpr .gt_indent_1 {
  text-indent: 5px;
}

#iqytjovqpr .gt_indent_2 {
  text-indent: 10px;
}

#iqytjovqpr .gt_indent_3 {
  text-indent: 15px;
}

#iqytjovqpr .gt_indent_4 {
  text-indent: 20px;
}

#iqytjovqpr .gt_indent_5 {
  text-indent: 25px;
}

#iqytjovqpr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iqytjovqpr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Table 3. Model Fit Comparison for Multiple Logistic Regression Models</th>
</tr>
<tr class="gt_col_headings even">
<th id="Model" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Model</th>
<th id="AIC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">AIC</th>
<th id="Nagelkerke-R²" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Nagelkerke R²</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Model">Main effects model</td>
<td class="gt_row gt_right" headers="AIC">182.60</td>
<td class="gt_row gt_right" headers="Nagelkerke R²">0.417</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Model">Interaction model</td>
<td class="gt_row gt_right" headers="AIC">171.84</td>
<td class="gt_row gt_right" headers="Nagelkerke R²">0.479</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="3" class="gt_sourcenote">Lower AIC and higher Nagelkerke R² indicate better model fit.</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="interaction-plots" class="level3">
<h3 class="anchored" data-anchor-id="interaction-plots">6.4 Interaction plots</h3>
<p>Predicted probability of depression vs.&nbsp;physical activity score, with separate lines for obese and non-obese</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> phys_activity,</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> obesity,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Physical Activity Score"</span>,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.main =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main.title =</span> <span class="st">"Predicted Probability of Depression by Physical Activity and Obesity Status"</span>,</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx.labels =</span> <span class="fu">c</span>(<span class="st">"Not Obese"</span>, <span class="st">"Obese"</span>)</span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Logistic-Regression-Analysis-of-Depression_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Interpretation:</em></strong></p>
<ol type="1">
<li><strong>Non-obese individuals</strong></li>
</ol>
<p>Among non-obese individuals, the predicted probability of depression starts at a moderate level when physical activity is low and declines gradually as physical activity increases. This indicates a steady but modest protective effect of physical activity in this group. Even at higher physical activity scores, the probability of depression decreases progressively rather than sharply, suggesting that physical activity reduces depression risk consistently but without a dramatic change in slope.</p>
<ol start="2" type="1">
<li><strong>Obese individuals</strong></li>
</ol>
<p>In contrast, obese individuals show a much higher predicted probability of depression at very low levels of physical activity. However, as physical activity increases, the predicted probability of depression declines sharply, with a much steeper slope compared to the non-obese group. At moderate to high physical activity levels, the predicted probability among obese individuals becomes very low and approaches zero, indicating a substantially stronger protective effect of physical activity in this group.</p>
<ol start="3" type="1">
<li><strong>Evidence of interaction (effect modification)</strong></li>
</ol>
<p>The clear difference in the slopes of the two curves provides visual evidence of an interaction between physical activity and obesity status. Specifically, the effect of physical activity on depression is not uniform across obesity groups. Physical activity has a disproportionately larger impact on reducing depression risk among obese individuals compared with non-obese individuals. This visual pattern is consistent with the statistically significant interaction term observed in the regression model.</p>
</section>
<section id="final-model" class="level3">
<h3 class="anchored" data-anchor-id="final-model">6.5 Final model</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> {</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Extract B and SE ----</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  coef_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>    final.m,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">FALSE</span></span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Extract OR and CI ----</span></span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>  or_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>    final.m,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, conf.low, conf.high, p.value)</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>  table_all <span class="ot">&lt;-</span> coef_table <span class="sc">%&gt;%</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(or_table, <span class="at">by =</span> <span class="st">"term"</span>)</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Build table ----</span></span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Years Working</span></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"years_working"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Years Working"</span>),</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Physical Activity</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Physical Activity Score"</span>),</span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obesity header</span></span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.x =</span> <span class="cn">NA</span>, <span class="at">std.error =</span> <span class="cn">NA</span>,</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.y =</span> <span class="cn">NA</span>, <span class="at">conf.low =</span> <span class="cn">NA</span>, <span class="at">conf.high =</span> <span class="cn">NA</span>,</span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="cn">NA</span></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Not Obese (reference)</span></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="st">"  Not Obese"</span>,</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.x =</span> <span class="dv">1</span>,</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="cn">NA</span>,</span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.y =</span> <span class="dv">1</span>,</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.low =</span> <span class="cn">NA</span>,</span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.high =</span> <span class="cn">NA</span>,</span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="cn">NA</span></span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obese</span></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"obesityobese"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"  Obese"</span>),</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Interaction (single row only)</span></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Physical Activity Score * Obesity Status"</span>)</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Formatting ----</span></span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">B =</span> <span class="fu">case_when</span>(</span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"  Not Obese"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(estimate.x) <span class="sc">~</span> <span class="st">""</span>,</span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, estimate.x)</span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(std.error), <span class="st">""</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, std.error)),</span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adj OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"  Not Obese"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(estimate.y) <span class="sc">~</span> <span class="st">""</span>,</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, estimate.y), <span class="st">" ("</span>,</span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, conf.low), <span class="st">", "</span>,</span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, conf.high), <span class="st">")"</span></span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(p.value),</span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p.value))</span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> term,</span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true" tabindex="-1"></a>    B,</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true" tabindex="-1"></a>    SE,</span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adj OR (95% CI)</span><span class="st">`</span>,</span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span></span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- GT table ----</span></span>
<span id="cb110-105"><a href="#cb110-105" aria-hidden="true" tabindex="-1"></a>final_table <span class="sc">%&gt;%</span></span>
<span id="cb110-106"><a href="#cb110-106" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb110-107"><a href="#cb110-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb110-108"><a href="#cb110-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Table 4. Final Multivariable Logistic Regression Model for Depression**"</span>)</span>
<span id="cb110-109"><a href="#cb110-109" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-110"><a href="#cb110-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-111"><a href="#cb110-111" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold column headers</span></span>
<span id="cb110-112"><a href="#cb110-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb110-113"><a href="#cb110-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-114"><a href="#cb110-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())</span>
<span id="cb110-115"><a href="#cb110-115" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-116"><a href="#cb110-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-117"><a href="#cb110-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold only main variable rows</span></span>
<span id="cb110-118"><a href="#cb110-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb110-119"><a href="#cb110-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb110-120"><a href="#cb110-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb110-121"><a href="#cb110-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Variables,</span>
<span id="cb110-122"><a href="#cb110-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Variables <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb110-123"><a href="#cb110-123" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Years Working"</span>,</span>
<span id="cb110-124"><a href="#cb110-124" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical Activity Score"</span>,</span>
<span id="cb110-125"><a href="#cb110-125" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Obesity Status"</span>,</span>
<span id="cb110-126"><a href="#cb110-126" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical Activity Score * Obesity Status"</span></span>
<span id="cb110-127"><a href="#cb110-127" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb110-128"><a href="#cb110-128" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-129"><a href="#cb110-129" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-130"><a href="#cb110-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-131"><a href="#cb110-131" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cols_align</span>(</span>
<span id="cb110-132"><a href="#cb110-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb110-133"><a href="#cb110-133" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>Variables</span>
<span id="cb110-134"><a href="#cb110-134" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-135"><a href="#cb110-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-136"><a href="#cb110-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb110-137"><a href="#cb110-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="fu">paste</span>(</span>
<span id="cb110-138"><a href="#cb110-138" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Constant = -1.93;"</span>,</span>
<span id="cb110-139"><a href="#cb110-139" aria-hidden="true" tabindex="-1"></a>      <span class="st">"No multicollinearity;"</span>,</span>
<span id="cb110-140"><a href="#cb110-140" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Hosmer–Lemeshow test p-value = 0.004;"</span>,</span>
<span id="cb110-141"><a href="#cb110-141" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Classification accuracy = 86.0%;"</span>,</span>
<span id="cb110-142"><a href="#cb110-142" aria-hidden="true" tabindex="-1"></a>      <span class="st">"AUC (ROC) = 85.9%;"</span>,</span>
<span id="cb110-143"><a href="#cb110-143" aria-hidden="true" tabindex="-1"></a>      <span class="st">"AIC = 171.84;"</span>,</span>
<span id="cb110-144"><a href="#cb110-144" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Nagelkerke’s R² = 0.479;"</span>,</span>
<span id="cb110-145"><a href="#cb110-145" aria-hidden="true" tabindex="-1"></a>      <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb110-146"><a href="#cb110-146" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-147"><a href="#cb110-147" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="xwnxmuftmq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xwnxmuftmq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xwnxmuftmq thead, #xwnxmuftmq tbody, #xwnxmuftmq tfoot, #xwnxmuftmq tr, #xwnxmuftmq td, #xwnxmuftmq th {
  border-style: none;
}

#xwnxmuftmq p {
  margin: 0;
  padding: 0;
}

#xwnxmuftmq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xwnxmuftmq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xwnxmuftmq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xwnxmuftmq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xwnxmuftmq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwnxmuftmq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwnxmuftmq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwnxmuftmq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xwnxmuftmq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xwnxmuftmq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xwnxmuftmq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xwnxmuftmq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xwnxmuftmq .gt_spanner_row {
  border-bottom-style: hidden;
}

#xwnxmuftmq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xwnxmuftmq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xwnxmuftmq .gt_from_md > :first-child {
  margin-top: 0;
}

#xwnxmuftmq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xwnxmuftmq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xwnxmuftmq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xwnxmuftmq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xwnxmuftmq .gt_row_group_first td {
  border-top-width: 2px;
}

#xwnxmuftmq .gt_row_group_first th {
  border-top-width: 2px;
}

#xwnxmuftmq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwnxmuftmq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xwnxmuftmq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xwnxmuftmq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwnxmuftmq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwnxmuftmq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xwnxmuftmq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xwnxmuftmq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xwnxmuftmq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwnxmuftmq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwnxmuftmq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwnxmuftmq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwnxmuftmq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwnxmuftmq .gt_left {
  text-align: left;
}

#xwnxmuftmq .gt_center {
  text-align: center;
}

#xwnxmuftmq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xwnxmuftmq .gt_font_normal {
  font-weight: normal;
}

#xwnxmuftmq .gt_font_bold {
  font-weight: bold;
}

#xwnxmuftmq .gt_font_italic {
  font-style: italic;
}

#xwnxmuftmq .gt_super {
  font-size: 65%;
}

#xwnxmuftmq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xwnxmuftmq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xwnxmuftmq .gt_indent_1 {
  text-indent: 5px;
}

#xwnxmuftmq .gt_indent_2 {
  text-indent: 10px;
}

#xwnxmuftmq .gt_indent_3 {
  text-indent: 15px;
}

#xwnxmuftmq .gt_indent_4 {
  text-indent: 20px;
}

#xwnxmuftmq .gt_indent_5 {
  text-indent: 25px;
}

#xwnxmuftmq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xwnxmuftmq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal gt_bottom_border"><strong>Table 4. Final Multivariable Logistic Regression Model for Depression</strong></th>
</tr>
<tr class="gt_col_headings even">
<th id="Variables" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Variables</th>
<th id="B" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">B</th>
<th id="SE" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">SE</th>
<th id="Adj-OR-(95%-CI)" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Adj OR (95% CI)</th>
<th id="p-value" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">p-value</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variables" style="font-weight: bold">Years Working</td>
<td class="gt_row gt_left" headers="B">0.09</td>
<td class="gt_row gt_left" headers="SE">0.02</td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)">1.09 (1.05, 1.14)</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables" style="font-weight: bold">Physical Activity Score</td>
<td class="gt_row gt_left" headers="B">-0.30</td>
<td class="gt_row gt_left" headers="SE">0.09</td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)">0.74 (0.62, 0.87)</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables" style="font-weight: bold">Obesity Status</td>
<td class="gt_row gt_left" headers="B"></td>
<td class="gt_row gt_left" headers="SE"></td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)"></td>
<td class="gt_row gt_left" headers="p-value"></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables">Not Obese</td>
<td class="gt_row gt_left" headers="B">1</td>
<td class="gt_row gt_left" headers="SE"></td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)">1</td>
<td class="gt_row gt_left" headers="p-value"></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variables">Obese</td>
<td class="gt_row gt_left" headers="B">4.21</td>
<td class="gt_row gt_left" headers="SE">1.26</td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)">67.23 (7.46, 1176.33)</td>
<td class="gt_row gt_left" headers="p-value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variables" style="font-weight: bold">Physical Activity Score * Obesity Status</td>
<td class="gt_row gt_left" headers="B">-0.83</td>
<td class="gt_row gt_left" headers="SE">0.29</td>
<td class="gt_row gt_left" headers="Adj OR (95% CI)">0.44 (0.23, 0.72)</td>
<td class="gt_row gt_left" headers="p-value">0.004</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="5" class="gt_sourcenote">Constant = -1.93; No multicollinearity; Hosmer–Lemeshow test p-value = 0.004; Classification accuracy = 86.0%; AUC (ROC) = 85.9%; AIC = 171.84; Nagelkerke’s R² = 0.479; CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
</section>
<section id="final-model-equation" class="level2">
<h2 class="anchored" data-anchor-id="final-model-equation">7 FINAL MODEL EQUATION</h2>
<section id="odds-ratio" class="level3">
<h3 class="anchored" data-anchor-id="odds-ratio">7.1 Odds Ratio</h3>
<p><span class="math display">\[
\text{Odds}(\text{Depression}) = \frac{p}{1 - p}
= \exp\Big[
-1.87
+ 0.07 (\text{Years Working})
- 0.30 (\text{Physical Activity})
+ 2.07 (\text{Obese})
- 0.92 (\text{Physical Activity} \times \text{Obese})
\Big]
\]</span></p>
</section>
<section id="probability" class="level3">
<h3 class="anchored" data-anchor-id="probability">7.2 Probability</h3>
<p><span class="math display">\[
P(\text{Depression}=1)
=
\frac{1}
{1 + \exp\left[-\left(
-1.87
+ 0.07(\text{Years Working})
- 0.30(\text{Physical Activity})
+ 2.07(\text{Obese})
- 0.92(\text{Physical Activity} \times \text{Obese})
\right)\right]}
\]</span></p>
</section>
</section>
<section id="prediction-analysis" class="level2">
<h2 class="anchored" data-anchor-id="prediction-analysis">8 PREDICTION ANALYSIS</h2>
<section id="create-new-dataframe-for-prediction" class="level3">
<h3 class="anchored" data-anchor-id="create-new-dataframe-for-prediction">8.1 Create new dataframe for prediction</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a7c30f2b602dfe0eaaf1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a7c30f2b602dfe0eaaf1">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88"],[0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30],[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10],["not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>years_working<\/th>\n      <th>phys_activity<\/th>\n      <th>obesity<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"years_working","targets":1},{"name":"phys_activity","targets":2},{"name":"obesity","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="generate-predicted-odds" class="level3">
<h3 class="anchored" data-anchor-id="generate-predicted-odds">8.2 Generate predicted odds</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>predic_odds <span class="ot">&lt;-</span> <span class="fu">augment</span>(final.m,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> new_data,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type.predict =</span> <span class="st">'link'</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>predic_odds <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-88740a58c892cf7c3358" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-88740a58c892cf7c3358">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88"],[0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30],[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10],["not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese"],[-1.928614129521711,-1.027047290064653,-0.1254804506075957,0.7760863888494618,-2.232101261053822,-1.330534421596764,-0.4289675821397069,0.4725992573173506,-2.535588392585933,-1.634021553128876,-0.732454713671818,0.1691121257852395,-2.839075524118044,-1.937508684660987,-1.035941845203929,-0.1343750057468717,-3.142562655650155,-2.240995816193098,-1.33942897673604,-0.4378621372789828,-3.446049787182266,-2.544482947725209,-1.642916108268151,-0.7413492688110939,-3.749536918714377,-2.84797007925732,-1.946403239800263,-1.044836400343205,-4.053024050246488,-3.151457210789431,-2.249890371332374,-1.348323531875316,-4.3565111817786,-3.454944342321542,-2.553377502864485,-1.651810663407427,-4.659998313310711,-3.758431473853654,-2.856864634396596,-1.955297794939538,-4.963485444842823,-4.061918605385765,-3.160351765928707,-2.25878492647165,2.279480748838521,3.181047588295578,4.082614427752636,4.984181267209694,1.145488555243051,2.047055394700109,2.948622234157166,3.850189073614223,0.01149636164758117,0.9130632011046387,1.814630040561696,2.716196880018754,-1.122495831947889,-0.2209289924908311,0.6806378469662264,1.582204686423284,-2.256488025543358,-1.354921186086301,-0.4533543466292431,0.4482124928278144,-3.390480219138828,-2.488913379681771,-1.587346540224713,-0.6857797007676556,-4.524472412734298,-3.62290557327724,-2.721338733820183,-1.819771894363125,-5.658464606329767,-4.75689776687271,-3.855330927415653,-2.953764087958595,-6.792456799925238,-5.890889960468179,-4.989323121011122,-4.087756281554064,-7.926448993520706,-7.024882154063649,-6.123315314606591,-5.221748475149534,-9.060441187116178,-8.15887434765912,-7.257307508202063,-6.355740668745005]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>years_working<\/th>\n      <th>phys_activity<\/th>\n      <th>obesity<\/th>\n      <th>.fitted<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"years_working","targets":1},{"name":"phys_activity","targets":2},{"name":"obesity","targets":3},{"name":".fitted","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="generate-predicted-probability" class="level3">
<h3 class="anchored" data-anchor-id="generate-predicted-probability">8.3 Generate predicted probability</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>predic_prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(final.m,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> new_data,</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type.predict =</span> <span class="st">'response'</span>)</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>predic_prob <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-a40f89a55256bce19c27" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a40f89a55256bce19c27">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88"],[0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30,0,10,20,30],[0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10],["not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","not obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese","obese"],[0.1269040543805313,0.2636569488899084,0.4686709837415355,0.6848360288298497,0.09690459520712853,0.2090709793548332,0.3943728903486952,0.615998780939385,0.0734006559674578,0.1632801932916852,0.3246562887117365,0.5421775599688243,0.05524877220977521,0.1259218089504124,0.2619337762582272,0.4664567066506127,0.04138533255161472,0.09612898222769206,0.2076039788103616,0.3922504968772376,0.03088688175205741,0.07279800128463998,0.1620686577021534,0.3227091663118659,0.02298776810862568,0.05478634130035837,0.1249460781714967,0.2602178857711464,0.01707321038089717,0.04103389841849554,0.09535892166213572,0.2061445889743811,0.01266069825157155,0.03062175010374007,0.07219990913561281,0.1608643833828644,0.009377704531607963,0.02278884764745426,0.0543275583529781,0.1239768356597024,0.006940026642642666,0.01692458387673709,0.04068532191944869,0.09459438423545738,0.90716332581946,0.9601148021221533,0.9834163356019684,0.9932011603715917,0.7586859186562968,0.8856497444316082,0.9501983309717708,0.9791675126479003,0.5028740587574815,0.7136265792421648,0.8599205260223652,0.9379756465509803,0.2455486258770787,0.4449913161508897,0.6638810433669929,0.8295165287556616,0.09479128853699546,0.2050669826026565,0.3885635367021617,0.6102141541489511,0.03259430967573002,0.07663905722951736,0.1697575477058174,0.3349725564741344,0.01072417748305086,0.02601036439701923,0.06172588691426783,0.1394612460799913,0.003475745099370781,0.008519025803519983,0.0207278592880671,0.04955891146804969,0.001120950403381155,0.002756893817359179,0.006764206571839028,0.01650001582804388,0.0003609359660817631,0.0008886818761864583,0.002186388688509537,0.005368902102224609,0.0001161582175160814,0.0002861024795920597,0.0007045070190549319,0.001733737301414679]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>years_working<\/th>\n      <th>phys_activity<\/th>\n      <th>obesity<\/th>\n      <th>.fitted<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"years_working","targets":1},{"name":"phys_activity","targets":2},{"name":"obesity","targets":3},{"name":".fitted","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="final-model-result-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="final-model-result-interpretation">9 FINAL MODEL RESULT INTERPRETATION</h2>
<section id="main-effects" class="level3">
<h3 class="anchored" data-anchor-id="main-effects">9.1 Main Effects</h3>
<ol type="1">
<li><strong>Years of working</strong> (Adj OR = 1.09, 95% CI: 1.05,1.14, p&lt;0.05)</li>
</ol>
<ul>
<li>Years working was positively associated with depression after adjusting for other variables in the model. The adjusted odds ratio was 1.09 (95% CI: 1.05, 1.14), indicating that for each additional year of working, the odds of depression increased by 9%, holding other factors constant. The confidence interval is narrow, does not include 1, and suggests a precise estimate of effect. The association was statistically significant (p &lt; 0.05), providing strong evidence that longer duration of employment is independently associated with higher odds of depression.</li>
</ul>
<ol start="2" type="1">
<li><strong>Physical Activity Score</strong> (Adj OR = 0.74, 95% CI: 0.62,0.87, p&lt;0.05)</li>
</ol>
<ul>
<li>Physical activity score showed a negative association with depression. The adjusted odds ratio was 0.74 (95% CI: 0.62, 0.87), meaning that each one-unit increase in physical activity score was associated with a 26% reduction in the odds of depression, after controlling for other variables. The confidence interval is moderately narrow, does not include 1, and consistently lies below 1, supporting a protective effect. This association was statistically significant (p &lt; 0.05), indicating that higher physical activity levels are independently associated with lower odds of depression.</li>
</ul>
<ol start="3" type="1">
<li><strong>Obesity Status</strong> (Obese) (Adj OR = 67.23, 95% CI: 7.46, 1176.33, p &lt; 0.05)</li>
</ol>
<ul>
<li>Obesity status was positively associated with depression. Individuals classified as obese had a substantially higher odds of depression (Adj OR 67.23, 95% CI: 7.46, 1176.33), compared to those who were not obese, after adjusting for other variables. The confidence interval is wide, suggesting greater uncertainty and variability in the estimate, but importantly it does not include 1, indicating a true association. The association was statistically significant (p &lt; 0.05), supporting obesity as an independent risk factor for depression in this model.</li>
</ul>
</section>
<section id="interaction-effect" class="level3">
<h3 class="anchored" data-anchor-id="interaction-effect">9.2 Interaction Effect</h3>
<p><strong>Physical Activity Score × Obesity Status</strong> (Adj OR = 0.44, 95% CI: 0.23,0.72, p = 0.004)</p>
<ul>
<li><p>The interaction between physical activity score and obesity status showed a negative association with depression, with an adjusted odds ratio of 0.44 (95% CI: 0.23, 0.72). This indicates that obesity status significantly modifies the relationship between physical activity and depression, such that the protective effect of physical activity is stronger among obese individuals compared with non-obese individuals. The confidence interval is moderately wide but does not include 1, confirming the presence of a meaningful interaction effect. This interaction was statistically significant (p = 0.004), providing evidence of effect modification.</p></li>
<li><p>When this interaction was taken into account, the combined effect of physical activity among obese individuals was substantially stronger. Specifically, each one-unit increase in physical activity score was associated with an approximate 67% reduction in the odds of depression (combined adjusted OR = 0.74 x 0.44 = 0.33), indicating that increased physical activity confers a markedly greater protective effect against depression in obese individuals than in their non-obese counterparts.</p></li>
</ul>
</section>
<section id="comparison-models-with-and-without-interactions" class="level3">
<h3 class="anchored" data-anchor-id="comparison-models-with-and-without-interactions">9.3 Comparison models with and without interactions</h3>
<ul>
<li><p>The model without interaction included years working, physical activity score, and obesity status as main effects only. In contrast, the interaction model additionally incorporated the interaction term between physical activity score and obesity status to assess whether the effect of physical activity on depression differed by obesity status.</p></li>
<li><p>Based on the likelihood ratio test (Analysis of Deviance), adding the interaction term resulted in a statistically significant improvement in model fit. The residual deviance decreased from 174.60 in the model without interaction to 161.84 in the model with interaction, corresponding to a deviance reduction of 12.76 with 1 additional degree of freedom. This reduction was statistically significant (χ² = 12.76, p = 0.0004), indicating that the interaction term explains a significant proportion of variation in depression beyond the main effects alone.</p></li>
<li><p>The residual degrees of freedom decreased from 196 to 195, reflecting the inclusion of one additional parameter in the interaction model. Importantly, the substantial reduction in deviance relative to the small loss of degrees of freedom suggests that the interaction model provides a better balance between model complexity and explanatory power.</p></li>
<li><p>From a substantive perspective, the non-interaction model assumes that the association between physical activity and depression is the same for obese and non-obese individuals. However, the statistically significant interaction term in the expanded model demonstrates that this assumption does not hold. Instead, the effect of physical activity on depression differs by obesity status, with physical activity having a significantly stronger protective effect among obese individuals. Therefore, failing to include the interaction would mask this important effect modification and potentially lead to an oversimplified interpretation of the relationship between physical activity and depression.</p></li>
</ul>
</section>
<section id="practical-significance-of-the-findings" class="level3">
<h3 class="anchored" data-anchor-id="practical-significance-of-the-findings">9.4 Practical Significance of the Findings</h3>
<ol type="1">
<li><strong>Accumulated Work Exposure has a Meaningful Impact on Mental Health</strong></li>
</ol>
<ul>
<li>Although the adjusted odds ratio for years working appears modest (Adj OR = 1.09), the effect is practically important because it accumulates over time. A 9% increase in odds per year translates into a substantially higher risk over longer employment durations. For example, an individual with 10 additional years of working experience would have markedly higher odds of depression compared to a newly employed individual. This highlights the need for long-term mental health monitoring, stress management, and supportive workplace policies, particularly for mid-career and senior employees.</li>
</ul>
<ol start="2" type="1">
<li><strong>Physical Activity is a Strong and Modifiable Protective Factor</strong></li>
</ol>
<ul>
<li>The physical activity score demonstrated a clinically meaningful protective effect against depression (Adj OR = 0.74). A 26% reduction in odds per unit increase suggests that even small, achievable improvements in physical activity can yield substantial mental health benefits. From a practical standpoint, this supports workplace and community interventions such as scheduled activity breaks, walking programs, and structured exercise initiatives as cost-effective and scalable strategies to reduce depression risk.</li>
</ul>
<ol start="3" type="1">
<li><strong>Obesity Represents a High-Risk Group for Depression</strong></li>
</ol>
<ul>
<li>The large adjusted odds ratio observed for obesity (Adj OR = 67.23) indicates that obese individuals face substantially higher odds of depression compared with non-obese individuals. Despite the wide confidence interval, the magnitude of the association is practically important and identifies obesity as a priority risk group for mental health screening and early intervention. In practice, this finding supports integrated approaches that combine mental health services with weight management and lifestyle programmes.</li>
</ul>
<ol start="4" type="1">
<li><strong>Physical Activity Is Especially Beneficial Among Obese Individuals</strong></li>
</ol>
<ul>
<li>The statistically significant interaction between physical activity and obesity demonstrates that the mental health benefits of physical activity are not uniform across groups. Among obese individuals, the combined effect of physical activity resulted in an approximate 67% reduction in the odds of depression, indicating a substantially stronger protective effect than in non-obese individuals. Practically, this suggests that targeting physical activity interventions toward obese populations may yield disproportionately greater mental health gains and represents an efficient use of limited public health resources.</li>
</ul>
</section>
<section id="addressing-any-violations-of-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="addressing-any-violations-of-assumptions">9.5 Addressing any violations of assumptions</h3>
<p>Taken together, the diagnostic assessments indicate that no major violations of logistic regression assumptions remained in the final model. Initial model checking suggested that a model without interaction may have been overly simplistic, as it assumed that the effect of physical activity on depression was constant across obesity status. This issue was addressed by including the physical activity × obesity interaction, which significantly improved model fit, reduced residual deviance, and corrected the model specification. The inclusion of this interaction therefore ensured that the model more accurately reflected the underlying relationship between predictors and the outcome.</p>
<p>Furthermore, assessment of the linearity of continuous predictors with the logit indicated that both years working and physical activity score were appropriately modeled as linear terms. There was no evidence of substantial departures from linearity that would compromise the validity of the estimated odds ratios. This supports the interpretability and stability of the regression coefficients.</p>
<p>The assumption of independence of observations was satisfied based on the study design, as each observation represented a unique individual with no clustering or repeated measurements. In addition, checks for multicollinearity showed no problematic correlations among predictors, suggesting that coefficient estimates were not inflated or unstable due to redundancy between variables.</p>
<p>Although the Hosmer–Lemeshow test was statistically significant (p = 0.004), this test is sensitive to sample size and minor deviations in calibration may result in significant findings. Despite this, the model demonstrated excellent discrimination (AUC = 85.9%) and high classification accuracy (86%), supporting its overall adequacy for prediction and inference. Examination of influential observations demonstrated that although some observations exerted higher influence, their removal did not materially alter the regression estimates or conclusions, indicating robustness of the model.</p>
<p>These diagnostic findings provide confidence that the final multivariable logistic regression model is well-specified, statistically sound, and robust, and that the reported associations between years working, physical activity, obesity status, and depression are reliable and suitable for interpretation and inference.</p>
</section>
<section id="discussion-on-influential-points-and-their-impact-on-the-results" class="level3">
<h3 class="anchored" data-anchor-id="discussion-on-influential-points-and-their-impact-on-the-results">9.6 Discussion on influential points and their impact on the results</h3>
<p>Influential observations were examined to assess whether individual data points exerted undue influence on the estimated regression coefficients and overall conclusions of the logistic regression model. This assessment was conducted using Cook’s distance and DFBETAS, which evaluate the impact of each observation on the fitted model parameters.</p>
<p>For Cook’s distance, the commonly used cut-off of 4/n was applied, where n represents the sample size. With approximately 200 observations, the cut-off value was therefore around 0.02. The majority of observations had Cook’s distance values well below this threshold, indicating minimal influence on the model estimates. A small number of observations exceeded or approached this cut-off, suggesting potential influence; however, none demonstrated extremely large values that would indicate undue dominance of the model.</p>
<p>DFBETAS were also assessed using the conventional cut-off of |DFBETAS| &gt; 2/√n, corresponding to approximately 0.14 for this sample size. Only a limited number of observations exceeded this threshold for specific coefficients, particularly for obesity status and the physical activity × obesity interaction term. This indicates that while some observations had noticeable influence on certain parameters, their effect was not excessive.</p>
<p>To evaluate the practical impact of these influential points, sensitivity analyses were performed by refitting the model after excluding the identified observations. The comparison between the full model and the reduced model showed that the direction, magnitude, and statistical significance of the regression coefficients remained largely unchanged. Importantly, the physical activity × obesity interaction remained statistically significant, and its estimated effect size was stable, indicating that the observed effect modification was not driven by a small number of influential cases.</p>
<p>Therefore, despite the presence of a small number of moderately influential observations, their impact on the overall model conclusions was minimal. The stability of estimates following sensitivity analyses supports the robustness of the interaction effect. Combined with the significant improvement in model fit observed when the interaction term was included, these findings justify the retention of the model with interaction as the final model. The interaction model provides a more accurate and reliable representation of the relationship between physical activity, obesity status, and depression, without being unduly influenced by extreme or atypical observations.</p>
</section>
</section>
<section id="github-repository" class="level1">
<h1>GITHUB REPOSITORY #</h1>
<p>Github Repository The completed code and data for this analysis are available at: https://github.com/fizasaharudin-ux/regression-analysis-assignment.git]</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"https://github.com/fizasaharudin-ux/regression-analysis-assignment.git"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>https://github.com/fizasaharudin-ux/regression-analysis-assignment.git</code></pre>
</div>
</div>
<p>REFERENCES</p>
<ol type="1">
<li><p>Musa, K.I. &amp; Wan Mansor, W.N.A.W., 2021. Exploring data using R. Penang: Penerbit Universiti Sains Malaysia.</p></li>
<li><p>Hosmer Jr., D.W., Lemeshow, S. and Sturdivant, R.X. (2013) Applied Logistic Regression. 3rd Edition, John Wiley &amp; Sons, Hoboken, NJ. https://doi.org/10.1002/9781118548387</p></li>
<li><p>Ho, N.T., 2019. Bio-medical data analysis with R. Boca Raton, FL: CRC Press.</p></li>
</ol>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Logistic Regression Analysis of Depression"</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co">- Nur Fazlina binti Dzulkifli (23202967) </span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">- Yogeswary Mithra A/P Nandi Mithra (23202677)</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">- Siti Nurhafizah binti Saharudin (23202464) </span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">- Muammar Iskandar bin Muhamaed Yusoff (23202846)</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Logistic Regression, Medical Statistics]</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> [R, Logistic Regression, Medical Statistics]</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: flatly</span></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-expand: 1</span></span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true     </span></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show code" </span></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="co">    css: styles.css</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: NA</span></span>
<span id="cb116-27"><a href="#cb116-27" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-28"><a href="#cb116-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. INTRODUCTION</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a>This analysis aims to determine the factors associated with depression using multiple logistic regression. The outcome variable is binary (depressed vs not depressed). Three covariates are considered:</span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>years of working (numerical)</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-35"><a href="#cb116-35" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>physical activity score (numerical)</span>
<span id="cb116-36"><a href="#cb116-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>obesity status (categorical)</span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1 Data Generation</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a>A dataset with 200 observations were generated, containing the following variables:</span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Outcome variable: depression (binary: "depressed" or "not depressed")</span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Covariates:</span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>years_working (Years of working, continuous, range 0-40 years)</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>phys_activity (Physical activity score, continuous, range 0-10)</span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>obesity (binary: "obese" or "not obese")</span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a>An interaction between physical activity and obesity is also evaluated to determine whether the effect of physical activity on depression differs by obesity status.</span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-57"><a href="#cb116-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-58"><a href="#cb116-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Packages</span></span>
<span id="cb116-59"><a href="#cb116-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb116-65"><a href="#cb116-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-66"><a href="#cb116-66" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3030</span>)</span>
<span id="cb116-67"><a href="#cb116-67" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb116-68"><a href="#cb116-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Generate covariates</span></span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a>years_working <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">40</span>), <span class="dv">1</span>)</span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a>phys_activity <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">10</span>), <span class="dv">1</span>)</span>
<span id="cb116-72"><a href="#cb116-72" aria-hidden="true" tabindex="-1"></a>phys_c <span class="ot">&lt;-</span> phys_activity <span class="sc">-</span> <span class="fu">mean</span>(phys_activity)  <span class="co"># centered for simulation</span></span>
<span id="cb116-73"><a href="#cb116-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Obesity (binary)</span></span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a>obesity_bin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="fl">0.30</span>)</span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Set simulation coefficients (moderate ORs, significant effects)</span></span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep ORs &lt; 10 and encourage a significant interaction</span></span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fl">0.08</span>    <span class="co"># years_working (OR ~ 1.08 per year)</span></span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.30</span>   <span class="co"># phys_activity (OR ~ 0.74 per 1-point increase)</span></span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="fl">0.40</span>    <span class="co"># obesity main effect (OR ~ 1.49)</span></span>
<span id="cb116-82"><a href="#cb116-82" aria-hidden="true" tabindex="-1"></a>b4 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.60</span>   <span class="co"># interaction (strong enough for significance)</span></span>
<span id="cb116-83"><a href="#cb116-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept calibrated for ~25% prevalence</span></span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a>mean_prev <span class="ot">&lt;-</span> <span class="cf">function</span>(b0){</span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a>  lp <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity_bin <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity_bin</span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">plogis</span>(lp))</span>
<span id="cb116-88"><a href="#cb116-88" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-89"><a href="#cb116-89" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(<span class="cf">function</span>(x) <span class="fu">mean_prev</span>(x) <span class="sc">-</span> <span class="fl">0.25</span>, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">2</span>))<span class="sc">$</span>root</span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-91"><a href="#cb116-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear predictor and probabilities</span></span>
<span id="cb116-92"><a href="#cb116-92" aria-hidden="true" tabindex="-1"></a>linpred <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1<span class="sc">*</span>years_working <span class="sc">+</span> b2<span class="sc">*</span>phys_c <span class="sc">+</span> b3<span class="sc">*</span>obesity_bin <span class="sc">+</span> b4<span class="sc">*</span>phys_c<span class="sc">*</span>obesity_bin</span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(linpred)</span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, <span class="fl">0.05</span>), <span class="fl">0.95</span>)  <span class="co"># clamp to avoid separation</span></span>
<span id="cb116-95"><a href="#cb116-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-96"><a href="#cb116-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome</span></span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p)</span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Add a few influential points but keep model stable</span></span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a>years_working[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">39</span>, <span class="dv">38</span>)</span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a>phys_activity[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>)</span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a>obesity_bin[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Build final dataset with required labels</span></span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> years_working,</span>
<span id="cb116-108"><a href="#cb116-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> phys_activity,</span>
<span id="cb116-109"><a href="#cb116-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">factor</span>(obesity_bin, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>,<span class="st">"obese"</span>)),</span>
<span id="cb116-110"><a href="#cb116-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">depression =</span> <span class="fu">factor</span>(y, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"not depressed"</span>,<span class="st">"depressed"</span>))</span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mydata)</span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.2 Prepare the environment</span></span>
<span id="cb116-117"><a href="#cb116-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-118"><a href="#cb116-118" aria-hidden="true" tabindex="-1"></a>Load the required libraries.</span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-122"><a href="#cb116-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-128"><a href="#cb116-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-134"><a href="#cb116-134" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.3 Read the data</span></span>
<span id="cb116-135"><a href="#cb116-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a>Read the data into R and quickly view the data.</span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mydata)</span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-144"><a href="#cb116-144" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.4 Levels for variables</span></span>
<span id="cb116-145"><a href="#cb116-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-146"><a href="#cb116-146" aria-hidden="true" tabindex="-1"></a>To ensure we are comparing the outcome for depressed against not depressed.</span>
<span id="cb116-147"><a href="#cb116-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-151"><a href="#cb116-151" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(mydata<span class="sc">$</span>depression)</span>
<span id="cb116-152"><a href="#cb116-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a>To ensure we are comparing the factor obese against not obese.</span>
<span id="cb116-155"><a href="#cb116-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-159"><a href="#cb116-159" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(mydata<span class="sc">$</span>obesity)</span>
<span id="cb116-160"><a href="#cb116-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. EXPLORATORY DATA ANALYSIS</span></span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-164"><a href="#cb116-164" aria-hidden="true" tabindex="-1"></a>The following analysis were conducted:</span>
<span id="cb116-165"><a href="#cb116-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-166"><a href="#cb116-166" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Summary statistics</span></span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Mean, SD, median, IQR for continuous variables</span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Frequencies and proportions for categorical variables</span>
<span id="cb116-170"><a href="#cb116-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-177"><a href="#cb116-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(depression, years_working, phys_activity, obesity) <span class="sc">%&gt;%</span> </span>
<span id="cb116-178"><a href="#cb116-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_summary</span>(<span class="at">by =</span> depression,</span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">statistic =</span> <span class="fu">list</span>(</span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd}) | Median: {median} [{p25}, {p75}]"</span>,</span>
<span id="cb116-181"><a href="#cb116-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">all_categorical</span>() <span class="sc">~</span> <span class="st">"{n} ({p}%)"</span>))</span>
<span id="cb116-182"><a href="#cb116-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-183"><a href="#cb116-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Among 200 participants, 60 (30%) were classified as depressed. Individuals with depression had a longer duration of working years (median: 32 years) compared to those without depression (median: 19 years). They also reported substantially lower physical activity levels (median score: 2.60) compared to non-depressed individuals (median score: 5.75). With regard to obesity, a higher proportion of depressed participant were obese (42%) compared to those without depression (25%) indicating a greater prevalence of obesity among individuals with depression.</span>
<span id="cb116-187"><a href="#cb116-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-188"><a href="#cb116-188" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 Create visualisations</span></span>
<span id="cb116-189"><a href="#cb116-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.2.1 Histograms for continuous variables</span></span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a>**Years of working**</span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(years_working)) <span class="sc">+</span></span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"pink"</span>) <span class="sc">+</span> </span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span></span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-202"><a href="#cb116-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb116-203"><a href="#cb116-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of years of working"</span></span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-206"><a href="#cb116-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-207"><a href="#cb116-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-208"><a href="#cb116-208" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The distribution shows that individuals with depression are more concentrated in the longer duration of years of working (approximately 25–40 years), whereas those not depressed are more evenly distributed across all working durations. This suggests that longer years of working are more common among depressed individuals. Overall, the pattern indicates a positive association between years of working and depression.</span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a>**Physical activity score**</span>
<span id="cb116-213"><a href="#cb116-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(phys_activity)) <span class="sc">+</span></span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span></span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of physical activity score"</span></span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-230"><a href="#cb116-230" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Individuals without depression tend to have higher physical activity scores, with the distribution concentrated in the moderate to high range. In contrast, the depressed group shows a clustering at lower physical activity scores, with fewer individuals reporting high activity levels. This pattern suggests an inverse association between physical activity and depression, where lower physical activity is more common among depressed individuals.</span>
<span id="cb116-231"><a href="#cb116-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.2.2 Box plots of continuous variables by categorical variables</span></span>
<span id="cb116-233"><a href="#cb116-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-234"><a href="#cb116-234" aria-hidden="true" tabindex="-1"></a>**Years of working by obesity status**</span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-239"><a href="#cb116-239" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-240"><a href="#cb116-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> years_working)) <span class="sc">+</span></span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span> ( <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Years of working"</span>, </span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Years of working by obesity status"</span></span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-249"><a href="#cb116-249" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-250"><a href="#cb116-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-251"><a href="#cb116-251" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The median years of working is higher among obese individuals compared with those who are not obese. Obese participants also tend to cluster in the mid-to-higher range of working years, while the not-obese group shows a wider spread with more individuals at lower years of working. This indicates that obesity is more common among individuals with longer working duration in this sample.</span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a>**Physical activity by obesity status**</span>
<span id="cb116-254"><a href="#cb116-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> obesity, <span class="at">y =</span> phys_activity)) <span class="sc">+</span></span>
<span id="cb116-260"><a href="#cb116-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">fill =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb116-261"><a href="#cb116-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Physical activity score by obesity status"</span></span>
<span id="cb116-265"><a href="#cb116-265" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-266"><a href="#cb116-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The median physical activity score is slightly lower among obese individuals compared with those who are not obese. While the interquartile ranges overlap substantially, non-obese participants tend to show a somewhat higher upper range of physical activity scores. Overall, this suggests that obese individuals in this sample are generally less physically active, although the difference is modest.</span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.2.3 Scatter plots between continuous variables</span></span>
<span id="cb116-273"><a href="#cb116-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-274"><a href="#cb116-274" aria-hidden="true" tabindex="-1"></a>**Years of working and physical activity**</span>
<span id="cb116-275"><a href="#cb116-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> years_working, <span class="at">y =</span> phys_activity))<span class="sc">+</span></span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Years of working"</span>,</span>
<span id="cb116-284"><a href="#cb116-284" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb116-285"><a href="#cb116-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between years of working and physical activity"</span></span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-290"><a href="#cb116-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-291"><a href="#cb116-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The points are widely scattered across the plot with no clear linear or non-linear trend. Physical activity varies substantially at all levels of years working, both high and low physical activity scores occur across short and long working duration. There is no strong association between years of working and physical activity.</span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.2.4 Bar plot for categorical variable</span></span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a>**Obesity**</span>
<span id="cb116-296"><a href="#cb116-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-299"><a href="#cb116-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a>mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(obesity)) <span class="sc">+</span></span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"orange"</span>) <span class="sc">+</span> </span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>depression) <span class="sc">+</span> </span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Obesity"</span>,</span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">" Distribution of obesity by depression status"</span></span>
<span id="cb116-308"><a href="#cb116-308" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-309"><a href="#cb116-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The distribution of obesity differed modestly by depression status. In both depressed and non-depressed groups, the majority of participants were classified as not obese. However, the difference between not obese and obese participants was less pronounced in the depressed group compared to the non-depressed group, indicating a relatively higher representation of obesity among participants with depression. Overall, the figure suggests a shift toward a greater proportion of obesity in the depressed group, while not-obese individuals remained the majority in both groups.</span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3 Correlation matrices for continous variables</span></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-319"><a href="#cb116-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-320"><a href="#cb116-320" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mydata<span class="sc">$</span>years_working, mydata<span class="sc">$</span>phys_activity, <span class="at">use =</span> <span class="st">'complete.obs'</span>)</span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a>corr.num <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span> </span>
<span id="cb116-327"><a href="#cb116-327" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(years_working, phys_activity) <span class="sc">%&gt;%</span> </span>
<span id="cb116-328"><a href="#cb116-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">'complete.obs'</span>)</span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a>corr.num</span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-335"><a href="#cb116-335" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb116-336"><a href="#cb116-336" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corr.num, <span class="at">type =</span> <span class="st">'upper'</span>, <span class="at">order =</span> <span class="st">'hclust'</span>)</span>
<span id="cb116-337"><a href="#cb116-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-338"><a href="#cb116-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-341"><a href="#cb116-341" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A correlation of −0.04 is extremely close to 0. Value close to 0 mean almost no linear association.</span>
<span id="cb116-342"><a href="#cb116-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As years of working increases, physical activity score does not show a meaningful tendency to increase or decrease.A correlation of −0.04 between years of working and physical activity score is essentially no linear relationship.</span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This very small correlation suggests no multicollinearity problem between these two predictors, so it is fine to include both years of working and physical activity score in the same logistic regression model.</span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-347"><a href="#cb116-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. LOGISTIC REGRESSION ANALYSIS</span></span>
<span id="cb116-348"><a href="#cb116-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Simple Logistic Regression</span></span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-351"><a href="#cb116-351" aria-hidden="true" tabindex="-1"></a>**Years of working**</span>
<span id="cb116-352"><a href="#cb116-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a>slr.years <span class="ot">&lt;-</span> </span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working, <span class="at">data =</span> mydata,</span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.years)</span>
<span id="cb116-361"><a href="#cb116-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-362"><a href="#cb116-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Each additional year of working is significantly associated with an increase of about 0.07 in the log odds of being depressed, not adjusted by other variables (p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a>**Physical activity**</span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-372"><a href="#cb116-372" aria-hidden="true" tabindex="-1"></a>slr.phys <span class="ot">&lt;-</span></span>
<span id="cb116-373"><a href="#cb116-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> phys_activity, <span class="at">data =</span> mydata,</span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-376"><a href="#cb116-376" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.phys)</span>
<span id="cb116-377"><a href="#cb116-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-380"><a href="#cb116-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-381"><a href="#cb116-381" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For every 1-unit increase in physical activity score, the log odds of being depressed decrease by 0.38, not adjusted by other variables (p value <span class="sc">\&lt;</span> 0.05)</span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a>**Obesity**</span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-387"><a href="#cb116-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-388"><a href="#cb116-388" aria-hidden="true" tabindex="-1"></a>slr.obese <span class="ot">&lt;-</span></span>
<span id="cb116-389"><a href="#cb116-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> obesity, <span class="at">data =</span> mydata,</span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(slr.obese)</span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-396"><a href="#cb116-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-397"><a href="#cb116-397" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There is a statistically significant association between obesity and depression (p = 0.0196). Individuals who are obese have 0.76 higher log odds of being depressed compared with those who are not obese. This result suggests that obesity is a significant risk factor for depression in the unadjusted (crude).</span>
<span id="cb116-398"><a href="#cb116-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-399"><a href="#cb116-399" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2 Multiple Logistic Regression</span></span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a>In simple logistic regression analyses, physical activity, years of working and obesity were each significantly associated with depression. All three variables will be included in the multivariable logistic regression model based on statistical significance in the univariable analysis and their established clinical and public health relevance.</span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.2.1 **Model without interaction**</span></span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-407"><a href="#cb116-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-408"><a href="#cb116-408" aria-hidden="true" tabindex="-1"></a>model1_mlr <span class="ot">&lt;-</span></span>
<span id="cb116-409"><a href="#cb116-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity, </span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata,</span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1_mlr)</span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-416"><a href="#cb116-416" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the coefficient to an odds ratio</span>
<span id="cb116-417"><a href="#cb116-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-420"><a href="#cb116-420" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-421"><a href="#cb116-421" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model1_mlr, </span>
<span id="cb116-422"><a href="#cb116-422" aria-hidden="true" tabindex="-1"></a>     <span class="at">exponentiate =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-423"><a href="#cb116-423" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-425"><a href="#cb116-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-426"><a href="#cb116-426" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a>1)  **Years of working**</span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>After adjusting for physical activity and obesity, each additional year of working was significantly associated with increase 1.09 in the odds of depression (AdjOR: 1.09, 95% CI: 1.05,1.13, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-432"><a href="#cb116-432" aria-hidden="true" tabindex="-1"></a>2)  **Physical activity**</span>
<span id="cb116-433"><a href="#cb116-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>After adjusting for years of working and obesity, each one-unit increase in physical activity score was significantly associated with a 36% reduction in the odds of depression (AdjOR: 0.64, 95% CI: 0.54,0.75, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a>3)  **Obesity**</span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>After adjusting for years of working and physical activity, obesity significantly associated with depression, with a 2.28 in the odds of depression (AdjOR = 2.28, 95% CI:1.05,5.04, p <span class="sc">\&lt;</span> 0.05)</span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-440"><a href="#cb116-440" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3.2.2 **Model with interaction**</span></span>
<span id="cb116-441"><a href="#cb116-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a>model2_mlr <span class="ot">&lt;-</span> </span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity, </span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata,</span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2_mlr)</span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the coefficient to an odds ratio</span>
<span id="cb116-454"><a href="#cb116-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model2_mlr, </span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a>     <span class="at">exp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-462"><a href="#cb116-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-463"><a href="#cb116-463" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-464"><a href="#cb116-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a>1)  **Years of working**</span>
<span id="cb116-466"><a href="#cb116-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-467"><a href="#cb116-467" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>After adjusting for physical activity, obesity, and their interaction, each additional year of working was significantly associated with a 1.09 increase in the odds of depression (AdjOR: 1.09, 95% CI: 1.05,1.14, p value <span class="sc">\&lt;</span> 0.05)</span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a>2)  **Physical activity**</span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Among non-obese individuals, each one-unit increase in physical activity score was significantly associated with a 26% reduction in the odds of depression, after adjustment of other covariates (AdjOR: 0.74, 95% CI: 0.62,0.87, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-472"><a href="#cb116-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-473"><a href="#cb116-473" aria-hidden="true" tabindex="-1"></a>3)  **Obesity**</span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Among individuals with no physical activity, obese individuals had nearly 67.23 times higher odds of depression compared with non-obese individuals after adjustment of other covariates (AdjOR: 67.23, 95% CI: 7.46,1176.33, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a>4)  **Interaction term ( phys_activity : obesity)**</span>
<span id="cb116-478"><a href="#cb116-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-479"><a href="#cb116-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For obese individuals, each unit increase in physical activity further reduces the odds of depression by 56%, beyond the effect seen in non-obese individuals, after adjustment of other covariates (AdjOR: 0.44, 95% CI: 0.23,0.72, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Among non-obese individuals, each one-unit increase in physical activity score was significantly associated with a 26% reduction in the odds of depression, after adjustment of other covariates (AdjOR: 0.74, 95% CI: 0.62,0.87, p value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-483"><a href="#cb116-483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The association between physical activity and depression differs by obesity status. The protective effect of physical activity against depression is stronger among obese individuals than among non-obese individuals. Among obese individuals, each one-unit increase in physical activity was associated with a 67% reduction (AdjOR 0.74 X 0.44 = 0.33) in the odds of depression, indicating a stronger protective effect of physical activity in this group.</span>
<span id="cb116-484"><a href="#cb116-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3 Comparing models</span></span>
<span id="cb116-486"><a href="#cb116-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-489"><a href="#cb116-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1_mlr, model2_mlr, <span class="at">test =</span> <span class="st">"Chisq"</span>)</span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a>A likelihood ratio test comparing the model with and without the physical activity and obesity interaction showed that adding the interaction significantly improved model fit (ΔDeviance = 12.376, df = 1, p <span class="sc">\&lt;</span> 0.05) ,indicating the effect of physical activity on depression depends on obesity status. Therefore, the final model should retained this interaction term of physical activity and obesity.</span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-497"><a href="#cb116-497" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. MODEL CHECKING</span></span>
<span id="cb116-498"><a href="#cb116-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.1 Checking the assumptions</span></span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a>The pre-liminary final model consists of:</span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Years of working</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity</span>
<span id="cb116-505"><a href="#cb116-505" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Obesity</span>
<span id="cb116-506"><a href="#cb116-506" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity : Obesity</span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> model2_mlr</span>
<span id="cb116-512"><a href="#cb116-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-513"><a href="#cb116-513" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.m)</span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a>Convert the coefficient into odd ratio</span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(final.m, </span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a>     <span class="at">exp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a>The assumptions of the model checked by:</span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Linearity in the logit</span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independence</span>
<span id="cb116-530"><a href="#cb116-530" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Absence of multicollinearity</span>
<span id="cb116-531"><a href="#cb116-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.1.1 Linearity in the logit (continuous variables)</span></span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 4.1.1.1 Using mfp</span></span>
<span id="cb116-535"><a href="#cb116-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mfp)</span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a>mfp_model <span class="ot">&lt;-</span></span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mfp</span>(depression <span class="sc">~</span> <span class="fu">fp</span>(years_working) <span class="sc">+</span> <span class="fu">fp</span>(phys_activity),</span>
<span id="cb116-543"><a href="#cb116-543" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb116-544"><a href="#cb116-544" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> mydata, <span class="at">verbose =</span> T)</span>
<span id="cb116-545"><a href="#cb116-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mfp_model)</span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-549"><a href="#cb116-549" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-550"><a href="#cb116-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a>Linearity in the logit was assessed for continuous covariates by fitting models in which physical activity and years of working were entered as first-order (power = 1) terms. Both linear terms were statistically significant and retained at power = 1, indicating that the log odds of depression change linearly with these variables and that no higher-order transformation was required.</span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.1.2 Independence</span></span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a>Independence of observations was assessed based on the study design and data structure. Each observation represented a unique individual, with no repeated measurements or clustering within higher-level units. Therefore, the assumption of independence of observations was considered to be satisfied</span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb116-561"><a href="#cb116-561" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb116-562"><a href="#cb116-562" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata, <span class="at">family =</span> binomial</span>
<span id="cb116-563"><a href="#cb116-563" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-564"><a href="#cb116-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a>resid_dev <span class="ot">&lt;-</span> <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>)</span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid_dev, <span class="at">type =</span> <span class="st">"p"</span>,</span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation index"</span>,</span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Deviance residual"</span>,</span>
<span id="cb116-570"><a href="#cb116-570" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Residuals vs observation index"</span>)</span>
<span id="cb116-571"><a href="#cb116-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-573"><a href="#cb116-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-574"><a href="#cb116-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a>Deviance residuals plotted against observation index showed a random scatter around zero, with no systematic pattern or trend. This suggests that the assumption of independence was satisfied and that the logistic regression model was adequately specified.</span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.1.3 Absence of multicollinearity</span></span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Preliminary final model</span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-587"><a href="#cb116-587" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> </span>
<span id="cb116-588"><a href="#cb116-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final.m)</span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-596"><a href="#cb116-596" aria-hidden="true" tabindex="-1"></a><span class="fu">##### 4.1.3.1 Using Variance Infaltion Factor (VIF)</span></span>
<span id="cb116-597"><a href="#cb116-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-598"><a href="#cb116-598" aria-hidden="true" tabindex="-1"></a>Multicollinearity was assessed using variance inflation factors (VIFs) from the main-effects model. VIF should be assessed on the model without interaction to avoid artificial inflation.</span>
<span id="cb116-599"><a href="#cb116-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-602"><a href="#cb116-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-603"><a href="#cb116-603" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb116-604"><a href="#cb116-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-605"><a href="#cb116-605" aria-hidden="true" tabindex="-1"></a><span class="co"># model without interaction</span></span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(model1_mlr)   </span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a>vif_values</span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert VIF output into a table</span></span>
<span id="cb116-611"><a href="#cb116-611" aria-hidden="true" tabindex="-1"></a>vif_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb116-612"><a href="#cb116-612" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">names</span>(vif_values),</span>
<span id="cb116-613"><a href="#cb116-613" aria-hidden="true" tabindex="-1"></a>  <span class="at">VIF =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(vif_values), <span class="dv">2</span>), </span>
<span id="cb116-614"><a href="#cb116-614" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tolerance =</span> <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span>vif_values, <span class="dv">2</span>),</span>
<span id="cb116-615"><a href="#cb116-615" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-616"><a href="#cb116-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-617"><a href="#cb116-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Display as a proper table</span></span>
<span id="cb116-618"><a href="#cb116-618" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb116-619"><a href="#cb116-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-620"><a href="#cb116-620" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(</span>
<span id="cb116-621"><a href="#cb116-621" aria-hidden="true" tabindex="-1"></a>  vif_table,</span>
<span id="cb116-622"><a href="#cb116-622" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="st">"lcc"</span>,</span>
<span id="cb116-623"><a href="#cb116-623" aria-hidden="true" tabindex="-1"></a>  <span class="at">caption =</span> <span class="st">"Variance Inflation Factors (VIF) for main-effects logistic regression model"</span></span>
<span id="cb116-624"><a href="#cb116-624" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-625"><a href="#cb116-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-626"><a href="#cb116-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-627"><a href="#cb116-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-628"><a href="#cb116-628" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-629"><a href="#cb116-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-630"><a href="#cb116-630" aria-hidden="true" tabindex="-1"></a>Variance inflation factors for all predictors were below 10, indicating no concerning multicollinearity in the preliminary final logistic regression model.</span>
<span id="cb116-631"><a href="#cb116-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-632"><a href="#cb116-632" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2 Influential analysis</span></span>
<span id="cb116-633"><a href="#cb116-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-634"><a href="#cb116-634" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.1 Diagnostic plot (screening)</span></span>
<span id="cb116-635"><a href="#cb116-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-638"><a href="#cb116-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-639"><a href="#cb116-639" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb116-640"><a href="#cb116-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-641"><a href="#cb116-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Fitted</span></span>
<span id="cb116-642"><a href="#cb116-642" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb116-643"><a href="#cb116-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(final.m),</span>
<span id="cb116-644"><a href="#cb116-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb116-645"><a href="#cb116-645" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Fitted values (predicted probability)"</span>,</span>
<span id="cb116-646"><a href="#cb116-646" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Deviance residuals"</span>,</span>
<span id="cb116-647"><a href="#cb116-647" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Residuals vs Fitted"</span></span>
<span id="cb116-648"><a href="#cb116-648" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-649"><a href="#cb116-649" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-650"><a href="#cb116-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-651"><a href="#cb116-651" aria-hidden="true" tabindex="-1"></a><span class="co"># Q–Q Residuals</span></span>
<span id="cb116-652"><a href="#cb116-652" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(</span>
<span id="cb116-653"><a href="#cb116-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb116-654"><a href="#cb116-654" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Q–Q Plot of Deviance Residuals"</span></span>
<span id="cb116-655"><a href="#cb116-655" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-656"><a href="#cb116-656" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(</span>
<span id="cb116-657"><a href="#cb116-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb116-658"><a href="#cb116-658" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">"red"</span></span>
<span id="cb116-659"><a href="#cb116-659" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-660"><a href="#cb116-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-661"><a href="#cb116-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale–Location</span></span>
<span id="cb116-662"><a href="#cb116-662" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb116-663"><a href="#cb116-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(final.m),</span>
<span id="cb116-664"><a href="#cb116-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>))),</span>
<span id="cb116-665"><a href="#cb116-665" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Fitted values"</span>,</span>
<span id="cb116-666"><a href="#cb116-666" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"√|Deviance residuals|"</span>,</span>
<span id="cb116-667"><a href="#cb116-667" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Scale–Location"</span></span>
<span id="cb116-668"><a href="#cb116-668" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-669"><a href="#cb116-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-670"><a href="#cb116-670" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs Leverage</span></span>
<span id="cb116-671"><a href="#cb116-671" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb116-672"><a href="#cb116-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hatvalues</span>(final.m),</span>
<span id="cb116-673"><a href="#cb116-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(final.m, <span class="at">type =</span> <span class="st">"deviance"</span>),</span>
<span id="cb116-674"><a href="#cb116-674" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Leverage"</span>,</span>
<span id="cb116-675"><a href="#cb116-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Deviance residuals"</span>,</span>
<span id="cb116-676"><a href="#cb116-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Residuals vs Leverage"</span></span>
<span id="cb116-677"><a href="#cb116-677" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-678"><a href="#cb116-678" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-679"><a href="#cb116-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-680"><a href="#cb116-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-683"><a href="#cb116-683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-684"><a href="#cb116-684" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset plotting layout</span></span>
<span id="cb116-685"><a href="#cb116-685" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb116-686"><a href="#cb116-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-687"><a href="#cb116-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-688"><a href="#cb116-688" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-689"><a href="#cb116-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-690"><a href="#cb116-690" aria-hidden="true" tabindex="-1"></a>1)  **Residuals vs Fitted (Deviance residuals)**</span>
<span id="cb116-691"><a href="#cb116-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-692"><a href="#cb116-692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We look for no strong systematic pattern and residuals roughly centred around 0.</span>
<span id="cb116-693"><a href="#cb116-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-694"><a href="#cb116-694" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The residuals versus fitted plot shows the expected banding pattern typical of logistic regression with a binary outcome. Deviance residuals are generally centred around zero, with no strong systematic pattern, suggesting that the model form is broadly appropriate and there is no major lack of fit.</span>
<span id="cb116-695"><a href="#cb116-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-696"><a href="#cb116-696" aria-hidden="true" tabindex="-1"></a>2)  **Q–Q Plot of Deviance Residuals**</span>
<span id="cb116-697"><a href="#cb116-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-698"><a href="#cb116-698" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We look for severe outliers or extreme deviations.</span>
<span id="cb116-699"><a href="#cb116-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-700"><a href="#cb116-700" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Q–Q plot of deviance residuals shows residuals that largely follow the reference line, with mild deviations at the tails. This pattern is acceptable for a logistic regression model and does not indicate serious departures from model assumptions.</span>
<span id="cb116-701"><a href="#cb116-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-702"><a href="#cb116-702" aria-hidden="true" tabindex="-1"></a>3)  **Scale–Location Plot (Spread of residuals)**</span>
<span id="cb116-703"><a href="#cb116-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-704"><a href="#cb116-704" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We look for whether residual variance changes drastically with fitted values.</span>
<span id="cb116-705"><a href="#cb116-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-706"><a href="#cb116-706" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The scale–location plot demonstrates moderate variability of deviance residuals across fitted values. This behaviour is expected in logistic regression due to the binomial variance structure and does not suggest problematic heteroscedasticity.</span>
<span id="cb116-707"><a href="#cb116-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-708"><a href="#cb116-708" aria-hidden="true" tabindex="-1"></a>4)  **Residuals vs Leverage**</span>
<span id="cb116-709"><a href="#cb116-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-710"><a href="#cb116-710" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We look for points with high leverage AND large residuals.</span>
<span id="cb116-711"><a href="#cb116-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-712"><a href="#cb116-712" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Residuals vs Leverage plot indicates that most observations have low leverage, with no extreme influential points exerting undue influence on the model estimates.</span>
<span id="cb116-713"><a href="#cb116-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-714"><a href="#cb116-714" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4.2.2 Cook's distance - influence statistic (confirmation)</span></span>
<span id="cb116-715"><a href="#cb116-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-716"><a href="#cb116-716" aria-hidden="true" tabindex="-1"></a>Cook’s distance measures how much one observation influences the entire regression model. The point is influential, if removing one data point causes coefficients to change a lot, predicted values to change a lot. Cook’s distance depends on large residual and high leverage (extreme predictor values). A Cook’s distance threshold of 4/n, where n is the total number of observations, was used to identify potentially influential cases.</span>
<span id="cb116-717"><a href="#cb116-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-718"><a href="#cb116-718" aria-hidden="true" tabindex="-1"></a>a)  Get Cook’s distance values</span>
<span id="cb116-719"><a href="#cb116-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-722"><a href="#cb116-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-723"><a href="#cb116-723" aria-hidden="true" tabindex="-1"></a>cook_d <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(final.m)</span>
<span id="cb116-724"><a href="#cb116-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-725"><a href="#cb116-725" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cook_d)</span>
<span id="cb116-726"><a href="#cb116-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-727"><a href="#cb116-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-728"><a href="#cb116-728" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-729"><a href="#cb116-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-730"><a href="#cb116-730" aria-hidden="true" tabindex="-1"></a>Most observations have very low influence. One or a few observations have moderately higher influence (Cook's distance cut off = 4/200 = 0.02).</span>
<span id="cb116-731"><a href="#cb116-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-732"><a href="#cb116-732" aria-hidden="true" tabindex="-1"></a>b)  Plot the Cook's Distance</span>
<span id="cb116-733"><a href="#cb116-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-736"><a href="#cb116-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-737"><a href="#cb116-737" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cook_d, <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb116-738"><a href="#cb116-738" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Cook's distance"</span>, <span class="at">xlab =</span> <span class="st">"Observation"</span>,</span>
<span id="cb116-739"><a href="#cb116-739" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Cook's distance for each observation"</span>)</span>
<span id="cb116-740"><a href="#cb116-740" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(mydata), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb116-741"><a href="#cb116-741" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-742"><a href="#cb116-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-743"><a href="#cb116-743" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-744"><a href="#cb116-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-745"><a href="#cb116-745" aria-hidden="true" tabindex="-1"></a>Bars that are above the red line (Cook/s distance = 0.02) are potentially influential.</span>
<span id="cb116-746"><a href="#cb116-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-747"><a href="#cb116-747" aria-hidden="true" tabindex="-1"></a>c)  List potentially influential observations</span>
<span id="cb116-748"><a href="#cb116-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-751"><a href="#cb116-751" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-752"><a href="#cb116-752" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">/</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb116-753"><a href="#cb116-753" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(cook_d <span class="sc">&gt;</span> cutoff)</span>
<span id="cb116-754"><a href="#cb116-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-755"><a href="#cb116-755" aria-hidden="true" tabindex="-1"></a>mydata[<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">29</span>, <span class="dv">41</span>, <span class="dv">68</span>, <span class="dv">85</span>, <span class="dv">104</span>, <span class="dv">108</span>, <span class="dv">118</span>, <span class="dv">123</span>, <span class="dv">136</span>, <span class="dv">170</span>, <span class="dv">172</span>), ]</span>
<span id="cb116-756"><a href="#cb116-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-757"><a href="#cb116-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-758"><a href="#cb116-758" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-759"><a href="#cb116-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-760"><a href="#cb116-760" aria-hidden="true" tabindex="-1"></a>Observations in rows 11, 29, 41, 68, 85, 104, 108, 118, 123, 136, 170, and 172 are potentially influential on logistic regression model and deserve closer inspection.</span>
<span id="cb116-761"><a href="#cb116-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-762"><a href="#cb116-762" aria-hidden="true" tabindex="-1"></a>4)  Sensitivity analysis</span>
<span id="cb116-763"><a href="#cb116-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-766"><a href="#cb116-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-767"><a href="#cb116-767" aria-hidden="true" tabindex="-1"></a>infl_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(cook_d <span class="sc">&gt;</span> cutoff)</span>
<span id="cb116-768"><a href="#cb116-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-769"><a href="#cb116-769" aria-hidden="true" tabindex="-1"></a>model_full  <span class="ot">&lt;-</span> final.m</span>
<span id="cb116-770"><a href="#cb116-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-771"><a href="#cb116-771" aria-hidden="true" tabindex="-1"></a>model_no_infl <span class="ot">&lt;-</span> </span>
<span id="cb116-772"><a href="#cb116-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glm</span>(</span>
<span id="cb116-773"><a href="#cb116-773" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb116-774"><a href="#cb116-774" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata[<span class="sc">-</span>infl_idx, ],</span>
<span id="cb116-775"><a href="#cb116-775" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb116-776"><a href="#cb116-776" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-777"><a href="#cb116-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-778"><a href="#cb116-778" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full)</span>
<span id="cb116-779"><a href="#cb116-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-780"><a href="#cb116-780" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_no_infl)</span>
<span id="cb116-781"><a href="#cb116-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-782"><a href="#cb116-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-783"><a href="#cb116-783" aria-hidden="true" tabindex="-1"></a>5)  convert the coefficient into the odds ratio</span>
<span id="cb116-784"><a href="#cb116-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-787"><a href="#cb116-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-788"><a href="#cb116-788" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_full, <span class="at">conf.int =</span> T, <span class="at">exponentiate =</span> T)</span>
<span id="cb116-789"><a href="#cb116-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-790"><a href="#cb116-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-793"><a href="#cb116-793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-794"><a href="#cb116-794" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_no_infl, <span class="at">conf.int =</span> T, <span class="at">exponentiate =</span> T)</span>
<span id="cb116-795"><a href="#cb116-795" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-796"><a href="#cb116-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-797"><a href="#cb116-797" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-798"><a href="#cb116-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-799"><a href="#cb116-799" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sensitivity analysis using Cook’s distance showed that removal of influential observations resulted in inflation of the odds ratio for obesity, accompanied by wide confidence intervals.</span>
<span id="cb116-800"><a href="#cb116-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-801"><a href="#cb116-801" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, the direction of association remained consistent, and no sign reversal was observed.</span>
<span id="cb116-802"><a href="#cb116-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-803"><a href="#cb116-803" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given the presence of an interaction term between physical activity and obesity, the main effect of obesity reflects the effect at the reference level of physical activity and is therefore sensitive to data sparsity.</span>
<span id="cb116-804"><a href="#cb116-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-805"><a href="#cb116-805" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The full model was retained as the primary model due to greater estimate stability.</span>
<span id="cb116-806"><a href="#cb116-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-807"><a href="#cb116-807" aria-hidden="true" tabindex="-1"></a>“Why is obesity OR so large?”</span>
<span id="cb116-808"><a href="#cb116-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-809"><a href="#cb116-809" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In models including interaction terms, the main effect of obesity represents the effect when physical activity equals zero. This estimate is highly sensitive to sparse data and removal of influential observations, leading to inflated odds ratios. Therefore, interpretation focused on the combined effects rather than the obesity coefficient alone.</span>
<span id="cb116-810"><a href="#cb116-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-811"><a href="#cb116-811" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.2 DFBETAS</span></span>
<span id="cb116-812"><a href="#cb116-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-813"><a href="#cb116-813" aria-hidden="true" tabindex="-1"></a>DFBETAS were examined to assess the influence of individual observations on each regression coefficient. Observations with absolute DFBETAS values exceeding the recommended threshold (values greater than 2/sqrt, n = 2/sqrt, n = 0.14) suggest potentially influential observations for that coefficient.</span>
<span id="cb116-814"><a href="#cb116-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-815"><a href="#cb116-815" aria-hidden="true" tabindex="-1"></a>a)  Gets the DFBETAS value</span>
<span id="cb116-816"><a href="#cb116-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-819"><a href="#cb116-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-820"><a href="#cb116-820" aria-hidden="true" tabindex="-1"></a>dfb <span class="ot">&lt;-</span> <span class="fu">dfbetas</span>(final.m)</span>
<span id="cb116-821"><a href="#cb116-821" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dfb)</span>
<span id="cb116-822"><a href="#cb116-822" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dfb)</span>
<span id="cb116-823"><a href="#cb116-823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-824"><a href="#cb116-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-825"><a href="#cb116-825" aria-hidden="true" tabindex="-1"></a>b)  Define the threshold</span>
<span id="cb116-826"><a href="#cb116-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-829"><a href="#cb116-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-830"><a href="#cb116-830" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb116-831"><a href="#cb116-831" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb116-832"><a href="#cb116-832" aria-hidden="true" tabindex="-1"></a>cutoff</span>
<span id="cb116-833"><a href="#cb116-833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-834"><a href="#cb116-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-835"><a href="#cb116-835" aria-hidden="true" tabindex="-1"></a>c)  Identify influential observations</span>
<span id="cb116-836"><a href="#cb116-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-839"><a href="#cb116-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-840"><a href="#cb116-840" aria-hidden="true" tabindex="-1"></a>infl_dfb <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">abs</span>(dfb) <span class="sc">&gt;</span> cutoff, <span class="at">arr.ind =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-841"><a href="#cb116-841" aria-hidden="true" tabindex="-1"></a>infl_dfb</span>
<span id="cb116-842"><a href="#cb116-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-843"><a href="#cb116-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-844"><a href="#cb116-844" aria-hidden="true" tabindex="-1"></a>d)  Optional plot</span>
<span id="cb116-845"><a href="#cb116-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-846"><a href="#cb116-846" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Years of working</span>
<span id="cb116-847"><a href="#cb116-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-850"><a href="#cb116-850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-851"><a href="#cb116-851" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfb[, <span class="st">"years_working"</span>], <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb116-852"><a href="#cb116-852" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"DFBETAS for years_working"</span>,</span>
<span id="cb116-853"><a href="#cb116-853" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation"</span>)</span>
<span id="cb116-854"><a href="#cb116-854" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span>  cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-855"><a href="#cb116-855" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span>cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-856"><a href="#cb116-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-857"><a href="#cb116-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-858"><a href="#cb116-858" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity score</span>
<span id="cb116-859"><a href="#cb116-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-862"><a href="#cb116-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-863"><a href="#cb116-863" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dfb[, <span class="st">"phys_activity"</span>], <span class="at">type =</span> <span class="st">"h"</span>,</span>
<span id="cb116-864"><a href="#cb116-864" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"DFBETAS for phys_activity"</span>,</span>
<span id="cb116-865"><a href="#cb116-865" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Observation"</span>)</span>
<span id="cb116-866"><a href="#cb116-866" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span>  cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-867"><a href="#cb116-867" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="sc">-</span>cutoff, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb116-868"><a href="#cb116-868" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-869"><a href="#cb116-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-870"><a href="#cb116-870" aria-hidden="true" tabindex="-1"></a>e)  Model with influential observation</span>
<span id="cb116-871"><a href="#cb116-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-874"><a href="#cb116-874" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-875"><a href="#cb116-875" aria-hidden="true" tabindex="-1"></a>model_full_infl_dfb  <span class="ot">&lt;-</span> final.m</span>
<span id="cb116-876"><a href="#cb116-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-877"><a href="#cb116-877" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_full_infl_dfb)</span>
<span id="cb116-878"><a href="#cb116-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-879"><a href="#cb116-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-880"><a href="#cb116-880" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Convert the log odds to odds ratio</span>
<span id="cb116-881"><a href="#cb116-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-884"><a href="#cb116-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-885"><a href="#cb116-885" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(model_full_infl_dfb, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exp =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-886"><a href="#cb116-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-887"><a href="#cb116-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-888"><a href="#cb116-888" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-889"><a href="#cb116-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-890"><a href="#cb116-890" aria-hidden="true" tabindex="-1"></a>DFBETAS analysis identified several observations exceeding the recommended cutoff for multiple regression coefficients, indicating the presence of influential observations. However, findings from sensitivity analysis using Cook’s distance showed that exclusion of these observations did not result in meaningful changes in the direction or interpretation of the estimated associations. Therefore, the full model was retained for inference.</span>
<span id="cb116-891"><a href="#cb116-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-892"><a href="#cb116-892" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.2.3 Leverage points</span></span>
<span id="cb116-893"><a href="#cb116-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-894"><a href="#cb116-894" aria-hidden="true" tabindex="-1"></a>Assume final model:</span>
<span id="cb116-895"><a href="#cb116-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-898"><a href="#cb116-898" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-899"><a href="#cb116-899" aria-hidden="true" tabindex="-1"></a>final.m <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb116-900"><a href="#cb116-900" aria-hidden="true" tabindex="-1"></a>  depression <span class="sc">~</span> years_working <span class="sc">+</span> phys_activity <span class="sc">+</span> obesity <span class="sc">+</span> phys_activity <span class="sc">:</span> obesity,</span>
<span id="cb116-901"><a href="#cb116-901" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mydata,</span>
<span id="cb116-902"><a href="#cb116-902" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)</span>
<span id="cb116-903"><a href="#cb116-903" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-904"><a href="#cb116-904" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(final.m)</span>
<span id="cb116-905"><a href="#cb116-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-906"><a href="#cb116-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-907"><a href="#cb116-907" aria-hidden="true" tabindex="-1"></a>a)  Get hat values (leverage)</span>
<span id="cb116-908"><a href="#cb116-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-911"><a href="#cb116-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-912"><a href="#cb116-912" aria-hidden="true" tabindex="-1"></a>lev <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(final.m)</span>
<span id="cb116-913"><a href="#cb116-913" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lev)</span>
<span id="cb116-914"><a href="#cb116-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-915"><a href="#cb116-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-916"><a href="#cb116-916" aria-hidden="true" tabindex="-1"></a>b)  Set a threshold and list high‑leverage points</span>
<span id="cb116-917"><a href="#cb116-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-920"><a href="#cb116-920" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-921"><a href="#cb116-921" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(mydata)</span>
<span id="cb116-922"><a href="#cb116-922" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(final.m)) </span>
<span id="cb116-923"><a href="#cb116-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-924"><a href="#cb116-924" aria-hidden="true" tabindex="-1"></a>cutoff_2 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> p <span class="sc">/</span> n</span>
<span id="cb116-925"><a href="#cb116-925" aria-hidden="true" tabindex="-1"></a>cutoff_3 <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> p <span class="sc">/</span> n</span>
<span id="cb116-926"><a href="#cb116-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-927"><a href="#cb116-927" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(lev <span class="sc">&gt;</span> cutoff_2)</span>
<span id="cb116-928"><a href="#cb116-928" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-929"><a href="#cb116-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-930"><a href="#cb116-930" aria-hidden="true" tabindex="-1"></a>c)  Inspect those points</span>
<span id="cb116-931"><a href="#cb116-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-934"><a href="#cb116-934" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-935"><a href="#cb116-935" aria-hidden="true" tabindex="-1"></a>high_lev_idx <span class="ot">&lt;-</span> <span class="fu">which</span>(lev <span class="sc">&gt;</span> cutoff_2)</span>
<span id="cb116-936"><a href="#cb116-936" aria-hidden="true" tabindex="-1"></a>mydata[high_lev_idx, ]</span>
<span id="cb116-937"><a href="#cb116-937" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-938"><a href="#cb116-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-939"><a href="#cb116-939" aria-hidden="true" tabindex="-1"></a>d)  Plot leverage</span>
<span id="cb116-940"><a href="#cb116-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-943"><a href="#cb116-943" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-944"><a href="#cb116-944" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(final.m, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb116-945"><a href="#cb116-945" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-946"><a href="#cb116-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-947"><a href="#cb116-947" aria-hidden="true" tabindex="-1"></a>Interpretation:</span>
<span id="cb116-948"><a href="#cb116-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-949"><a href="#cb116-949" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Residuals vs Leverage plot was examined to assess the presence of influential observations in the logistic regression model. Most observations cluster at low leverage values and have standardized Pearson residuals close to zero, indicating that the majority of data points do not exert undue influence on the model estimates.</span>
<span id="cb116-950"><a href="#cb116-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-951"><a href="#cb116-951" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A small number of observations (e.g. observations labelled 31, 33, and 37) show relatively higher leverage and larger residuals compared with the rest of the sample. However, these points lie within the Cook’s distance contours, suggesting that none of the observations exert excessive influence on the fitted model.</span>
<span id="cb116-952"><a href="#cb116-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-953"><a href="#cb116-953" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Overall, the plot does not indicate the presence of highly influential observations that would compromise the stability of the model, and no single data point appears to disproportionately affect the regression estimates.</span>
<span id="cb116-954"><a href="#cb116-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-955"><a href="#cb116-955" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Model fitness</span></span>
<span id="cb116-956"><a href="#cb116-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-957"><a href="#cb116-957" aria-hidden="true" tabindex="-1"></a>Model fitness is checked by using:</span>
<span id="cb116-958"><a href="#cb116-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-959"><a href="#cb116-959" aria-hidden="true" tabindex="-1"></a>1)  Hosmer–Lemeshow goodness-of-fit test</span>
<span id="cb116-960"><a href="#cb116-960" aria-hidden="true" tabindex="-1"></a>2)  Area under the Receiver Operating Characteristic (ROC) curve</span>
<span id="cb116-961"><a href="#cb116-961" aria-hidden="true" tabindex="-1"></a>3)  Classification table / matrix</span>
<span id="cb116-962"><a href="#cb116-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-963"><a href="#cb116-963" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.1 Hosmer–Lemeshow goodness-of-fit test</span></span>
<span id="cb116-964"><a href="#cb116-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-965"><a href="#cb116-965" aria-hidden="true" tabindex="-1"></a>The Hosmer–Lemeshow goodness-of-fit test checks whether the predicted probabilities from the logistic regression agree with the observed outcomes in which p value <span class="sc">\&gt;</span> 0.05 indicated that the model fits the data well.</span>
<span id="cb116-966"><a href="#cb116-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-969"><a href="#cb116-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-970"><a href="#cb116-970" aria-hidden="true" tabindex="-1"></a><span class="co"># Load library</span></span>
<span id="cb116-971"><a href="#cb116-971" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ResourceSelection)</span>
<span id="cb116-972"><a href="#cb116-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-973"><a href="#cb116-973" aria-hidden="true" tabindex="-1"></a><span class="co"># Check on the data</span></span>
<span id="cb116-974"><a href="#cb116-974" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mydata<span class="sc">$</span>depression)</span>
<span id="cb116-975"><a href="#cb116-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-976"><a href="#cb116-976" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-977"><a href="#cb116-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-980"><a href="#cb116-980" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-981"><a href="#cb116-981" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert outcome to numeric 0/1</span></span>
<span id="cb116-982"><a href="#cb116-982" aria-hidden="true" tabindex="-1"></a>mydata<span class="sc">$</span>depression_num <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(mydata<span class="sc">$</span>depression <span class="sc">==</span> <span class="st">"depressed"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb116-983"><a href="#cb116-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-984"><a href="#cb116-984" aria-hidden="true" tabindex="-1"></a><span class="fu">hoslem.test</span>(</span>
<span id="cb116-985"><a href="#cb116-985" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb116-986"><a href="#cb116-986" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">fitted</span>(final.m),</span>
<span id="cb116-987"><a href="#cb116-987" aria-hidden="true" tabindex="-1"></a>  <span class="at">g =</span> <span class="dv">5</span></span>
<span id="cb116-988"><a href="#cb116-988" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-989"><a href="#cb116-989" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-990"><a href="#cb116-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-991"><a href="#cb116-991" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-992"><a href="#cb116-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-993"><a href="#cb116-993" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Hosmer–Lemeshow goodness-of-fit test for the final logistic regression model was statistically significant (χ² = 13.14, df = 3, p = 0.004). With a sample size of 200, the Hosmer–Lemeshow test is known to be highly sensitive, such that even small and practically unimportant deviations between observed and expected values may result in a statistically significant p-value. As a result, a significant Hosmer–Lemeshow test does not necessarily indicate that the model is unusable or poorly performing.</span>
<span id="cb116-994"><a href="#cb116-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-995"><a href="#cb116-995" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Importantly, other measures of model performance indicate that the model performs well. The model demonstrated excellent discriminative ability, with an area under the ROC curve (AUC) of 85.9%, indicating strong ability to distinguish between depressed and non-depressed individuals. In addition, the overall classification accuracy was 86.0%, further supporting the adequacy of the model in correctly classifying outcomes.</span>
<span id="cb116-996"><a href="#cb116-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-997"><a href="#cb116-997" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model diagnostic plots did not reveal major violations of model assumptions or influential observations, and the regression coefficients were stable and clinically interpretable. Taken together, these findings suggest that although the Hosmer–Lemeshow test indicates imperfect calibration, the model demonstrates good discrimination and acceptable overall fit.</span>
<span id="cb116-998"><a href="#cb116-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-999"><a href="#cb116-999" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Therefore, the model was considered appropriate for use, particularly for inference and risk discrimination, with the limitation of imperfect calibration acknowledged.</span>
<span id="cb116-1000"><a href="#cb116-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1001"><a href="#cb116-1001" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.2 Area under the Receiver Operating Characteristic (ROC) curve</span></span>
<span id="cb116-1002"><a href="#cb116-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1003"><a href="#cb116-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The Receiver Operating Characteristic (ROC) curve is used to evaluate how well a logistic regression model can distinguish between individuals with and without the outcome of interest. It assesses the model’s performance across all possible probability cut-off values by plotting sensitivity against 1 − specificity. The Area Under the ROC Curve (AUC) provides a single summary measure of this discriminatory ability, representing the probability that the model assigns a higher predicted risk to an individual with the outcome compared to an individual without the outcome. An AUC value closer to 1 indicates better model performance, the recommended area under the ROC curve is at least 0.70 while an AUC of 0.5 suggests no discriminatory ability beyond random chance.</span>
<span id="cb116-1004"><a href="#cb116-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1007"><a href="#cb116-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1008"><a href="#cb116-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># Load package</span></span>
<span id="cb116-1009"><a href="#cb116-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span>
<span id="cb116-1010"><a href="#cb116-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1011"><a href="#cb116-1011" aria-hidden="true" tabindex="-1"></a><span class="co"># Create ROC object</span></span>
<span id="cb116-1012"><a href="#cb116-1012" aria-hidden="true" tabindex="-1"></a>roc_obj <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb116-1013"><a href="#cb116-1013" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb116-1014"><a href="#cb116-1014" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> <span class="fu">fitted</span>(final.m)</span>
<span id="cb116-1015"><a href="#cb116-1015" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-1016"><a href="#cb116-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1017"><a href="#cb116-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># Get AUC / CI value</span></span>
<span id="cb116-1018"><a href="#cb116-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">auc</span>(roc_obj)</span>
<span id="cb116-1019"><a href="#cb116-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1020"><a href="#cb116-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">ci.auc</span>(roc_obj)</span>
<span id="cb116-1021"><a href="#cb116-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1022"><a href="#cb116-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC curve with AUC and 95% CI</span></span>
<span id="cb116-1023"><a href="#cb116-1023" aria-hidden="true" tabindex="-1"></a>roc_model <span class="ot">&lt;-</span> <span class="fu">roc</span>(</span>
<span id="cb116-1024"><a href="#cb116-1024" aria-hidden="true" tabindex="-1"></a>  <span class="at">response =</span> mydata<span class="sc">$</span>depression_num,</span>
<span id="cb116-1025"><a href="#cb116-1025" aria-hidden="true" tabindex="-1"></a>  <span class="at">predictor =</span> <span class="fu">fitted</span>(final.m),</span>
<span id="cb116-1026"><a href="#cb116-1026" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1027"><a href="#cb116-1027" aria-hidden="true" tabindex="-1"></a>  <span class="at">print.auc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1028"><a href="#cb116-1028" aria-hidden="true" tabindex="-1"></a>  <span class="at">ci =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1029"><a href="#cb116-1029" aria-hidden="true" tabindex="-1"></a>  <span class="at">legacy.axes =</span> <span class="cn">TRUE</span></span>
<span id="cb116-1030"><a href="#cb116-1030" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-1031"><a href="#cb116-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1032"><a href="#cb116-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1033"><a href="#cb116-1033" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-1034"><a href="#cb116-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1035"><a href="#cb116-1035" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The ROC analysis demonstrated excellent model discrimination, with an area under the curve (AUC) of 0.859 (95% CI: 0.796–0.922). This indicates that the model has a strong ability to distinguish between depressed and non-depressed individuals. The model can accurately discriminate 85.9% of the individuals.</span>
<span id="cb116-1036"><a href="#cb116-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1037"><a href="#cb116-1037" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.3 Classification table (Confusion matrix) / Classification metrics</span></span>
<span id="cb116-1038"><a href="#cb116-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1039"><a href="#cb116-1039" aria-hidden="true" tabindex="-1"></a>Model classification performance was evaluated using a classification table and derived performance metrics. At a probability cut-off of 0.5, sensitivity, specificity, accuracy, positive predictive value, and negative predictive value were calculated to assess the model’s ability to correctly classify depressed and non-depressed individuals.</span>
<span id="cb116-1040"><a href="#cb116-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1043"><a href="#cb116-1043" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1044"><a href="#cb116-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb116-1045"><a href="#cb116-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1046"><a href="#cb116-1046" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted probabilities</span></span>
<span id="cb116-1047"><a href="#cb116-1047" aria-hidden="true" tabindex="-1"></a>pred_prob <span class="ot">&lt;-</span> <span class="fu">fitted</span>(final.m)</span>
<span id="cb116-1048"><a href="#cb116-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1049"><a href="#cb116-1049" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut-off</span></span>
<span id="cb116-1050"><a href="#cb116-1050" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb116-1051"><a href="#cb116-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1052"><a href="#cb116-1052" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted class</span></span>
<span id="cb116-1053"><a href="#cb116-1053" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred_prob <span class="sc">&gt;=</span> cutoff, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb116-1054"><a href="#cb116-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1055"><a href="#cb116-1055" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to factors (required by caret)</span></span>
<span id="cb116-1056"><a href="#cb116-1056" aria-hidden="true" tabindex="-1"></a>pred_class <span class="ot">&lt;-</span> <span class="fu">factor</span>(pred_class, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb116-1057"><a href="#cb116-1057" aria-hidden="true" tabindex="-1"></a>obs_class  <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata<span class="sc">$</span>depression_num, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb116-1058"><a href="#cb116-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1059"><a href="#cb116-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix and metrics</span></span>
<span id="cb116-1060"><a href="#cb116-1060" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred_class, obs_class, <span class="at">positive =</span> <span class="st">"1"</span>)</span>
<span id="cb116-1061"><a href="#cb116-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1062"><a href="#cb116-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1063"><a href="#cb116-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1064"><a href="#cb116-1064" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-1065"><a href="#cb116-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1066"><a href="#cb116-1066" aria-hidden="true" tabindex="-1"></a>At a probability cut-off of 0.5, the model achieved an overall accuracy of 86.0%. The specificity was high (95.0%), indicating strong ability to correctly identify non-depressed individuals, while sensitivity was low (65.0%), suggesting limited ability to detect all depressed cases. The balanced accuracy was 80.0%, reflecting good overall classification performance in the presence of class imbalance.</span>
<span id="cb116-1067"><a href="#cb116-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1068"><a href="#cb116-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6 RESULTS PRESENTATION</span></span>
<span id="cb116-1069"><a href="#cb116-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1070"><a href="#cb116-1070" aria-hidden="true" tabindex="-1"></a>Final model consists of covariates:</span>
<span id="cb116-1071"><a href="#cb116-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1072"><a href="#cb116-1072" aria-hidden="true" tabindex="-1"></a>1)  Years of working</span>
<span id="cb116-1073"><a href="#cb116-1073" aria-hidden="true" tabindex="-1"></a>2)  Physical activity score",</span>
<span id="cb116-1074"><a href="#cb116-1074" aria-hidden="true" tabindex="-1"></a>3)  Obesity</span>
<span id="cb116-1075"><a href="#cb116-1075" aria-hidden="true" tabindex="-1"></a>4)  Physical activity × Obesity</span>
<span id="cb116-1076"><a href="#cb116-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1077"><a href="#cb116-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.1 Coefficients table (β, SE, p-value, 95% CI)</span></span>
<span id="cb116-1078"><a href="#cb116-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1081"><a href="#cb116-1081" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1082"><a href="#cb116-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries</span></span>
<span id="cb116-1083"><a href="#cb116-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb116-1084"><a href="#cb116-1084" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb116-1085"><a href="#cb116-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1086"><a href="#cb116-1086" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient table with CI</span></span>
<span id="cb116-1087"><a href="#cb116-1087" aria-hidden="true" tabindex="-1"></a>reg_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb116-1088"><a href="#cb116-1088" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb116-1089"><a href="#cb116-1089" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1090"><a href="#cb116-1090" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">FALSE</span></span>
<span id="cb116-1091"><a href="#cb116-1091" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1092"><a href="#cb116-1092" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, std.error, p.value, conf.low, conf.high)</span>
<span id="cb116-1093"><a href="#cb116-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1094"><a href="#cb116-1094" aria-hidden="true" tabindex="-1"></a>reg_table</span>
<span id="cb116-1095"><a href="#cb116-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1096"><a href="#cb116-1096" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="ot">&lt;-</span> reg_table <span class="sc">%&gt;%</span></span>
<span id="cb116-1097"><a href="#cb116-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1098"><a href="#cb116-1098" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-1099"><a href="#cb116-1099" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"(Intercept)"</span> <span class="sc">~</span> <span class="st">"Constant"</span>,</span>
<span id="cb116-1100"><a href="#cb116-1100" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"years_working"</span> <span class="sc">~</span> <span class="st">"Years of working"</span>,</span>
<span id="cb116-1101"><a href="#cb116-1101" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity"</span> <span class="sc">~</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb116-1102"><a href="#cb116-1102" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"obesityobese"</span> <span class="sc">~</span> <span class="st">"Obesity"</span>,</span>
<span id="cb116-1103"><a href="#cb116-1103" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span> <span class="sc">~</span> </span>
<span id="cb116-1104"><a href="#cb116-1104" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical activity × Obesity"</span>,</span>
<span id="cb116-1105"><a href="#cb116-1105" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb116-1106"><a href="#cb116-1106" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-1107"><a href="#cb116-1107" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1108"><a href="#cb116-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1109"><a href="#cb116-1109" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="ot">&lt;-</span> reg_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb116-1110"><a href="#cb116-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1111"><a href="#cb116-1111" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb116-1112"><a href="#cb116-1112" aria-hidden="true" tabindex="-1"></a>    <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">2</span>),</span>
<span id="cb116-1113"><a href="#cb116-1113" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.low =</span> <span class="fu">round</span>(conf.low, <span class="dv">2</span>),</span>
<span id="cb116-1114"><a href="#cb116-1114" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.high =</span> <span class="fu">round</span>(conf.high, <span class="dv">2</span>),</span>
<span id="cb116-1115"><a href="#cb116-1115" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>))</span>
<span id="cb116-1116"><a href="#cb116-1116" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1117"><a href="#cb116-1117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb116-1118"><a href="#cb116-1118" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> term,</span>
<span id="cb116-1119"><a href="#cb116-1119" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">β</span><span class="st">`</span> <span class="ot">=</span> estimate,</span>
<span id="cb116-1120"><a href="#cb116-1120" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">SE</span><span class="st">`</span> <span class="ot">=</span> std.error,</span>
<span id="cb116-1121"><a href="#cb116-1121" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p.value,</span>
<span id="cb116-1122"><a href="#cb116-1122" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Lower)</span><span class="st">`</span> <span class="ot">=</span> conf.low,</span>
<span id="cb116-1123"><a href="#cb116-1123" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Upper)</span><span class="st">`</span> <span class="ot">=</span> conf.high</span>
<span id="cb116-1124"><a href="#cb116-1124" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1125"><a href="#cb116-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1126"><a href="#cb116-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1127"><a href="#cb116-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb116-1128"><a href="#cb116-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1129"><a href="#cb116-1129" aria-hidden="true" tabindex="-1"></a>reg_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb116-1130"><a href="#cb116-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1131"><a href="#cb116-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb116-1132"><a href="#cb116-1132" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 1. Logistic regression coefficients for factors associated with depression"</span>,</span>
<span id="cb116-1133"><a href="#cb116-1133" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model including physical activity × obesity interaction"</span></span>
<span id="cb116-1134"><a href="#cb116-1134" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1135"><a href="#cb116-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb116-1136"><a href="#cb116-1136" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"β coefficients are presented on the log-odds scale. CI = confidence interval."</span></span>
<span id="cb116-1137"><a href="#cb116-1137" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1138"><a href="#cb116-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1139"><a href="#cb116-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1140"><a href="#cb116-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1141"><a href="#cb116-1141" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.2 Odds ratios, AIC, pseudo-R²</span></span>
<span id="cb116-1142"><a href="#cb116-1142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1145"><a href="#cb116-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1146"><a href="#cb116-1146" aria-hidden="true" tabindex="-1"></a>or_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb116-1147"><a href="#cb116-1147" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb116-1148"><a href="#cb116-1148" aria-hidden="true" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1149"><a href="#cb116-1149" aria-hidden="true" tabindex="-1"></a>  <span class="at">exponentiate =</span> <span class="cn">TRUE</span></span>
<span id="cb116-1150"><a href="#cb116-1150" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1151"><a href="#cb116-1151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, conf.low, conf.high, p.value) </span>
<span id="cb116-1152"><a href="#cb116-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1153"><a href="#cb116-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1154"><a href="#cb116-1154" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table <span class="sc">%&gt;%</span></span>
<span id="cb116-1155"><a href="#cb116-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1156"><a href="#cb116-1156" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-1157"><a href="#cb116-1157" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"(Intercept)"</span> <span class="sc">~</span> <span class="st">"Constant"</span>,</span>
<span id="cb116-1158"><a href="#cb116-1158" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"years_working"</span> <span class="sc">~</span> <span class="st">"Years of working"</span>,</span>
<span id="cb116-1159"><a href="#cb116-1159" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity"</span> <span class="sc">~</span> <span class="st">"Physical activity score"</span>,</span>
<span id="cb116-1160"><a href="#cb116-1160" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"obesityobese"</span> <span class="sc">~</span> <span class="st">"Obesity status"</span>,</span>
<span id="cb116-1161"><a href="#cb116-1161" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span> <span class="sc">~</span> </span>
<span id="cb116-1162"><a href="#cb116-1162" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical activity × Obesity"</span>,</span>
<span id="cb116-1163"><a href="#cb116-1163" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> term</span>
<span id="cb116-1164"><a href="#cb116-1164" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-1165"><a href="#cb116-1165" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1166"><a href="#cb116-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1167"><a href="#cb116-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1168"><a href="#cb116-1168" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb116-1169"><a href="#cb116-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1170"><a href="#cb116-1170" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb116-1171"><a href="#cb116-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.low =</span> <span class="fu">round</span>(conf.low, <span class="dv">2</span>),</span>
<span id="cb116-1172"><a href="#cb116-1172" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.high =</span> <span class="fu">round</span>(conf.high, <span class="dv">2</span>),</span>
<span id="cb116-1173"><a href="#cb116-1173" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">round</span>(p.value, <span class="dv">3</span>))</span>
<span id="cb116-1174"><a href="#cb116-1174" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1175"><a href="#cb116-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb116-1176"><a href="#cb116-1176" aria-hidden="true" tabindex="-1"></a>    <span class="at">Term =</span> term,</span>
<span id="cb116-1177"><a href="#cb116-1177" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">AdjOR</span><span class="st">`</span> <span class="ot">=</span> estimate,</span>
<span id="cb116-1178"><a href="#cb116-1178" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Lower)</span><span class="st">`</span> <span class="ot">=</span> conf.low,</span>
<span id="cb116-1179"><a href="#cb116-1179" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">95% CI (Upper)</span><span class="st">`</span> <span class="ot">=</span> conf.high,</span>
<span id="cb116-1180"><a href="#cb116-1180" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> p.value</span>
<span id="cb116-1181"><a href="#cb116-1181" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1182"><a href="#cb116-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1183"><a href="#cb116-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1184"><a href="#cb116-1184" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="ot">&lt;-</span> or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb116-1185"><a href="#cb116-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Term <span class="sc">!=</span> <span class="st">"Constant"</span>)</span>
<span id="cb116-1186"><a href="#cb116-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1187"><a href="#cb116-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1188"><a href="#cb116-1188" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb116-1189"><a href="#cb116-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1190"><a href="#cb116-1190" aria-hidden="true" tabindex="-1"></a>or_table_clean <span class="sc">%&gt;%</span></span>
<span id="cb116-1191"><a href="#cb116-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1192"><a href="#cb116-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb116-1193"><a href="#cb116-1193" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 2. Logistic regression (Odds ratios) for factors associated with depression"</span>,</span>
<span id="cb116-1194"><a href="#cb116-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Model including physical activity × obesity interaction"</span></span>
<span id="cb116-1195"><a href="#cb116-1195" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1196"><a href="#cb116-1196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb116-1197"><a href="#cb116-1197" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Odds ratios greater than 1 indicate higher odds of depression; values less than 1 indicate lower odds. CI = confidence interval."</span></span>
<span id="cb116-1198"><a href="#cb116-1198" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1199"><a href="#cb116-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1200"><a href="#cb116-1200" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1201"><a href="#cb116-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1202"><a href="#cb116-1202" aria-hidden="true" tabindex="-1"></a>Table 2. presents adjusted odds ratios (OR) with 95% confidence intervals for factors associated with depression. The model includes an interaction term between physical activity score and obesity status.</span>
<span id="cb116-1203"><a href="#cb116-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1204"><a href="#cb116-1204" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.3 AIC, pseudo-R²</span></span>
<span id="cb116-1205"><a href="#cb116-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1208"><a href="#cb116-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1209"><a href="#cb116-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb116-1210"><a href="#cb116-1210" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb116-1211"><a href="#cb116-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb116-1212"><a href="#cb116-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1213"><a href="#cb116-1213" aria-hidden="true" tabindex="-1"></a>model_fit_table <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb116-1214"><a href="#cb116-1214" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Main effects model"</span>, <span class="st">"Interaction model"</span>),</span>
<span id="cb116-1215"><a href="#cb116-1215" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(</span>
<span id="cb116-1216"><a href="#cb116-1216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AIC</span>(model1_mlr),</span>
<span id="cb116-1217"><a href="#cb116-1217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AIC</span>(final.m)</span>
<span id="cb116-1218"><a href="#cb116-1218" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb116-1219"><a href="#cb116-1219" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb116-1220"><a href="#cb116-1220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">r2_nagelkerke</span>(model1_mlr),</span>
<span id="cb116-1221"><a href="#cb116-1221" aria-hidden="true" tabindex="-1"></a>    <span class="fu">r2_nagelkerke</span>(final.m)</span>
<span id="cb116-1222"><a href="#cb116-1222" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1223"><a href="#cb116-1223" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1224"><a href="#cb116-1224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1225"><a href="#cb116-1225" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> <span class="fu">round</span>(AIC, <span class="dv">2</span>),</span>
<span id="cb116-1226"><a href="#cb116-1226" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">Nagelkerke R²</span><span class="st">`</span>, <span class="dv">3</span>)</span>
<span id="cb116-1227"><a href="#cb116-1227" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1228"><a href="#cb116-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1229"><a href="#cb116-1229" aria-hidden="true" tabindex="-1"></a>model_fit_table <span class="sc">%&gt;%</span></span>
<span id="cb116-1230"><a href="#cb116-1230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1231"><a href="#cb116-1231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb116-1232"><a href="#cb116-1232" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Table 3. Model Fit Comparison for Multiple Logistic Regression Models"</span></span>
<span id="cb116-1233"><a href="#cb116-1233" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1234"><a href="#cb116-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb116-1235"><a href="#cb116-1235" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="st">"Lower AIC and higher Nagelkerke R² indicate better model fit."</span></span>
<span id="cb116-1236"><a href="#cb116-1236" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1237"><a href="#cb116-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1238"><a href="#cb116-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1239"><a href="#cb116-1239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1240"><a href="#cb116-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1241"><a href="#cb116-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.4 Interaction plots</span></span>
<span id="cb116-1242"><a href="#cb116-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1243"><a href="#cb116-1243" aria-hidden="true" tabindex="-1"></a>Predicted probability of depression vs. physical activity score, with separate lines for obese and non-obese</span>
<span id="cb116-1244"><a href="#cb116-1244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1247"><a href="#cb116-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1248"><a href="#cb116-1248" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb116-1249"><a href="#cb116-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1250"><a href="#cb116-1250" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(</span>
<span id="cb116-1251"><a href="#cb116-1251" aria-hidden="true" tabindex="-1"></a>  final.m,</span>
<span id="cb116-1252"><a href="#cb116-1252" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> phys_activity,</span>
<span id="cb116-1253"><a href="#cb116-1253" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx =</span> obesity,</span>
<span id="cb116-1254"><a href="#cb116-1254" aria-hidden="true" tabindex="-1"></a>  <span class="at">x.label =</span> <span class="st">"Physical Activity Score"</span>,</span>
<span id="cb116-1255"><a href="#cb116-1255" aria-hidden="true" tabindex="-1"></a>  <span class="at">y.label =</span> <span class="st">"Predicted Probability of Depression"</span>,</span>
<span id="cb116-1256"><a href="#cb116-1256" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.main =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb116-1257"><a href="#cb116-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">main.title =</span> <span class="st">"Predicted Probability of Depression by Physical Activity and Obesity Status"</span>,</span>
<span id="cb116-1258"><a href="#cb116-1258" aria-hidden="true" tabindex="-1"></a>  <span class="at">modx.labels =</span> <span class="fu">c</span>(<span class="st">"Not Obese"</span>, <span class="st">"Obese"</span>)</span>
<span id="cb116-1259"><a href="#cb116-1259" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-1260"><a href="#cb116-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1261"><a href="#cb116-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1262"><a href="#cb116-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1263"><a href="#cb116-1263" aria-hidden="true" tabindex="-1"></a>***Interpretation:***</span>
<span id="cb116-1264"><a href="#cb116-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1265"><a href="#cb116-1265" aria-hidden="true" tabindex="-1"></a>1)  **Non-obese individuals**</span>
<span id="cb116-1266"><a href="#cb116-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1267"><a href="#cb116-1267" aria-hidden="true" tabindex="-1"></a>Among non-obese individuals, the predicted probability of depression starts at a moderate level when physical activity is low and declines gradually as physical activity increases. This indicates a steady but modest protective effect of physical activity in this group. Even at higher physical activity scores, the probability of depression decreases progressively rather than sharply, suggesting that physical activity reduces depression risk consistently but without a dramatic change in slope.</span>
<span id="cb116-1268"><a href="#cb116-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1269"><a href="#cb116-1269" aria-hidden="true" tabindex="-1"></a>2)  **Obese individuals**</span>
<span id="cb116-1270"><a href="#cb116-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1271"><a href="#cb116-1271" aria-hidden="true" tabindex="-1"></a>In contrast, obese individuals show a much higher predicted probability of depression at very low levels of physical activity. However, as physical activity increases, the predicted probability of depression declines sharply, with a much steeper slope compared to the non-obese group. At moderate to high physical activity levels, the predicted probability among obese individuals becomes very low and approaches zero, indicating a substantially stronger protective effect of physical activity in this group.</span>
<span id="cb116-1272"><a href="#cb116-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1273"><a href="#cb116-1273" aria-hidden="true" tabindex="-1"></a>3)  **Evidence of interaction (effect modification)**</span>
<span id="cb116-1274"><a href="#cb116-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1275"><a href="#cb116-1275" aria-hidden="true" tabindex="-1"></a>The clear difference in the slopes of the two curves provides visual evidence of an interaction between physical activity and obesity status. Specifically, the effect of physical activity on depression is not uniform across obesity groups. Physical activity has a disproportionately larger impact on reducing depression risk among obese individuals compared with non-obese individuals. This visual pattern is consistent with the statistically significant interaction term observed in the regression model.</span>
<span id="cb116-1276"><a href="#cb116-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1277"><a href="#cb116-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6.5 Final model</span></span>
<span id="cb116-1278"><a href="#cb116-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1281"><a href="#cb116-1281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1282"><a href="#cb116-1282" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb116-1283"><a href="#cb116-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb116-1284"><a href="#cb116-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb116-1285"><a href="#cb116-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1286"><a href="#cb116-1286" aria-hidden="true" tabindex="-1"></a>final_table <span class="ot">&lt;-</span> {</span>
<span id="cb116-1287"><a href="#cb116-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1288"><a href="#cb116-1288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Extract B and SE ----</span></span>
<span id="cb116-1289"><a href="#cb116-1289" aria-hidden="true" tabindex="-1"></a>  coef_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb116-1290"><a href="#cb116-1290" aria-hidden="true" tabindex="-1"></a>    final.m,</span>
<span id="cb116-1291"><a href="#cb116-1291" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.int =</span> <span class="cn">FALSE</span>,</span>
<span id="cb116-1292"><a href="#cb116-1292" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">FALSE</span></span>
<span id="cb116-1293"><a href="#cb116-1293" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1294"><a href="#cb116-1294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1295"><a href="#cb116-1295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, std.error)</span>
<span id="cb116-1296"><a href="#cb116-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1297"><a href="#cb116-1297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Extract OR and CI ----</span></span>
<span id="cb116-1298"><a href="#cb116-1298" aria-hidden="true" tabindex="-1"></a>  or_table <span class="ot">&lt;-</span> <span class="fu">tidy</span>(</span>
<span id="cb116-1299"><a href="#cb116-1299" aria-hidden="true" tabindex="-1"></a>    final.m,</span>
<span id="cb116-1300"><a href="#cb116-1300" aria-hidden="true" tabindex="-1"></a>    <span class="at">conf.int =</span> <span class="cn">TRUE</span>,</span>
<span id="cb116-1301"><a href="#cb116-1301" aria-hidden="true" tabindex="-1"></a>    <span class="at">exponentiate =</span> <span class="cn">TRUE</span></span>
<span id="cb116-1302"><a href="#cb116-1302" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1303"><a href="#cb116-1303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">"(Intercept)"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1304"><a href="#cb116-1304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(term, estimate, conf.low, conf.high, p.value)</span>
<span id="cb116-1305"><a href="#cb116-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1306"><a href="#cb116-1306" aria-hidden="true" tabindex="-1"></a>  table_all <span class="ot">&lt;-</span> coef_table <span class="sc">%&gt;%</span></span>
<span id="cb116-1307"><a href="#cb116-1307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(or_table, <span class="at">by =</span> <span class="st">"term"</span>)</span>
<span id="cb116-1308"><a href="#cb116-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1309"><a href="#cb116-1309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Build table ----</span></span>
<span id="cb116-1310"><a href="#cb116-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb116-1311"><a href="#cb116-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1312"><a href="#cb116-1312" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Years Working</span></span>
<span id="cb116-1313"><a href="#cb116-1313" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb116-1314"><a href="#cb116-1314" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"years_working"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1315"><a href="#cb116-1315" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Years Working"</span>),</span>
<span id="cb116-1316"><a href="#cb116-1316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1317"><a href="#cb116-1317" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Physical Activity</span></span>
<span id="cb116-1318"><a href="#cb116-1318" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb116-1319"><a href="#cb116-1319" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1320"><a href="#cb116-1320" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Physical Activity Score"</span>),</span>
<span id="cb116-1321"><a href="#cb116-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1322"><a href="#cb116-1322" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obesity header</span></span>
<span id="cb116-1323"><a href="#cb116-1323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb116-1324"><a href="#cb116-1324" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="st">"Obesity Status"</span>,</span>
<span id="cb116-1325"><a href="#cb116-1325" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.x =</span> <span class="cn">NA</span>, <span class="at">std.error =</span> <span class="cn">NA</span>,</span>
<span id="cb116-1326"><a href="#cb116-1326" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.y =</span> <span class="cn">NA</span>, <span class="at">conf.low =</span> <span class="cn">NA</span>, <span class="at">conf.high =</span> <span class="cn">NA</span>,</span>
<span id="cb116-1327"><a href="#cb116-1327" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="cn">NA</span></span>
<span id="cb116-1328"><a href="#cb116-1328" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb116-1329"><a href="#cb116-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1330"><a href="#cb116-1330" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Not Obese (reference)</span></span>
<span id="cb116-1331"><a href="#cb116-1331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb116-1332"><a href="#cb116-1332" aria-hidden="true" tabindex="-1"></a>      <span class="at">term =</span> <span class="st">"  Not Obese"</span>,</span>
<span id="cb116-1333"><a href="#cb116-1333" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.x =</span> <span class="dv">1</span>,</span>
<span id="cb116-1334"><a href="#cb116-1334" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="cn">NA</span>,</span>
<span id="cb116-1335"><a href="#cb116-1335" aria-hidden="true" tabindex="-1"></a>      <span class="at">estimate.y =</span> <span class="dv">1</span>,</span>
<span id="cb116-1336"><a href="#cb116-1336" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.low =</span> <span class="cn">NA</span>,</span>
<span id="cb116-1337"><a href="#cb116-1337" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.high =</span> <span class="cn">NA</span>,</span>
<span id="cb116-1338"><a href="#cb116-1338" aria-hidden="true" tabindex="-1"></a>      <span class="at">p.value =</span> <span class="cn">NA</span></span>
<span id="cb116-1339"><a href="#cb116-1339" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb116-1340"><a href="#cb116-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1341"><a href="#cb116-1341" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Obese</span></span>
<span id="cb116-1342"><a href="#cb116-1342" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb116-1343"><a href="#cb116-1343" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"obesityobese"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1344"><a href="#cb116-1344" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"  Obese"</span>),</span>
<span id="cb116-1345"><a href="#cb116-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1346"><a href="#cb116-1346" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Interaction (single row only)</span></span>
<span id="cb116-1347"><a href="#cb116-1347" aria-hidden="true" tabindex="-1"></a>    table_all <span class="sc">%&gt;%</span></span>
<span id="cb116-1348"><a href="#cb116-1348" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"phys_activity:obesityobese"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-1349"><a href="#cb116-1349" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">term =</span> <span class="st">"Physical Activity Score * Obesity Status"</span>)</span>
<span id="cb116-1350"><a href="#cb116-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1351"><a href="#cb116-1351" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1352"><a href="#cb116-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1353"><a href="#cb116-1353" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ---- Formatting ----</span></span>
<span id="cb116-1354"><a href="#cb116-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb116-1355"><a href="#cb116-1355" aria-hidden="true" tabindex="-1"></a>    <span class="at">B =</span> <span class="fu">case_when</span>(</span>
<span id="cb116-1356"><a href="#cb116-1356" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"  Not Obese"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb116-1357"><a href="#cb116-1357" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(estimate.x) <span class="sc">~</span> <span class="st">""</span>,</span>
<span id="cb116-1358"><a href="#cb116-1358" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, estimate.x)</span>
<span id="cb116-1359"><a href="#cb116-1359" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb116-1360"><a href="#cb116-1360" aria-hidden="true" tabindex="-1"></a>    <span class="at">SE =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(std.error), <span class="st">""</span>, <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, std.error)),</span>
<span id="cb116-1361"><a href="#cb116-1361" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adj OR (95% CI)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">case_when</span>(</span>
<span id="cb116-1362"><a href="#cb116-1362" aria-hidden="true" tabindex="-1"></a>      term <span class="sc">==</span> <span class="st">"  Not Obese"</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb116-1363"><a href="#cb116-1363" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(estimate.y) <span class="sc">~</span> <span class="st">""</span>,</span>
<span id="cb116-1364"><a href="#cb116-1364" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb116-1365"><a href="#cb116-1365" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, estimate.y), <span class="st">" ("</span>,</span>
<span id="cb116-1366"><a href="#cb116-1366" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, conf.low), <span class="st">", "</span>,</span>
<span id="cb116-1367"><a href="#cb116-1367" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sprintf</span>(<span class="st">"%.2f"</span>, conf.high), <span class="st">")"</span></span>
<span id="cb116-1368"><a href="#cb116-1368" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb116-1369"><a href="#cb116-1369" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb116-1370"><a href="#cb116-1370" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb116-1371"><a href="#cb116-1371" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(p.value),</span>
<span id="cb116-1372"><a href="#cb116-1372" aria-hidden="true" tabindex="-1"></a>      <span class="st">""</span>,</span>
<span id="cb116-1373"><a href="#cb116-1373" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ifelse</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.001</span>, <span class="st">"&lt;0.001"</span>, <span class="fu">sprintf</span>(<span class="st">"%.3f"</span>, p.value))</span>
<span id="cb116-1374"><a href="#cb116-1374" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-1375"><a href="#cb116-1375" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1376"><a href="#cb116-1376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb116-1377"><a href="#cb116-1377" aria-hidden="true" tabindex="-1"></a>    <span class="at">Variables =</span> term,</span>
<span id="cb116-1378"><a href="#cb116-1378" aria-hidden="true" tabindex="-1"></a>    B,</span>
<span id="cb116-1379"><a href="#cb116-1379" aria-hidden="true" tabindex="-1"></a>    SE,</span>
<span id="cb116-1380"><a href="#cb116-1380" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Adj OR (95% CI)</span><span class="st">`</span>,</span>
<span id="cb116-1381"><a href="#cb116-1381" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">p-value</span><span class="st">`</span></span>
<span id="cb116-1382"><a href="#cb116-1382" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1383"><a href="#cb116-1383" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-1384"><a href="#cb116-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1385"><a href="#cb116-1385" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- GT table ----</span></span>
<span id="cb116-1386"><a href="#cb116-1386" aria-hidden="true" tabindex="-1"></a>final_table <span class="sc">%&gt;%</span></span>
<span id="cb116-1387"><a href="#cb116-1387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-1388"><a href="#cb116-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb116-1389"><a href="#cb116-1389" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">md</span>(<span class="st">"**Table 4. Final Multivariable Logistic Regression Model for Depression**"</span>)</span>
<span id="cb116-1390"><a href="#cb116-1390" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1391"><a href="#cb116-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1392"><a href="#cb116-1392" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold column headers</span></span>
<span id="cb116-1393"><a href="#cb116-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb116-1394"><a href="#cb116-1394" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb116-1395"><a href="#cb116-1395" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_column_labels</span>(<span class="fu">everything</span>())</span>
<span id="cb116-1396"><a href="#cb116-1396" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1397"><a href="#cb116-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1398"><a href="#cb116-1398" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bold only main variable rows</span></span>
<span id="cb116-1399"><a href="#cb116-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb116-1400"><a href="#cb116-1400" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb116-1401"><a href="#cb116-1401" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span> <span class="fu">cells_body</span>(</span>
<span id="cb116-1402"><a href="#cb116-1402" aria-hidden="true" tabindex="-1"></a>      <span class="at">columns =</span> Variables,</span>
<span id="cb116-1403"><a href="#cb116-1403" aria-hidden="true" tabindex="-1"></a>      <span class="at">rows =</span> Variables <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb116-1404"><a href="#cb116-1404" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Years Working"</span>,</span>
<span id="cb116-1405"><a href="#cb116-1405" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical Activity Score"</span>,</span>
<span id="cb116-1406"><a href="#cb116-1406" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Obesity Status"</span>,</span>
<span id="cb116-1407"><a href="#cb116-1407" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Physical Activity Score * Obesity Status"</span></span>
<span id="cb116-1408"><a href="#cb116-1408" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb116-1409"><a href="#cb116-1409" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-1410"><a href="#cb116-1410" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1411"><a href="#cb116-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1412"><a href="#cb116-1412" aria-hidden="true" tabindex="-1"></a>   <span class="fu">cols_align</span>(</span>
<span id="cb116-1413"><a href="#cb116-1413" aria-hidden="true" tabindex="-1"></a>    <span class="at">align =</span> <span class="st">"left"</span>,</span>
<span id="cb116-1414"><a href="#cb116-1414" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>Variables</span>
<span id="cb116-1415"><a href="#cb116-1415" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb116-1416"><a href="#cb116-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1417"><a href="#cb116-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_source_note</span>(</span>
<span id="cb116-1418"><a href="#cb116-1418" aria-hidden="true" tabindex="-1"></a>    <span class="at">source_note =</span> <span class="fu">paste</span>(</span>
<span id="cb116-1419"><a href="#cb116-1419" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Constant = -1.93;"</span>,</span>
<span id="cb116-1420"><a href="#cb116-1420" aria-hidden="true" tabindex="-1"></a>      <span class="st">"No multicollinearity;"</span>,</span>
<span id="cb116-1421"><a href="#cb116-1421" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Hosmer–Lemeshow test p-value = 0.004;"</span>,</span>
<span id="cb116-1422"><a href="#cb116-1422" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Classification accuracy = 86.0%;"</span>,</span>
<span id="cb116-1423"><a href="#cb116-1423" aria-hidden="true" tabindex="-1"></a>      <span class="st">"AUC (ROC) = 85.9%;"</span>,</span>
<span id="cb116-1424"><a href="#cb116-1424" aria-hidden="true" tabindex="-1"></a>      <span class="st">"AIC = 171.84;"</span>,</span>
<span id="cb116-1425"><a href="#cb116-1425" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Nagelkerke’s R² = 0.479;"</span>,</span>
<span id="cb116-1426"><a href="#cb116-1426" aria-hidden="true" tabindex="-1"></a>      <span class="st">"CI = Confidence Interval"</span></span>
<span id="cb116-1427"><a href="#cb116-1427" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-1428"><a href="#cb116-1428" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1429"><a href="#cb116-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1430"><a href="#cb116-1430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1431"><a href="#cb116-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1432"><a href="#cb116-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">## 7 FINAL MODEL EQUATION</span></span>
<span id="cb116-1433"><a href="#cb116-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1434"><a href="#cb116-1434" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.1 Odds Ratio</span></span>
<span id="cb116-1435"><a href="#cb116-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1436"><a href="#cb116-1436" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-1437"><a href="#cb116-1437" aria-hidden="true" tabindex="-1"></a>\text{Odds}(\text{Depression}) = \frac{p}{1 - p}</span>
<span id="cb116-1438"><a href="#cb116-1438" aria-hidden="true" tabindex="-1"></a>= \exp\Big[</span>
<span id="cb116-1439"><a href="#cb116-1439" aria-hidden="true" tabindex="-1"></a>-1.87</span>
<span id="cb116-1440"><a href="#cb116-1440" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>0.07 (\text{Years Working})</span>
<span id="cb116-1441"><a href="#cb116-1441" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>0.30 (\text{Physical Activity})</span>
<span id="cb116-1442"><a href="#cb116-1442" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>2.07 (\text{Obese})</span>
<span id="cb116-1443"><a href="#cb116-1443" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>0.92 (\text{Physical Activity} \times \text{Obese})</span>
<span id="cb116-1444"><a href="#cb116-1444" aria-hidden="true" tabindex="-1"></a>\Big]</span>
<span id="cb116-1445"><a href="#cb116-1445" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-1446"><a href="#cb116-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1447"><a href="#cb116-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">### 7.2 Probability</span></span>
<span id="cb116-1448"><a href="#cb116-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1449"><a href="#cb116-1449" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-1450"><a href="#cb116-1450" aria-hidden="true" tabindex="-1"></a>P(\text{Depression}=1)</span>
<span id="cb116-1451"><a href="#cb116-1451" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb116-1452"><a href="#cb116-1452" aria-hidden="true" tabindex="-1"></a>\frac{1}</span>
<span id="cb116-1453"><a href="#cb116-1453" aria-hidden="true" tabindex="-1"></a>{1 + \exp\left[-\left(</span>
<span id="cb116-1454"><a href="#cb116-1454" aria-hidden="true" tabindex="-1"></a>-1.87</span>
<span id="cb116-1455"><a href="#cb116-1455" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>0.07(\text{Years Working})</span>
<span id="cb116-1456"><a href="#cb116-1456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>0.30(\text{Physical Activity})</span>
<span id="cb116-1457"><a href="#cb116-1457" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span>2.07(\text{Obese})</span>
<span id="cb116-1458"><a href="#cb116-1458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>0.92(\text{Physical Activity} \times \text{Obese})</span>
<span id="cb116-1459"><a href="#cb116-1459" aria-hidden="true" tabindex="-1"></a>\right)\right]}</span>
<span id="cb116-1460"><a href="#cb116-1460" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb116-1461"><a href="#cb116-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1462"><a href="#cb116-1462" aria-hidden="true" tabindex="-1"></a><span class="fu">## 8 PREDICTION ANALYSIS</span></span>
<span id="cb116-1463"><a href="#cb116-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1464"><a href="#cb116-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">### 8.1 Create new dataframe for prediction</span></span>
<span id="cb116-1465"><a href="#cb116-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1468"><a href="#cb116-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1469"><a href="#cb116-1469" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb116-1470"><a href="#cb116-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1471"><a href="#cb116-1471" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb116-1472"><a href="#cb116-1472" aria-hidden="true" tabindex="-1"></a>  <span class="at">years_working =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">10</span>),</span>
<span id="cb116-1473"><a href="#cb116-1473" aria-hidden="true" tabindex="-1"></a>  <span class="at">phys_activity =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>),</span>
<span id="cb116-1474"><a href="#cb116-1474" aria-hidden="true" tabindex="-1"></a>  <span class="at">obesity =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"not obese"</span>, <span class="st">"obese"</span>))</span>
<span id="cb116-1475"><a href="#cb116-1475" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb116-1476"><a href="#cb116-1476" aria-hidden="true" tabindex="-1"></a>new_data <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span>
<span id="cb116-1477"><a href="#cb116-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1478"><a href="#cb116-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1479"><a href="#cb116-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">### 8.2 Generate predicted odds</span></span>
<span id="cb116-1480"><a href="#cb116-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1483"><a href="#cb116-1483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1484"><a href="#cb116-1484" aria-hidden="true" tabindex="-1"></a>predic_odds <span class="ot">&lt;-</span> <span class="fu">augment</span>(final.m,</span>
<span id="cb116-1485"><a href="#cb116-1485" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> new_data,</span>
<span id="cb116-1486"><a href="#cb116-1486" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type.predict =</span> <span class="st">'link'</span>)</span>
<span id="cb116-1487"><a href="#cb116-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1488"><a href="#cb116-1488" aria-hidden="true" tabindex="-1"></a>predic_odds <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span>
<span id="cb116-1489"><a href="#cb116-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1490"><a href="#cb116-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1491"><a href="#cb116-1491" aria-hidden="true" tabindex="-1"></a><span class="fu">### 8.3 Generate predicted probability</span></span>
<span id="cb116-1492"><a href="#cb116-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1495"><a href="#cb116-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1496"><a href="#cb116-1496" aria-hidden="true" tabindex="-1"></a>predic_prob <span class="ot">&lt;-</span> <span class="fu">augment</span>(final.m,</span>
<span id="cb116-1497"><a href="#cb116-1497" aria-hidden="true" tabindex="-1"></a>                       <span class="at">newdata =</span> new_data,</span>
<span id="cb116-1498"><a href="#cb116-1498" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type.predict =</span> <span class="st">'response'</span>)</span>
<span id="cb116-1499"><a href="#cb116-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1500"><a href="#cb116-1500" aria-hidden="true" tabindex="-1"></a>predic_prob <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span>
<span id="cb116-1501"><a href="#cb116-1501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1502"><a href="#cb116-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1503"><a href="#cb116-1503" aria-hidden="true" tabindex="-1"></a><span class="fu">## 9 FINAL MODEL RESULT INTERPRETATION</span></span>
<span id="cb116-1504"><a href="#cb116-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1505"><a href="#cb116-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.1 Main Effects</span></span>
<span id="cb116-1506"><a href="#cb116-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1507"><a href="#cb116-1507" aria-hidden="true" tabindex="-1"></a>1)  **Years of working** (Adj OR = 1.09, 95% CI: 1.05,1.14, p<span class="sc">\&lt;</span>0.05)</span>
<span id="cb116-1508"><a href="#cb116-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1509"><a href="#cb116-1509" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Years working was positively associated with depression after adjusting for other variables in the model. The adjusted odds ratio was 1.09 (95% CI: 1.05, 1.14), indicating that for each additional year of working, the odds of depression increased by 9%, holding other factors constant. The confidence interval is narrow, does not include 1, and suggests a precise estimate of effect. The association was statistically significant (p <span class="sc">\&lt;</span> 0.05), providing strong evidence that longer duration of employment is independently associated with higher odds of depression.</span>
<span id="cb116-1510"><a href="#cb116-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1511"><a href="#cb116-1511" aria-hidden="true" tabindex="-1"></a>2)  **Physical Activity Score** (Adj OR = 0.74, 95% CI: 0.62,0.87, p<span class="sc">\&lt;</span>0.05)</span>
<span id="cb116-1512"><a href="#cb116-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1513"><a href="#cb116-1513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Physical activity score showed a negative association with depression. The adjusted odds ratio was 0.74 (95% CI: 0.62, 0.87), meaning that each one-unit increase in physical activity score was associated with a 26% reduction in the odds of depression, after controlling for other variables. The confidence interval is moderately narrow, does not include 1, and consistently lies below 1, supporting a protective effect. This association was statistically significant (p <span class="sc">\&lt;</span> 0.05), indicating that higher physical activity levels are independently associated with lower odds of depression.</span>
<span id="cb116-1514"><a href="#cb116-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1515"><a href="#cb116-1515" aria-hidden="true" tabindex="-1"></a>3)  **Obesity Status** (Obese) (Adj OR = 67.23, 95% CI: 7.46, 1176.33, p <span class="sc">\&lt;</span> 0.05)</span>
<span id="cb116-1516"><a href="#cb116-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1517"><a href="#cb116-1517" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Obesity status was positively associated with depression. Individuals classified as obese had a substantially higher odds of depression (Adj OR 67.23, 95% CI: 7.46, 1176.33), compared to those who were not obese, after adjusting for other variables. The confidence interval is wide, suggesting greater uncertainty and variability in the estimate, but importantly it does not include 1, indicating a true association. The association was statistically significant (p <span class="sc">\&lt;</span> 0.05), supporting obesity as an independent risk factor for depression in this model.</span>
<span id="cb116-1518"><a href="#cb116-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1519"><a href="#cb116-1519" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.2 Interaction Effect</span></span>
<span id="cb116-1520"><a href="#cb116-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1521"><a href="#cb116-1521" aria-hidden="true" tabindex="-1"></a>**Physical Activity Score × Obesity Status** (Adj OR = 0.44, 95% CI: 0.23,0.72, p = 0.004)</span>
<span id="cb116-1522"><a href="#cb116-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1523"><a href="#cb116-1523" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The interaction between physical activity score and obesity status showed a negative association with depression, with an adjusted odds ratio of 0.44 (95% CI: 0.23, 0.72). This indicates that obesity status significantly modifies the relationship between physical activity and depression, such that the protective effect of physical activity is stronger among obese individuals compared with non-obese individuals. The confidence interval is moderately wide but does not include 1, confirming the presence of a meaningful interaction effect. This interaction was statistically significant (p = 0.004), providing evidence of effect modification.</span>
<span id="cb116-1524"><a href="#cb116-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1525"><a href="#cb116-1525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When this interaction was taken into account, the combined effect of physical activity among obese individuals was substantially stronger. Specifically, each one-unit increase in physical activity score was associated with an approximate 67% reduction in the odds of depression (combined adjusted OR = 0.74 x 0.44 = 0.33), indicating that increased physical activity confers a markedly greater protective effect against depression in obese individuals than in their non-obese counterparts.</span>
<span id="cb116-1526"><a href="#cb116-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1527"><a href="#cb116-1527" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.3 Comparison models with and without interactions</span></span>
<span id="cb116-1528"><a href="#cb116-1528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1529"><a href="#cb116-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The model without interaction included years working, physical activity score, and obesity status as main effects only. In contrast, the interaction model additionally incorporated the interaction term between physical activity score and obesity status to assess whether the effect of physical activity on depression differed by obesity status.</span>
<span id="cb116-1530"><a href="#cb116-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1531"><a href="#cb116-1531" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Based on the likelihood ratio test (Analysis of Deviance), adding the interaction term resulted in a statistically significant improvement in model fit. The residual deviance decreased from 174.60 in the model without interaction to 161.84 in the model with interaction, corresponding to a deviance reduction of 12.76 with 1 additional degree of freedom. This reduction was statistically significant (χ² = 12.76, p = 0.0004), indicating that the interaction term explains a significant proportion of variation in depression beyond the main effects alone.</span>
<span id="cb116-1532"><a href="#cb116-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1533"><a href="#cb116-1533" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The residual degrees of freedom decreased from 196 to 195, reflecting the inclusion of one additional parameter in the interaction model. Importantly, the substantial reduction in deviance relative to the small loss of degrees of freedom suggests that the interaction model provides a better balance between model complexity and explanatory power.</span>
<span id="cb116-1534"><a href="#cb116-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1535"><a href="#cb116-1535" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>From a substantive perspective, the non-interaction model assumes that the association between physical activity and depression is the same for obese and non-obese individuals. However, the statistically significant interaction term in the expanded model demonstrates that this assumption does not hold. Instead, the effect of physical activity on depression differs by obesity status, with physical activity having a significantly stronger protective effect among obese individuals. Therefore, failing to include the interaction would mask this important effect modification and potentially lead to an oversimplified interpretation of the relationship between physical activity and depression.</span>
<span id="cb116-1536"><a href="#cb116-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1537"><a href="#cb116-1537" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.4 Practical Significance of the Findings</span></span>
<span id="cb116-1538"><a href="#cb116-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1539"><a href="#cb116-1539" aria-hidden="true" tabindex="-1"></a>1)  **Accumulated Work Exposure has a Meaningful Impact on Mental Health**</span>
<span id="cb116-1540"><a href="#cb116-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1541"><a href="#cb116-1541" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Although the adjusted odds ratio for years working appears modest (Adj OR = 1.09), the effect is practically important because it accumulates over time. A 9% increase in odds per year translates into a substantially higher risk over longer employment durations. For example, an individual with 10 additional years of working experience would have markedly higher odds of depression compared to a newly employed individual. This highlights the need for long-term mental health monitoring, stress management, and supportive workplace policies, particularly for mid-career and senior employees.</span>
<span id="cb116-1542"><a href="#cb116-1542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1543"><a href="#cb116-1543" aria-hidden="true" tabindex="-1"></a>2)  **Physical Activity is a Strong and Modifiable Protective Factor**</span>
<span id="cb116-1544"><a href="#cb116-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1545"><a href="#cb116-1545" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The physical activity score demonstrated a clinically meaningful protective effect against depression (Adj OR = 0.74). A 26% reduction in odds per unit increase suggests that even small, achievable improvements in physical activity can yield substantial mental health benefits. From a practical standpoint, this supports workplace and community interventions such as scheduled activity breaks, walking programs, and structured exercise initiatives as cost-effective and scalable strategies to reduce depression risk.</span>
<span id="cb116-1546"><a href="#cb116-1546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1547"><a href="#cb116-1547" aria-hidden="true" tabindex="-1"></a>3)  **Obesity Represents a High-Risk Group for Depression**</span>
<span id="cb116-1548"><a href="#cb116-1548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1549"><a href="#cb116-1549" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The large adjusted odds ratio observed for obesity (Adj OR = 67.23) indicates that obese individuals face substantially higher odds of depression compared with non-obese individuals. Despite the wide confidence interval, the magnitude of the association is practically important and identifies obesity as a priority risk group for mental health screening and early intervention. In practice, this finding supports integrated approaches that combine mental health services with weight management and lifestyle programmes.</span>
<span id="cb116-1550"><a href="#cb116-1550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1551"><a href="#cb116-1551" aria-hidden="true" tabindex="-1"></a>4)  **Physical Activity Is Especially Beneficial Among Obese Individuals**</span>
<span id="cb116-1552"><a href="#cb116-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1553"><a href="#cb116-1553" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The statistically significant interaction between physical activity and obesity demonstrates that the mental health benefits of physical activity are not uniform across groups. Among obese individuals, the combined effect of physical activity resulted in an approximate 67% reduction in the odds of depression, indicating a substantially stronger protective effect than in non-obese individuals. Practically, this suggests that targeting physical activity interventions toward obese populations may yield disproportionately greater mental health gains and represents an efficient use of limited public health resources.</span>
<span id="cb116-1554"><a href="#cb116-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1555"><a href="#cb116-1555" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.5 Addressing any violations of assumptions</span></span>
<span id="cb116-1556"><a href="#cb116-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1557"><a href="#cb116-1557" aria-hidden="true" tabindex="-1"></a>Taken together, the diagnostic assessments indicate that no major violations of logistic regression assumptions remained in the final model. Initial model checking suggested that a model without interaction may have been overly simplistic, as it assumed that the effect of physical activity on depression was constant across obesity status. This issue was addressed by including the physical activity × obesity interaction, which significantly improved model fit, reduced residual deviance, and corrected the model specification. The inclusion of this interaction therefore ensured that the model more accurately reflected the underlying relationship between predictors and the outcome.</span>
<span id="cb116-1558"><a href="#cb116-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1559"><a href="#cb116-1559" aria-hidden="true" tabindex="-1"></a>Furthermore, assessment of the linearity of continuous predictors with the logit indicated that both years working and physical activity score were appropriately modeled as linear terms. There was no evidence of substantial departures from linearity that would compromise the validity of the estimated odds ratios. This supports the interpretability and stability of the regression coefficients.</span>
<span id="cb116-1560"><a href="#cb116-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1561"><a href="#cb116-1561" aria-hidden="true" tabindex="-1"></a>The assumption of independence of observations was satisfied based on the study design, as each observation represented a unique individual with no clustering or repeated measurements. In addition, checks for multicollinearity showed no problematic correlations among predictors, suggesting that coefficient estimates were not inflated or unstable due to redundancy between variables.</span>
<span id="cb116-1562"><a href="#cb116-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1563"><a href="#cb116-1563" aria-hidden="true" tabindex="-1"></a>Although the Hosmer–Lemeshow test was statistically significant (p = 0.004), this test is sensitive to sample size and minor deviations in calibration may result in significant findings. Despite this, the model demonstrated excellent discrimination (AUC = 85.9%) and high classification accuracy (86%), supporting its overall adequacy for prediction and inference. Examination of influential observations demonstrated that although some observations exerted higher influence, their removal did not materially alter the regression estimates or conclusions, indicating robustness of the model.</span>
<span id="cb116-1564"><a href="#cb116-1564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1565"><a href="#cb116-1565" aria-hidden="true" tabindex="-1"></a>These diagnostic findings provide confidence that the final multivariable logistic regression model is well-specified, statistically sound, and robust, and that the reported associations between years working, physical activity, obesity status, and depression are reliable and suitable for interpretation and inference.</span>
<span id="cb116-1566"><a href="#cb116-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1567"><a href="#cb116-1567" aria-hidden="true" tabindex="-1"></a><span class="fu">### 9.6 Discussion on influential points and their impact on the results</span></span>
<span id="cb116-1568"><a href="#cb116-1568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1569"><a href="#cb116-1569" aria-hidden="true" tabindex="-1"></a>Influential observations were examined to assess whether individual data points exerted undue influence on the estimated regression coefficients and overall conclusions of the logistic regression model. This assessment was conducted using Cook’s distance and DFBETAS, which evaluate the impact of each observation on the fitted model parameters.</span>
<span id="cb116-1570"><a href="#cb116-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1571"><a href="#cb116-1571" aria-hidden="true" tabindex="-1"></a>For Cook’s distance, the commonly used cut-off of 4/n was applied, where n represents the sample size. With approximately 200 observations, the cut-off value was therefore around 0.02. The majority of observations had Cook’s distance values well below this threshold, indicating minimal influence on the model estimates. A small number of observations exceeded or approached this cut-off, suggesting potential influence; however, none demonstrated extremely large values that would indicate undue dominance of the model.</span>
<span id="cb116-1572"><a href="#cb116-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1573"><a href="#cb116-1573" aria-hidden="true" tabindex="-1"></a>DFBETAS were also assessed using the conventional cut-off of <span class="sc">\|</span>DFBETAS<span class="sc">\|</span> <span class="sc">\&gt;</span> 2/√n, corresponding to approximately 0.14 for this sample size. Only a limited number of observations exceeded this threshold for specific coefficients, particularly for obesity status and the physical activity × obesity interaction term. This indicates that while some observations had noticeable influence on certain parameters, their effect was not excessive.</span>
<span id="cb116-1574"><a href="#cb116-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1575"><a href="#cb116-1575" aria-hidden="true" tabindex="-1"></a>To evaluate the practical impact of these influential points, sensitivity analyses were performed by refitting the model after excluding the identified observations. The comparison between the full model and the reduced model showed that the direction, magnitude, and statistical significance of the regression coefficients remained largely unchanged. Importantly, the physical activity × obesity interaction remained statistically significant, and its estimated effect size was stable, indicating that the observed effect modification was not driven by a small number of influential cases.</span>
<span id="cb116-1576"><a href="#cb116-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1577"><a href="#cb116-1577" aria-hidden="true" tabindex="-1"></a>Therefore, despite the presence of a small number of moderately influential observations, their impact on the overall model conclusions was minimal. The stability of estimates following sensitivity analyses supports the robustness of the interaction effect. Combined with the significant improvement in model fit observed when the interaction term was included, these findings justify the retention of the model with interaction as the final model. The interaction model provides a more accurate and reliable representation of the relationship between physical activity, obesity status, and depression, without being unduly influenced by extreme or atypical observations.</span>
<span id="cb116-1578"><a href="#cb116-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1579"><a href="#cb116-1579" aria-hidden="true" tabindex="-1"></a><span class="fu"># GITHUB REPOSITORY \# </span></span>
<span id="cb116-1580"><a href="#cb116-1580" aria-hidden="true" tabindex="-1"></a>Github Repository The completed code and data for this analysis are available at: https://github.com/fizasaharudin-ux/regression-analysis-assignment.git<span class="sc">\]</span></span>
<span id="cb116-1583"><a href="#cb116-1583" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1584"><a href="#cb116-1584" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"https://github.com/fizasaharudin-ux/regression-analysis-assignment.git"</span>)</span>
<span id="cb116-1585"><a href="#cb116-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1586"><a href="#cb116-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1587"><a href="#cb116-1587" aria-hidden="true" tabindex="-1"></a>REFERENCES</span>
<span id="cb116-1588"><a href="#cb116-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1589"><a href="#cb116-1589" aria-hidden="true" tabindex="-1"></a>1)  Musa, K.I. &amp; Wan Mansor, W.N.A.W., 2021. Exploring data using R. Penang: Penerbit Universiti Sains Malaysia.</span>
<span id="cb116-1590"><a href="#cb116-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1591"><a href="#cb116-1591" aria-hidden="true" tabindex="-1"></a>2)  Hosmer Jr., D.W., Lemeshow, S. and Sturdivant, R.X. (2013) Applied Logistic Regression. 3rd Edition, John Wiley &amp; Sons, Hoboken, NJ. https://doi.org/10.1002/9781118548387</span>
<span id="cb116-1592"><a href="#cb116-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1593"><a href="#cb116-1593" aria-hidden="true" tabindex="-1"></a>3)  Ho, N.T., 2019. Bio-medical data analysis with R. Boca Raton, FL: CRC Press.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>